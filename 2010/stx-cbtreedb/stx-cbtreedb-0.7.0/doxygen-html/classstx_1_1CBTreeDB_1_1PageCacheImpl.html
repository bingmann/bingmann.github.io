<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>stx-cbtreedb: stx::CBTreeDB&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacestx.html">stx</a>::<a class="el" href="classstx_1_1CBTreeDB.html">CBTreeDB</a>::<a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html">PageCacheImpl</a>
  </div>
</div>
<div class="contents">
<h1>stx::CBTreeDB&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl Class Reference</h1><!-- doxytag: class="stx::CBTreeDB::PageCacheImpl" -->
<p><a class="el" href="classstx_1_1CBTreeDB_1_1PageCache.html" title="PageCache and PageCacheImpl implement a LRU-strategy cache of B-tree pages used by...">PageCache</a> and <a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html" title="PageCache and PageCacheImpl implement a LRU-strategy cache of B-tree pages used by...">PageCacheImpl</a> implement a LRU-strategy cache of B-tree pages used by <a class="el" href="classstx_1_1CBTreeDB.html" title="Template super-class enclosing all classes which can operate on a constant B-tree...">CBTreeDB</a> reader objects.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for stx::CBTreeDB&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl:</div>
<div class="dynsection">
<div class="center"><img src="classstx_1_1CBTreeDB_1_1PageCacheImpl__coll__graph.png" border="0" usemap="#stx_1_1CBTreeDB_3_01__Key_00_01__Compare_00_01__BTreePageSize_00_01__AppVersionId_01_4_1_1PageCacheImpl_coll__map" alt="Collaboration graph"/></div>
<map name="stx_1_1CBTreeDB_3_01__Key_00_01__Compare_00_01__BTreePageSize_00_01__AppVersionId_01_4_1_1PageCacheImpl_coll__map" id="stx_1_1CBTreeDB_3_01__Key_00_01__Compare_00_01__BTreePageSize_00_01__AppVersionId_01_4_1_1PageCacheImpl_coll__map">
<area shape="rect" id="node2" href="structstx_1_1CBTreeDB_1_1PageCacheImpl_1_1HashCell.html" title="Structure for each slot in the cache hash array." alt="" coords="5,99,627,128"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="classstx_1_1CBTreeDB_1_1PageCacheImpl-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstx_1_1CBTreeDB_1_1PageCacheImpl_1_1HashCell.html">HashCell</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure for each slot in the cache hash array.  <a href="structstx_1_1CBTreeDB_1_1PageCacheImpl_1_1HashCell.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#ab7a846097add9cc3cb6a0add82d882c9">PageCacheImpl</a> (unsigned int maxsize)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new page cache containg maxsize pages.  <a href="#ab7a846097add9cc3cb6a0add82d882c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a6fda39de4fe5301926e05bd36fcdac81">~PageCacheImpl</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes all cached pages and destroys cache.  <a href="#a6fda39de4fe5301926e05bd36fcdac81"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a202e03ec9d41ef40782ef382dfa37ec2">RefInc</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Increment reference counter by one.  <a href="#a202e03ec9d41ef40782ef382dfa37ec2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a40ca7714265adac0114dc02f48d3130d">RefDec</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Decrement reference counter by one and return it.  <a href="#a40ca7714265adac0114dc02f48d3130d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a8112847c7c7860676cc7da642aa782c7">Clear</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove all pages from the cache and reset status.  <a href="#a8112847c7c7860676cc7da642aa782c7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#addefddb279e03e197f0af71046a82d54">Store</a> (void *btreeid, uint32_t pageid, const <a class="el" href="classstx_1_1CBTreeDB_1_1BTreePage.html">BTreePage</a> &amp;page)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store a page object in a cache cell identified by (btreeid,pageid).  <a href="#addefddb279e03e197f0af71046a82d54"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a53df7ae7011153b01a32f1d27d0831ff">Retrieve</a> (void *btreeid, uint32_t pageid, <a class="el" href="classstx_1_1CBTreeDB_1_1BTreePage.html">BTreePage</a> &amp;outpage)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve a cached page identified by (btreeid,pageid).  <a href="#a53df7ae7011153b01a32f1d27d0831ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a167e40aeaf2d236a0165e50e387579c9">SetMaxSize</a> (unsigned int maxsize)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change maximum number of pages in cache, note that this does not immediately have effect.  <a href="#a167e40aeaf2d236a0165e50e387579c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; void <br class="typebreak"/>
*, uint32_t &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a8975e78532ec79f191e0b2551b8340d3">GetPagelist</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a vector listing all currently contained (btreeid,pageid) pairs in LRU order.  <a href="#a8975e78532ec79f191e0b2551b8340d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a55253391a04d3a208864b32e80dc806c">Verify</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify the integrity of the LRU list and hash table.  <a href="#a55253391a04d3a208864b32e80dc806c"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#ace962f2c775c68fa0d7a72d25f3365e5">hashfunc</a> (void *btreeid, uint32_t pageid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simple hash function mapping (btreeid,pageid) -&gt; bucket.  <a href="#ace962f2c775c68fa0d7a72d25f3365e5"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#aa61ab668cc01a70967d2b48d06ae8042">m_refs</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">reference counter  <a href="#aa61ab668cc01a70967d2b48d06ae8042"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a05f9db14ab63c23c66dd285c27bb3830">m_maxsize</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">maximum number of pages in cache  <a href="#a05f9db14ab63c23c66dd285c27bb3830"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a1f1fb6a254e1828a526766a50976fe40">m_size</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">current number of pages in cache  <a href="#a1f1fb6a254e1828a526766a50976fe40"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a4653f52d6b2fc7678c2c7d84ae80c020">m_lrutime</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">counter to tag pages with a virtual LRU timestamp.  <a href="#a4653f52d6b2fc7678c2c7d84ae80c020"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; struct <a class="el" href="structstx_1_1CBTreeDB_1_1PageCacheImpl_1_1HashCell.html">HashCell</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#aaf204547ceb5104c7e2c52d8ed3ba51c">m_hasharray</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">hash cell array holding pointers to active cells  <a href="#aaf204547ceb5104c7e2c52d8ed3ba51c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structstx_1_1CBTreeDB_1_1PageCacheImpl_1_1HashCell.html">HashCell</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a8303984f028cf8b6e677e31a7d1a024f">m_sentinel</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">sentinel hash cell for LRU double-linked list.  <a href="#a8303984f028cf8b6e677e31a7d1a024f"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;typename _Key = uint32_t, typename _Compare = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt;<br/>
 class stx::CBTreeDB&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl</h3>

<p><a class="el" href="classstx_1_1CBTreeDB_1_1PageCache.html" title="PageCache and PageCacheImpl implement a LRU-strategy cache of B-tree pages used by...">PageCache</a> and <a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html" title="PageCache and PageCacheImpl implement a LRU-strategy cache of B-tree pages used by...">PageCacheImpl</a> implement a LRU-strategy cache of B-tree pages used by <a class="el" href="classstx_1_1CBTreeDB.html" title="Template super-class enclosing all classes which can operate on a constant B-tree...">CBTreeDB</a> reader objects. </p>
<p>One cache object can be shared between multiple readers. However, this page cache is not thread safe. You may have to wrap some mutex libraries if needed.</p>
<p>The cached pages are put into a hash table for quick lookup by (btreeid,pageid). Simultaneously the HashCells are linked into a doubly chained "LRU"-list with the most recently used page at the head. This allows O(1) algorithms for both <a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#addefddb279e03e197f0af71046a82d54" title="Store a page object in a cache cell identified by (btreeid,pageid).">Store()</a> and <a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a53df7ae7011153b01a32f1d27d0831ff" title="Retrieve a cached page identified by (btreeid,pageid).">Retrieve()</a> functions. When the maximum number of pages is exceeded, the tail pages of the LRU-list are removed. The drawing below illustrates the data structure used by the class.</p>
 
 <div style="text-align: center">
 <p>Structure of PageCache's arrays and nodes</p>
 <object type="image/svg+xml" data="drawing-1.svg" style="height: 25em"></object>
 </div>
  
<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00924">924</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab7a846097add9cc3cb6a0add82d882c9"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::PageCacheImpl" ref="ab7a846097add9cc3cb6a0add82d882c9" args="(unsigned int maxsize)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::PageCacheImpl </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>maxsize</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, explicit]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a new page cache containg maxsize pages. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00995">995</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6fda39de4fe5301926e05bd36fcdac81"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::~PageCacheImpl" ref="a6fda39de4fe5301926e05bd36fcdac81" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::~PageCacheImpl </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes all cached pages and destroys cache. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01008">1008</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8112847c7c7860676cc7da642aa782c7"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::Clear" ref="a8112847c7c7860676cc7da642aa782c7" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::Clear </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remove all pages from the cache and reset status. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01026">1026</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8975e78532ec79f191e0b2551b8340d3"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::GetPagelist" ref="a8975e78532ec79f191e0b2551b8340d3" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt;void*, uint32_t&gt; &gt; <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::GetPagelist </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return a vector listing all currently contained (btreeid,pageid) pairs in LRU order. </p>
<p>Used by the test cases for verification. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01215">1215</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="ace962f2c775c68fa0d7a72d25f3365e5"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::hashfunc" ref="ace962f2c775c68fa0d7a72d25f3365e5" args="(void *btreeid, uint32_t pageid)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::hashfunc </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>btreeid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>pageid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Simple hash function mapping (btreeid,pageid) -&gt; bucket. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00986">986</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a40ca7714265adac0114dc02f48d3130d"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::RefDec" ref="a40ca7714265adac0114dc02f48d3130d" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::RefDec </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Decrement reference counter by one and return it. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01020">1020</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a202e03ec9d41ef40782ef382dfa37ec2"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::RefInc" ref="a202e03ec9d41ef40782ef382dfa37ec2" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::RefInc </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Increment reference counter by one. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01014">1014</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a53df7ae7011153b01a32f1d27d0831ff"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::Retrieve" ref="a53df7ae7011153b01a32f1d27d0831ff" args="(void *btreeid, uint32_t pageid, BTreePage &amp;outpage)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::Retrieve </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>btreeid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>pageid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classstx_1_1CBTreeDB_1_1BTreePage.html">BTreePage</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>outpage</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieve a cached page identified by (btreeid,pageid). </p>
<p>Returns true if the page was found. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01156">1156</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a167e40aeaf2d236a0165e50e387579c9"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::SetMaxSize" ref="a167e40aeaf2d236a0165e50e387579c9" args="(unsigned int maxsize)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::SetMaxSize </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>maxsize</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Change maximum number of pages in cache, note that this does not immediately have effect. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01208">1208</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="addefddb279e03e197f0af71046a82d54"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::Store" ref="addefddb279e03e197f0af71046a82d54" args="(void *btreeid, uint32_t pageid, const BTreePage &amp;page)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::Store </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>btreeid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>pageid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classstx_1_1CBTreeDB_1_1BTreePage.html">BTreePage</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>page</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Store a page object in a cache cell identified by (btreeid,pageid). </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01050">1050</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a55253391a04d3a208864b32e80dc806c"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::Verify" ref="a55253391a04d3a208864b32e80dc806c" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::PageCacheImpl::Verify </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verify the integrity of the LRU list and hash table. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l01231">1231</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aaf204547ceb5104c7e2c52d8ed3ba51c"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::m_hasharray" ref="aaf204547ceb5104c7e2c52d8ed3ba51c" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;struct <a class="el" href="structstx_1_1CBTreeDB_1_1PageCacheImpl_1_1HashCell.html">HashCell</a>*&gt; <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::<a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#aaf204547ceb5104c7e2c52d8ed3ba51c">PageCacheImpl::m_hasharray</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>hash cell array holding pointers to active cells </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00977">977</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4653f52d6b2fc7678c2c7d84ae80c020"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::m_lrutime" ref="a4653f52d6b2fc7678c2c7d84ae80c020" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::<a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a4653f52d6b2fc7678c2c7d84ae80c020">PageCacheImpl::m_lrutime</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>counter to tag pages with a virtual LRU timestamp. </p>
<p>This is just for verification purposes and is only used in the testsuite as the counter may overflow in real applications. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00943">943</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a05f9db14ab63c23c66dd285c27bb3830"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::m_maxsize" ref="a05f9db14ab63c23c66dd285c27bb3830" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::<a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a05f9db14ab63c23c66dd285c27bb3830">PageCacheImpl::m_maxsize</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>maximum number of pages in cache </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00932">932</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa61ab668cc01a70967d2b48d06ae8042"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::m_refs" ref="aa61ab668cc01a70967d2b48d06ae8042" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::<a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#aa61ab668cc01a70967d2b48d06ae8042">PageCacheImpl::m_refs</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>reference counter </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00929">929</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8303984f028cf8b6e677e31a7d1a024f"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::m_sentinel" ref="a8303984f028cf8b6e677e31a7d1a024f" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structstx_1_1CBTreeDB_1_1PageCacheImpl_1_1HashCell.html">HashCell</a> <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::<a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a8303984f028cf8b6e677e31a7d1a024f">PageCacheImpl::m_sentinel</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sentinel hash cell for LRU double-linked list. </p>
<p>list_next is the head and list_prev is the tail of the list. </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00983">983</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1f1fb6a254e1828a526766a50976fe40"></a><!-- doxytag: member="stx::CBTreeDB::PageCacheImpl::m_size" ref="a1f1fb6a254e1828a526766a50976fe40" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Key  = uint32_t, typename _Compare  = std::less&lt;_Key&gt;, unsigned int _BTreePageSize = 1024, uint32_t _AppVersionId = 0&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classstx_1_1CBTreeDB.html">stx::CBTreeDB</a>&lt; _Key, _Compare, _BTreePageSize, _AppVersionId &gt;::<a class="el" href="classstx_1_1CBTreeDB_1_1PageCacheImpl.html#a1f1fb6a254e1828a526766a50976fe40">PageCacheImpl::m_size</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>current number of pages in cache </p>

<p>Definition at line <a class="el" href="stx-cbtreedb_8h_source.html#l00935">935</a> of file <a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/<a class="el" href="stx-cbtreedb_8h_source.html">stx-cbtreedb.h</a></li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Wed Apr 14 13:43:41 2010 for stx-cbtreedb by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
