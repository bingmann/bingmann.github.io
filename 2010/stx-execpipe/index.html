<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=iso-8859-1" http-equiv="content-type" /><title>STX Execution Pipe C++ Library - panthema.net</title><link rel="stylesheet" type="text/css" href="/css/base.css" /><link rel="alternate" type="application/rss+xml" title="panthema.net Weblog Feed RSS 2.0" href="http://panthema.net/xmlfeed/weblog-rss20.xml" /><link rel="alternate" type="application/atom+xml" title="panthema.net Weblog Feed Atom 1.0" href="http://panthema.net/xmlfeed/weblog-atom10.xml" /><script type="text/javascript" src="/js/base.js"></script><script type="text/javascript">/* <!-- */makeIEHover = function() {var lis = document.getElementById('ptnav').getElementsByTagName('li');for (var i = 0; i < lis.length; i++) {lis[i].onmouseover = function() {this.className += ' sfhover';};lis[i].onmouseout = function() {this.className = this.className.replace(new RegExp(' sfhover\b'), '');};}};if (window.attachEvent) window.attachEvent('onload', makeIEHover);/* --> */</script></head><body style="background-image: url(/img/bgfractal8.jpg)"><div class="pttopbar"><div style="float: right"><ul id="ptnav"><li class="top"><a class="ni" href="/">Weblog</a><ul style="margin-left: -6px; margin-top: 4px" class="nx"><li><a href="/2014/">2014</a></li><li><a href="/2013/">2013</a></li><li><a href="/2012/">2012</a></li><li><a href="/2011/">2011</a></li><li><a href="/2010/">2010</a></li><li><a href="/2009/">2009</a></li><li><a href="/2008/">2008</a></li><li><a href="/2007/">2007</a></li><li><a href="/2006/">2006</a></li><li class="nt"><a href="/2005/">2005</a></li><li class="ns"><a href="/xmlfeed/weblog-rss20.xml">RSS Feed</a></li><li class="nt"><a href="/xmlfeed/weblog-atom10.xml">XML Atom</a></li><li class="ns"><a href="/search.html">Search</a></li></ul></li><li class="top"><a class="ni" href="/tags/">Tags</a><div style="width: 14em; margin-left: -9em; margin-top: 4px"><a style="font-size: 10pt" href="/tags/algebra.html">algebra</a> <a style="font-size: 16pt" href="/tags/c++.html">c++</a> <a style="font-size: 12pt" href="/tags/code-example.html">code-example</a> <a style="font-size: 14pt" href="/tags/code-snippet.html">code-snippet</a> <a style="font-size: 11pt" href="/tags/coding_tricks.html">coding tricks</a> <a style="font-size: 10pt" href="/tags/compsci.html">compsci</a> <a style="font-size: 10pt" href="/tags/compsci_study_thesis.html">compsci study thesis</a> <a style="font-size: 9pt" href="/tags/crypto-speedtest.html">crypto-speedtest</a> <a style="font-size: 10pt" href="/tags/cryptography.html">cryptography</a> <a style="font-size: 9pt" href="/tags/cryptote.html">cryptote</a> <a style="font-size: 12pt" href="/tags/flex-bison-cpp-example.html">flex-bison-cpp-example</a> <a style="font-size: 13pt" href="/tags/frontpage.html">frontpage</a> <a style="font-size: 13pt" href="/tags/fun.html">fun</a> <a style="font-size: 10pt" href="/tags/graphviz.html">graphviz</a> <a style="font-size: 9pt" href="http://www.hmtg.de">hartmetall</a> <a style="font-size: 9pt" href="/tags/helppc.html">helppc</a> <a style="font-size: 9pt" href="/tags/hifi_selbstbau.html">hifi selbstbau</a> <a style="font-size: 10pt" href="/tags/latex.html">latex</a> <a style="font-size: 10pt" href="/tags/librivox.html">librivox</a> <a style="font-size: 10pt" href="/tags/linux.html">linux</a> <a style="font-size: 10pt" href="/tags/maths.html">maths</a> <a style="font-size: 9pt" href="/tags/music.html">music</a> <a style="font-size: 10pt" href="/tags/netfundamentals.html">netfundamentals</a> <a style="font-size: 11pt" href="/tags/ns-3.html">ns-3</a> <a style="font-size: 10pt" href="/tags/parallel-string-sorting.html">parallel-string-sorting</a> <a style="font-size: 9pt" href="/tags/qtsqlview.html">qtsqlview</a> <a style="font-size: 10pt" href="/tags/research.html">research</a> <a style="font-size: 11pt" href="/tags/sdios06.html">sdios06</a> <a style="font-size: 9pt" href="/tags/sdlfractal.html">sdlfractal</a> <a style="font-size: 12pt" href="/tags/sorting.html">sorting</a> <a style="font-size: 10pt" href="/tags/stringology.html">stringology</a> <a style="font-size: 16pt" href="/tags/stx-btree.html">stx-btree</a> <a style="font-size: 9pt" href="/tags/stx-exparser.html">stx-exparser</a> <a style="font-size: 10pt" href="/tags/stxxl.html">stxxl</a> <a style="font-size: 15pt" href="/tags/talk.html">talk</a> <a style="font-size: 10pt" href="/tags/tutorium.html">tutorium</a> <a style="font-size: 16pt" href="/tags/university.html">university</a> <a style="font-size: 13pt" href="/tags/utilities.html">utilities</a> <a style="font-size: 9pt" href="/tags/webdesign.html">webdesign</a> </div></li><li class="top"> <a class="ni" href="#">Projects</a> <ul style="margin-left: -8em; margin-top: 4px;" class="nx"> <li><a href="/2009/cryptote/">CryptoTE</a></li> <li><a href="/2009/digup/">digup</a></li> <li><a href="/2013/disk-filltest/">disk-filltest</a></li> <li><a href="/2012/1119-eSAIS-Inducing-Suffix-and-LCP-Arrays-in-External-Memory/">eSAIS-LCP</a></li> <li><a href="/2007/flex-bison-cpp-example/">Flex Bison C++ Example</a></li> <li><a href="/2013/malloc_count/">malloc_count</a></li> <li><a href="/2013/parallel-string-sorting/">parallel-string-sorting</a></li> <li><a href="/2013/pmbw/">Parallel Memory Bandwidth</a></li> <li><a href="/2014/sqlplot-tools/">SqlPlotTools</a></li> <li><a href="/2013/sound-of-sorting/">The Sound of Sorting</a></li> <li><a href="/2007/stx-btree/">STX B+ Tree</a></li> <li><a href="/2010/stx-cbtreedb/">STX Constant BTreeDB</a></li> <li><a href="/2010/stx-execpipe/">STX ExecPipe</a></li> <li><a href="/2007/stx-exparser/">STX Expression Parser</a></li> <li class="nt"><a href="/2013/1212-stxxl-1.4.0/">STXXL 1.4</a></li> <li class="ns"><a href="/search.html">Search</a></li> </ul></li><li class="top"> <a class="ni" href="#">Research</a> <ul style="margin-left: -16em; margin-top: 4px" class="nx"> <li><a href="/2012/1119-eSAIS-Inducing-Suffix-and-LCP-Arrays-in-External-Memory/">eSAIS-LCP - External Memory Suffix Sorting</a></li> <li><a href="/2013/parallel-string-sorting/">Parallel String Sorting</a></li> <li><a href="/tags/stxxl.html">STXXL - External Memory Algorithms</a></li> <li class="ns"><a href="/search.html">Search</a></li> </ul></li><li class="top"> <a class="ni" href="/about/">About</a> <ul style="margin-left: -6em; margin-top: 4px" class="nx"> <li><a href="/about/">Timo Bingmann</a></li> <li><a href="/about/impressum.html">Impressum</a></li> </ul></li></ul></div><div style="padding: 6px"><a href="/">panthema</a>  / <a href="/2010/">2010</a> / <a href="/2010/stx-execpipe/">stx-execpipe</a></div></div><div class="pttextcontent"><div style="float: right; clear: right; margin: 12pt 0pt 12pt 12pt; font-size: smaller; text-align: center"><a href="/2010/stx-execpipe/"><img src="/2010/stx-execpipe/thumb.jpg" width="300" height="186" alt="Design schema of execution pipe" title="Design schema of execution pipe" /></a></div><h1>STX Execution Pipe C++ Library</h1><div class="sbframe" style="height: 16em; width: 248px"><a id="shoutbox"></a><table class="sbtable"> <tr><td class="a0">TalkBox</td></tr> <tr><td style="text-align: center" class="d0"><i>No posts yet.</i></td></tr>  <tr style="display: none" id="newpost_div"><td class="d1"><a href="http://www.gravatar.com/" id="newpost_imgurl" rel="nofollow"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAAAAAA6fptVAAAAAXNSR0IArs4c6QAAAApJREFUCB1j+A8AAQEBADZfZ4AAAAAASUVORK5CYII=" width="34" height="34" class="sbimg" id="newpost_img" alt="Gravatar" /></a><b><span id="newpost_name">Name</span></b>: <span id="newpost_body">Text</span></td></tr><tr><td class="d1"><form id="noteform" method="post" action="/sendpost.php"><div style="margin: 2px; text-align: center"><input type="hidden" name="previewok" value="0" /><input type="hidden" name="posturi" value="/2010/stx-execpipe/" /><input type="text" name="postname" size="30" value="Name" style="width: 95%" class="sbedit" onfocus="if (value == 'Name') { value=''; }" onblur="if (value == '') { value='Name'; }" /><br /><input type="text" name="postmail" size="30" value="Homepage/Gravatar E-Mail" style="width: 95%" class="sbedit" onfocus="if (value == 'Homepage/Gravatar E-Mail') { value=''; }" onblur="if (value == '') { value='Homepage/Gravatar E-Mail'; }" /><br /><textarea name="postbody" cols="30" rows="2" style="width: 95%" class="sbtext" onfocus="if (value == 'Text') { value=''; }" onblur="if (value == '') { value='Text'; }">Text</textarea><br /><input type="button" name="Preview" value="Preview" onclick="return sbform_submit()" class="sbbutton" /><input type="submit" name="Submit" value="Submit" disabled="disabled" id="newpost_submit" class="sbbutton" /></div></form></td></tr></table></div><p class="info">Posted on 2010-07-18, last updated 2010-07-30 by <a href="/about/">Timo Bingmann</a><a href="http://plus.google.com/+TimoBingmann?rel=author"></a> at <a href="/2010/stx-execpipe/">Permlink</a>.</p><h2>Summary</h2><p>The STX ExecPipe library provides a convenient C++ interface to <b>execute child programs connected via pipes</b>. It is a front-end to the system calls <code>fork()</code>, <code>pipe()</code>, <code>select()</code> and <code>execv()</code> and hides all the complexity of these low-level functions. It allows a program to build a sequence of connected children programs with input and output of the pipe sequence <b>redirected to a file, string or file descriptor</b>. The library also allows <b>custom asynchronous data processing classes</b> to be inserted into the pipe or placed at source or sink of the sequence.</p><p>An execution pipe consists of an input stream, a number of pipe stages and an output stream. The input and output streams can be a plain file descriptor, a file, a std::string or a special processing class. Each pipe stage is either an executed child program or an intermediate function class. At the junction between each stage in the pipeline the following program&apos;s stdin is connected to the preceding stage&apos;s stdout. The input and output streams are connected to the start and end of the pipe line.</p><table style="margin: 0 auto; border: 0px"><tr><td><pre>
 Input Stream                   Pipe Stages                   Output Stream
     none    |                                                |    none
      fd     |                 exec()                         |     fd
     file    |--&gt; stage --&gt;      or      --&gt; stage --&gt; ... --&gt;|    file
    string   |              PipeFunction                      |   string
  PipeSource |                                                |  PipeSink
</pre></td></tr></table><p>The library consists of only one code file and one header file. The code itself is viewable <a href="stx-execpipe-0.7.0/doxygen-html/a00013_source.html">in doxygen as stx-execpipe.cc</a> or with plain text comments <a href="stx-execpipe-0.7.0/src/stx-execpipe.h.html">stx-execpipe.cc</a>.</p><p>See the <a href="#readme">README file</a> below for a usage tutorial.</p><h2><a id="downloads"></a>Downloads</h2><table class="darkfullframe"> <tr> <td colspan="3"><b>STX Execution Pipe Library 0.7.1</b> (current) released 2010-07-30</td> </tr> <tr> <td rowspan="2">Source code archive:<br />(includes Doxygen HTML)</td> <td rowspan="2"><a href="stx-execpipe-0.7.1.tar.bz2">Download stx-execpipe-0.7.1.tar.bz2 (192kb)</a><br /><tt>MD5: 4d1a04db72679abece85834066ba708b</tt></td> <td><a href="stx-execpipe-0.7.1/">Browse online</a></td> </tr> <tr> <td>&nbsp;</td> </tr> <tr> <td>Extensive Documentation:</td> <td colspan="2"><a href="stx-execpipe-0.7.1/doxygen-html/index.html">Browse documentation online</a></td> </tr></table><p>See bottom of this page for <a href="#older_downloads">older downloads</a>.</p><h2><a id="license"></a>License</h2><p>The library source code is published under the <a class="exp" href="http://www.gnu.org/licenses/lgpl.html">GNU Lesser General Public License v2.1 (LGPL)</a>, which can be found in the file COPYING.</p><h2><a id="git"></a>Git Repository</h2><p>The git repository containing all sources and packages is fetchable by running<br /><code>git clone <a href="https://github.com/bingmann/stx-execpipe">https://github.com/bingmann/stx-execpipe.git</a></code></p><h2><a id="readme"></a>README</h2><div class="cite"><h2>Library Usage Tutorial</h2><p>The following tutorial shows some simple examples on how an execution pipe can be set up.</p><p>To use the library a program must</p><div class="codesnippet codeframe" style="font-size: 10pt; font-family: monospace"><tt><span class="dir">#include &quot;stx-execpipe.h&quot;</span></tt></div><p>and later link against libstx-execpipe.a or include the corresponding .o / .cc in the project&apos;s dependencies.</p><p>To run a sequence of programs you must first initialize a new ExecPipe object. The ExecPipe object is referenced counted so you can easily pass it around without deep-duplicating the object.</p><div class="codesnippet codeframe" style="font-size: 10pt; font-family: monospace"><tt><a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html" title="Main library interface (reference counted pointer).">stx::ExecPipe</a> ep; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="com">// creates new pipe</span><br /><br /><a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html" title="Main library interface (reference counted pointer).">stx::ExecPipe</a> ep_ref1 = ep; &nbsp; &nbsp; <span class="com">// reference to the same pipe.</span></tt></div><p>Once created the input stream source can be set using one of the four set_input_*() functions. Note that these are mutually exclusive, you must call at most one of the following functions!</p><div class="codesnippet codeframe" style="font-size: 10pt; font-family: monospace"><tt><span class="com">// you can designate an existing file as input stream</span><span class="com"><br /></span>ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a9afb508b49785a7ee6b664148588014b" title="Assign a file as input stream source.">set_input_file</a>(<span class="str">&quot;/path/to/file&quot;</span>);<br /><br /><span class="com">// or directly assign an already opened file descriptor</span><span class="com"><br /></span><span class="kwb">int</span> fd = ...;<br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#aff77e25ccbb4e666ed4f0342a059b9dd" title="Assign an already opened file descriptor as input stream for the first exec stage...">set_input_fd</a>(fd);<br /><br /><span class="com">// or pass the contents of a std::string as input</span><span class="com"><br /></span>std::string str = ...;<br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a9a0f38ea61b4cbc86aecc5f04e037fa2" title="Assign a std::string as input stream source.">set_input_string</a>(&amp;str);<br /><br /><span class="com">// or attach a data generating source class (details later).</span><span class="com"><br /></span>PipeSource source;<br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#ab1de27be9540428386031c0378405037" title="Assign a PipeSource as input stream source.">set_input_source</a>(&amp;source);<br /></tt></div><p>The input stream objects are _not_ copied. The fd, string or source object must still exist when calling run().</p><p>After setting up the input you specify the individual stages in the pipe by adding children programs to exec() or function classes. The <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00005.html" title="Main library interface (reference counted pointer).">stx::ExecPipe</a> provides different variants of add_exec*(), which are derived from the exec*() system call variants.</p><div class="codesnippet codeframe" style="font-size: 10pt; font-family: monospace"><tt><span class="com">// add simple exec() call with full path.</span><span class="com"><br /></span>ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#abef69ffbc8c00ed14536c1474f182175" title="Add an exec() stage to the pipe with given arguments.">add_exec</a>(<span class="str">&quot;/bin/cat&quot;</span>);<br /><br /><span class="com">// add exec() call with up to three direct parameters.</span><span class="com"><br /></span>ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#abef69ffbc8c00ed14536c1474f182175" title="Add an exec() stage to the pipe with given arguments.">add_exec</a>(<span class="str">&quot;/bin/echo&quot;</span>, <span class="str">&quot;one&quot;</span>, <span class="str">&quot;two&quot;</span>, <span class="str">&quot;three&quot;</span>);<br /><br /><span class="com">// add exec() call with many parameters. the vector is _not_ copied.</span><span class="com"><br /></span>std::vector&lt;std::string&gt; tarargs;<br />tarargs.push_back(<span class="str">&quot;/bin/tar&quot;</span>);<br />tarargs.push_back(<span class="str">&quot;--create&quot;</span>);<br />tarargs.push_back(<span class="str">&quot;--verbose&quot;</span>);<br />tarargs.push_back(<span class="str">&quot;--gzip&quot;</span>);<br />tarargs.push_back(<span class="str">&quot;--file&quot;</span>);<br />tarargs.push_back(<span class="str">&quot;/path/to/file&quot;</span>);<br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#abef69ffbc8c00ed14536c1474f182175" title="Add an exec() stage to the pipe with given arguments.">add_exec</a>(&amp;tarargs);<br /><br /><span class="com">// add execp() call which searches $PATH. see man 3 execvp.</span><span class="com"><br /></span>ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a02209f5cbef544191957d95c6f2eb27b" title="Add an execp() stage to the pipe with given arguments.">add_execp</a>(<span class="str">&quot;cat&quot;</span>);<br /><br /><span class="com">// same with up to three parameters.</span><span class="com"><br /></span>ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a02209f5cbef544191957d95c6f2eb27b" title="Add an execp() stage to the pipe with given arguments.">add_execp</a>(<span class="str">&quot;echo&quot;</span>, <span class="str">&quot;one&quot;</span>, <span class="str">&quot;two&quot;</span>, <span class="str">&quot;three&quot;</span>);<br /><br /><span class="com">// and also works with a vector of arguments.</span><span class="com"><br /></span>ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a02209f5cbef544191957d95c6f2eb27b" title="Add an execp() stage to the pipe with given arguments.">add_execp</a>(&amp;tarargs);<br /><br /><span class="com">// most versatile function: call execve() with program name, argv[] arguments</span><span class="com"><br /></span><span class="com">// and a set of environment variables.</span><span class="com"><br /></span>std::vector&lt;std::string&gt; gzipargs;<br />gzipargs.push_back(<span class="str">&quot;gunzip&quot;</span>); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="com">// this changes argv[0]</span><span class="com"><br /></span><br />std::vector&lt;std::string&gt; gzipenvs; &nbsp; &nbsp; &nbsp; &nbsp;<span class="com">// set environment variable</span><span class="com"><br /></span>gzipenvs.push_back(<span class="str">&quot;GZIP=-d --name&quot;</span>);<br /><br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#add73caa3ad28e575227e212c23dde72b" title="Add an exece() stage to the pipe with the given arguments and environments.">add_exece</a>(<span class="str">&quot;/bin/gzip&quot;</span>, &amp;gzipargs, &amp;gzipenvs);<br /><br /><span class="com">// insert an intermediate data processing class into the pipe (details later).</span><span class="com"><br /></span>PipeFunction function;<br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#ad4ace2eacec24c0a07694d3503dcf03d" title="Add a function stage to the pipe.">add_function</a>(&amp;function); </tt></div><p>After configuring the pipe stages the user program can redirect the pipe&apos;s output using one of the four set_output_*() functions. These correspond directly the to input functions.</p><div class="codesnippet codeframe" style="font-size: 10pt; font-family: monospace"><tt><span class="com">// designate a file as output, it will be over-written,</span><span class="com"><br /></span>ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#ad8bc4dd1a0f2e137544876ae0ba78ee9" title="Assign a file as output stream destination.">set_output_file</a>(<span class="str">&quot;/path/to/file&quot;</span>);<br /><br /><span class="com">// or directly assign an already opened file descriptor</span><span class="com"><br /></span><span class="kwb">int</span> fd = ...;<br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a1668a23be41fea81f7899dcbebbe767d" title="Assign an already opened file descriptor as output stream for the last exec stage...">set_output_fd</a>(fd);<br /><br /><span class="com">// or save output in a std::string object</span><span class="com"><br /></span>std::string str = ...;<br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a9536d076bbf9e82dd17e09c9aa77f7a8" title="Assign a std::string as output stream destination.">set_output_string</a>(&amp;str);<br /><br /><span class="com">// or attach a sink class (details later).</span><span class="com"><br /></span>PipeSink sink;<br />ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a313a290fea965ec30b6c159a74973945" title="Assign a PipeSink as output stream destination.">set_output_sink</a>(&amp;sink); </tt></div><p>The three steps above can be done in any order. Once the pipeline is configured as required, a call to run() will set up the input and output file descriptors, launch all children programs, wait until these finish and concurrently process data passed between parent and children.</p><div class="codesnippet codeframe" style="font-size: 10pt; font-family: monospace"><tt>try {<br />&nbsp; &nbsp; ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a305267e99ac1f905b673da3997960543" title="Run the configured pipe sequence and wait for all children processes to complete...">run</a>();<br />}<br /><span class="kwa">catch</span> (std::runtime_error &amp;e) {<br />&nbsp; &nbsp; std::cerr &lt;&lt; <span class="str">&quot;Pipe execution failed: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;<br />} </tt></div><p>After running all children their <span class="kwa">return</span> status should be checked. These can be inspected <span class="kwa">using</span> the following functions. The integer parameter specifies the exec stage in the pipe sequence.</p><div class="codesnippet codeframe" style="font-size: 10pt; font-family: monospace"><tt><span class="com">// get plain return status as indicated by wait().</span><span class="com"><br /></span><span class="kwb">int</span> rs = ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#ad4c4c5f819976489131c45611578594f" title="Get the return status of exec() stage's program run after pipe execution as indicated...">get_return_status</a>(0)<br /><br /><span class="com">// get return code for normally terminated program.</span><span class="com"><br /></span><span class="kwb">int</span> rc = ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a26720fa668df3398398f10c503a52f9d" title="Get the return code of exec() stage's program run after pipe execution, or -1...">get_return_code</a>(<span class="num">1</span>);<br /><br /><span class="com">// get signal for abnormally terminated program (like segfault).</span><span class="com"><br /></span><span class="kwb">int</span> rg = ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#a477d189d73e8344ca4fa4b333207bc15" title="Get the signal of the abnormally terminated exec() stage's program run after...">get_return_signal</a>(<span class="num">1</span>); </tt></div><p>Most program have a return code of 0 when no error occurred. Therefore, a convenience function is available which checks whether all program stages returned zero. This is what would usually be used.</p><div class="codesnippet codeframe" style="font-size: 10pt; font-family: monospace"><tt><span class="com">// check all that program returned zero</span><span class="com"><br /></span><span class="kwa">if</span> (ep.<a class="code" href="stx-execpipe-0.7.0/doxygen-html/a00005.html#aac626dcd623778ce5a1475cc12ac596f" title="Return true if the return code of all exec() stages were zero.">all_return_codes_zero</a>()) {<br />&nbsp; &nbsp; <span class="com">// run was ok.</span><span class="com"><br /></span>}<br /><span class="kwa">else</span> {<br />&nbsp; &nbsp; <span class="com">// error handling.</span><span class="com"><br /></span>} </tt></div><p>After checking the return error codes the pipe&apos;s results can be used.</p><p>The tarball contains three simple examples of using the different exec() variants and input/output redirections. See <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00001.html">examples/simple1.cc</a>, <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00002.html">examples/simple2.cc</a> or <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00003.html">examples/simple3.cc</a>. More a more elaborate example using data processing classes see the continued tutorial below.</p><h2>Data Processing Classes</h2><p>One of the big features of the STX ExecPipe classes is the ability to insert intermediate asynchronous data processing classes into the pipe sequence. The data of the pipe line is returned to the parent process and, after arbitrary computations, can be sent on to the following execution stages. Besides intermediate processing, the input and output stream can be attached to source or sink classes.</p><p>This feature can be used to generate input data, e.g. binary data or file listing, or peek at the data flowing between stages, e.g. to compute a SHA1 digest, or to directly processes output data while the children are running.</p><p>The data processing classes must be derived from one of the three abstract classes: <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00009.html" title="Abstract class used as an input stream source for an ExecPipe.">stx::PipeSource</a> for generating input streams, <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00007.html" title="Abstract class used as an intermediate pipe stage between executed processes.">stx::PipeFunction</a> for intermediate processing between stages or <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html" title="Abstract class used as an output stream source for an ExecPipe.">stx::PipeSink</a> for receiving output.</p><p>For generating an input stream a class must derive from <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00009.html" title="Abstract class used as an input stream source for an ExecPipe.">stx::PipeSource</a> and implement the <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00009.html#a95df51330c144a7782efc103ace6d453">poll()</a> function. This function is called when new data can be pushed into the pipe. When <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00009.html#a95df51330c144a7782efc103ace6d453">poll()</a> is called, new data must be generated and delivered via the <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00009.html#a356519e2fbbeacbf06b6e33c78dde7ad">write()</a> function of <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00009.html" title="Abstract class used as an input stream source for an ExecPipe.">stx::PipeSource</a>. If more data is available <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00009.html#a95df51330c144a7782efc103ace6d453">poll()</a> must return true, otherwise the input stream is terminated.</p><p>Intermediate data processing classes must derive from <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00007.html" title="Abstract class used as an intermediate pipe stage between executed processes.">stx::PipeFunction</a> and implement the two pure virtual function <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html#aad674114373316816576fe4f8a64e23f">process()</a> and <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html#a7704c6b4f69a974236bd0ed771b659a3">eof()</a>. As the name suggests, data is delivered to the class via the <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html#aad674114373316816576fe4f8a64e23f">process()</a> function. After processing the data it may be forwarded to the next pipe stage via the inherited<a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00007.html#af188fdba0b40670aedb24ad5fddc64dc">write()</a> function. Note that the library does not automatically forward data, so if you forget to write() data, then the following stage does not receive anything. When the preceding processing stage closes its data stream the function <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html#a7704c6b4f69a974236bd0ed771b659a3">eof()</a> is called.</p><p>To receive the output stream a class must derive from <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html" title="Abstract class used as an output stream source for an ExecPipe.">stx::PipeSink</a>. Similar to <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00007.html" title="Abstract class used as an intermediate pipe stage between executed processes.">stx::PipeFunction</a>, an output sink must implement the two pure virtual function <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html#aad674114373316816576fe4f8a64e23f">process()</a> and <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html#a7704c6b4f69a974236bd0ed771b659a3">eof()</a>. However, different from an intermediate class the <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00008.html" title="Abstract class used as an output stream source for an ExecPipe.">stx::PipeSink</a> does not provide a write() function, so no data can be forwarded.</p><p>For a full example of using <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00009.html" title="Abstract class used as an input stream source for an ExecPipe.">stx::PipeSource</a> to iterate through a file list and <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00007.html" title="Abstract class used as an intermediate pipe stage between executed processes.">stx::PipeFunction</a> to compute an intermediate SHA1 digest see <a class="el" href="stx-execpipe-0.7.0/doxygen-html/a00004.html">examples/functions1.cc</a>.</p></div><h2><a id="changelog"></a>ChangeLog</h2>2010-07-30 - Timo Bingmann - v0.7.1 <ul> <li>configure.ac: added <code>AC_SYS_LARGEFILE</code> to enable in/output tolarge files.</li> <li>stx-execpipe.cc: also added <code>_FILE_OFFSET_BITS</code> here for direct compilation and linking.</li></ul><h2><a id="older_downloads"></a>Older Downloads</h2><table class="darkfullframe"> <tr> <td colspan="3"><b>STX Execution Pipe Library 0.7.0</b> released 2010-07-18</td> </tr> <tr> <td rowspan="2">Source code archive:<br />(includes Doxygen HTML)</td> <td rowspan="2"><a href="stx-execpipe-0.7.0.tar.bz2">Download stx-execpipe-0.7.0.tar.bz2 (190kb)</a><br /><tt>MD5: 522865bea8ebaf5f2929544fac7b35ea</tt></td> <td><a href="stx-execpipe-0.7.0/">Browse online</a></td> </tr> <tr> <td>&nbsp;</td> </tr> <tr> <td>Extensive Documentation:</td> <td colspan="2"><a href="stx-execpipe-0.7.0/doxygen-html/index.html">Browse documentation online</a></td> </tr></table></div><div style="text-align: right; padding: 8pt; font-size: 12px"><a href="/xmlfeed/weblog-rss20.xml"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPAgMAAAAOp6AcAAAADFBMVEVmZmb/ZgD///+JjnlbTUWmAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABQAAAADwCexKkxAAAAWUlEQVQYlWNgwAa0VmGAFQyqoSCQ/x8J/CBFMCt0ZdTU/F/7/+1HEkydFpoKVPn+93sUlUujQvP/7UcRTAuNDJ2a//s/imDqtKVZofm/1qGYSZk7sfodGwAAiobBJtffoNAAAAAASUVORK5CYII=" alt="RSS 2.0 Weblog Feed" width="80" height="15"/></a> <a href="/xmlfeed/weblog-atom10.xml"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPAgMAAAAOp6AcAAAADFBMVEVmZmb/ZgD///+JjnlbTUWmAAAAaklEQVQYlWNgwAa0VmGAFQyqoSCQ/x8J/CBFMDV16rTQ/H/7V//69+//v/3/9oMEI6cuAwr+fv/+/b5d///v//0eJBgWOhMo+Gs9UPAdXDBy6lSYyn9wQZCZS0GCYDPXQcykzJ1Y/Y4NAABKvL80wyoMPgAAAABJRU5ErkJggg==" alt="Atom 1.0 Weblog Feed" width="80" height="15"/></a> <a href="http://validator.w3.org/check?uri=referer"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAB1FBMVEUHQIgIRY0MN4QNRYoSRYsXUpIYVJQeUpUhWpgjUJMjWpgmU5QnXJkuYZ0uYpwwV5YyZJ4zaKM3ZaA5aaI6aqM6a6E8ZqA8Z6BAbaRBbqdCbaVHd61KSkpKcaZQUFBUf69UgbBVVVVXfq9Yg7NZhbJZh7RagrNeXVxeh7RfjLdgYGBiiLZmZmZnZ2doirhpkbt0m8F3m8B3ncJ5lb55ocR+ocSDgX+Do8eEpMqGhoaHp8iIpMeJjnmJpseKqMeOqsqPsdCQrcyVlZWVsM2Zs9CZtNCfu9ahoaGhuNShudSivNSjtMWjvNSmpqWnpqSrw9qvxNqyxdmyxdyzsK6zs7Ozx9y0xt21yN22tra4y+K80eK/v7/AwMDExMTEy9DH2ejK2+jM2ujN3uvP0dLR0NDR3uvS3uvS3+zU4u3V1dXY2dnY4u7Y4+3b5e/d3d3d5u/d5/De3t7f39/h4uLj4uHj6/Ll7PXm7fTn7/Xo7/Tp7/bq7Ozr6unr8ffw8PDw9vvx9fny+P7z8/Pz9vnz9vv3+fv4+vz5+vz6+vr6+/36/P36///7+/77/Pz7/f37/f78/Pz8/f38/f79/f39/f79/f/9/v79///+/v7+/v////3///+tYR2LAAABKklEQVQ4y2PQoTJg0JlNVYDPQBsyAMTAqaFes8tdsmdPCtA3MDStr3GKKK6myMAprgJ9pcpWs/MlRExYJBvNZLR0sigycHYOV1S7mtjsQJ4gf+HIFPXoWMs6qIGzIRiKZs9GFoEaMRuZhhrYqqJXy8uZYauRxC/VHew7e3YTPAxnI5swG6JxNrKBNjB1EFmIgV0+HA6C8pqqzhXG7BbJJROQIwViMYQ7G2oDQQNn57JyG7kxiCfObrBmS5+BHMuYLkTzMnYDm5WY4lOZZRPKZocxes+aPbuwCFsYohiICLvZsKBAMrDTQ7K/StveU8icTzrOL8JdLpOyWJ49u8Bx9ozw8DY7UYW03hhdxZAOSg2c3jN79rSJs1vSKmfOnpFXNJmynELlvExlAADnaZpLFGEC2wAAAABJRU5ErkJggg==" alt="Valid XHTML 1.1" width="80" height="15"/></a> <a href="http://jigsaw.w3.org/css-validator/check/referer"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAB1FBMVEUHQIgIRY0MN4QNRYoSRYsXUpIYVJQeUpUhWpgjUJMjWpgmU5QnXJkuYZ0uYpwwV5YyZJ4zaKM3ZaA5aaI6aqM6a6E8ZqA8Z6BAbaRBbqdCbaVHd61KSkpKcaZQUFBUf69UgbBVVVVXfq9Yg7NZhbJZh7RagrNeXVxeh7RfjLdgYGBiiLZmZmZnZ2doirhpkbt0m8F3m8B3ncJ5lb55ocR+ocSDgX+Do8eEpMqGhoaHp8iIpMeJjnmJpseKqMeOqsqPsdCQrcyVlZWVsM2Zs9CZtNCfu9ahoaGhuNShudSivNSjtMWjvNSmpqWnpqSrw9qvxNqyxdmyxdyzsK6zs7Ozx9y0xt21yN22tra4y+K80eK/v7/AwMDExMTEy9DH2ejK2+jM2ujN3uvP0dLR0NDR3uvS3uvS3+zU4u3V1dXY2dnY4u7Y4+3b5e/d3d3d5u/d5/De3t7f39/h4uLj4uHj6/Ll7PXm7fTn7/Xo7/Tp7/bq7Ozr6unr8ffw8PDw9vvx9fny+P7z8/Pz9vnz9vv3+fv4+vz5+vz6+vr6+/36/P36///7+/77/Pz7/f37/f78/Pz8/f38/f79/f39/f79/f/9/v79///+/v7+/v////3///+tYR2LAAABEUlEQVQ4y2PQoTJg0JlNVYDPQBsyAMTAqaFes8tdsmdPCtA3MDStr3GKKK6myMAprgJ9pcpWs/MlRExYJBvNZLR0sigycHYOV1S7mtjsQJ4gf+HIFPXoWMs6mIEQCsIjwhKoga0qerW8nBm2Gkn8Ut3BvrNnN8HCcDYM2cBIogzs8uFwEJTXVHWuMGa3SC6ZgIgUqCEwdxJr4OxcVm4jNwbxxNkN1mzpM2ajGIjsPGK9PLtZiSk+lVk2oWx2GKP3rNmzC4tQwpDoIIQb2Okh2V+lbe8pZM4nHecX4S6XSVksz55d4Dh7Rnh4m52oQlpvjK5iSAelBk7vmT172sTZLWmVM2fPyCuaTFlOoXJepjIAANlljDGY/l5pAAAAAElFTkSuQmCC" alt="Valid CSS (2.1)" width="80" height="15"/></a><br/>Copyright 2005-2014 <a href="/about/">Timo Bingmann</a> - <a href="/about/impressum.html">Impressum</a></div><script type="text/javascript">var _paq = _paq || []; _paq.push(["trackPageView"]); _paq.push(["enableLinkTracking"]);(function() {var u=(("https:" == document.location.protocol) ? "https" : "http") + "://panthema.net/wik-331/"; _paq.push(["setTrackerUrl", u+"js/"]); _paq.push(["setSiteId", "2"]);var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";g.defer=true; g.async=true; g.src=u+"js/"; s.parentNode.insertBefore(g,s);})();</script><noscript><p><img src="http://panthema.net/wik-331/js/?idsite=2&amp;rec=1" style="border:0" alt="" /></p></noscript></body></html>