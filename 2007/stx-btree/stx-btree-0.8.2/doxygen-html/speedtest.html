<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>STX B+ Tree Template Classes: Speed Test Results</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="speedtest">Speed Test Results </a></h1><h2><a class="anchor" name="Experiment">
Experiment</a></h2>
The speed test compares the libstdc++ STL red-black tree with the implemented B+ tree with many different parameters. To keep focus on the algorithms and reduce data copying the multiset specializations were chosen. Two set of test procedures are used: the first only inserts <em>n</em> random integers into the tree. The second test first inserts <em>n</em> random integers, then performs <em>n</em> lookups for those integers and finally erases all <em>n</em> integers.<p>
These two test sequences are preformed for <em>n</em> from 125 to 4,096,000 where <em>n</em> is doubled after each test run. For each <em>n</em> the test cycles are run until in total 8,192,000 items were inserted. This way the measured speed for small <em>n</em> is averaged over up to 65,536 sample runs.<p>
Lastly it is purpose of the test to determine a good node size for the B+ tree. Therefore the test runs are performed on different slot sizes; both inner and leaf nodes hold the same number of items. The number of slots tested ranges from 4 to 256 slots and therefore yields node sizes from about 50 to 2,048 bytes. This requires that the B+ tree template is instantiated for each of the probed node sizes!<p>
<dl class="attention" compact><dt><b>Attention:</b></dt><dd>Compilation of the speed test with -O3 can take very long and required much RAM.</dd></dl>
The results are be displayed below using gnuplot. All tests were run on a Pentium4 3.2 GHz with 1 GB RAM. A high-resolution PDF plot of the following images can be found in the package at speedtest/speedtest.pdf<p>
<div align="center">
<img src="speedtest-plot-1.png" alt="speedtest-plot-1.png">
</div>
 <div align="center">
<img src="speedtest-plot-2.png" alt="speedtest-plot-2.png">
</div>
<p>
The first two plots above show the absolute time measured for inserting <em>n</em> items into six different tree variants. For small <em>n</em> (the first plot) the speed of red-black tree and B+ tree are very similar. For large <em>n</em> the red-black tree slows down, and for <em>n</em> &gt; 1,024,000 items the red-black tree requires almost twice as much time as a B+ tree with 32 slots.<p>
The next plot shows the insertion time per item, which is calculated by dividing the absolute time by the number of inserted items. Notice that insertion time is now in microseconds. The plot shows that the red-black tree reaches some limitation at about <em>n</em> = 16,000 items. Beyond this item count the B+ tree (with 32 slots) performs much better than the STL multiset.<p>
<div align="center">
<img src="speedtest-plot-3.png" alt="speedtest-plot-3.png">
</div>
<p>
<div align="center">
<img src="speedtest-plot-4.png" alt="speedtest-plot-4.png">
</div>
<p>
The last plots goal is to find the best node size for the B+ tree. It displays the total measured time of the insertion test depending on the number of slots in inner and leaf nodes. The first data point on the left is the running time of the red-black tree. Only runs with more than 1 million inserted items are plotted. One can see that the minimum is around 65 slots for each of the curves. However to reduce unused memory in the nodes the most practical slot size is around 35. This amounts to total node sizes of about 280 bytes. Thus in the implementation a target size of 256 bytes was chosen.<p>
The following four plots show the same aspects as above, except that not only insertion time was measured. Instead a whole insert/find/delete cycle was performed and measured. The results are in general accordance to those of only insertion.<p>
<div align="center">
<img src="speedtest-plot-5.png" alt="speedtest-plot-5.png">
</div>
 <div align="center">
<img src="speedtest-plot-6.png" alt="speedtest-plot-6.png">
</div>
 <div align="center">
<img src="speedtest-plot-7.png" alt="speedtest-plot-7.png">
</div>
 <div align="center">
<img src="speedtest-plot-8.png" alt="speedtest-plot-8.png">
</div>
 </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Aug 13 08:04:30 2008 for STX B+ Tree Template Classes by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
