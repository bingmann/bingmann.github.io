<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=iso-8859-1" http-equiv="content-type" /><meta name="viewport" content="initial-scale=1"><title>/2018/0912-Boost-Spirit-Tutorial/examples/spirit7_html.cpp - panthema.net</title><link rel="stylesheet" type="text/css" href="/css/base.css" /><link rel="stylesheet" type="text/css" href="/css/fonts.css" /><link rel="alternate" type="application/rss+xml" title="panthema.net Weblog Feed RSS 2.0" href="http://panthema.net/xmlfeed/weblog-rss20.xml" /><link rel="alternate" type="application/atom+xml" title="panthema.net Weblog Feed Atom 1.0" href="http://panthema.net/xmlfeed/weblog-atom10.xml" /><script type="text/javascript" src="/js/base.js"></script><script type="text/javascript">/* <!-- */makeIEHover = function() {var lis = document.getElementById('ptnav').getElementsByTagName('li');for (var i = 0; i < lis.length; i++) {lis[i].onmouseover = function() {this.className += ' sfhover';};lis[i].onmouseout = function() {this.className = this.className.replace(new RegExp(' sfhover\b'), '');};}};if (window.attachEvent) window.attachEvent('onload', makeIEHover);/* --> */</script></head><body style="background-image: url(/img/bgfractal2.jpg)" lang="en"><div class="pttopbar"><div style="float: right"><ul id="ptnav"><li class="top"><a class="ni" href="/"><i class="icon-book"></i> Weblog</a><ul style="margin-left: -6px; margin-top: 4px" class="nx"><li><a href="/2019/">2019</a></li><li><a href="/2018/">2018</a></li><li><a href="/2017/">2017</a></li><li><a href="/2016/">2016</a></li><li><a href="/2015/">2015</a></li><li><a href="/2014/">2014</a></li><li><a href="/2013/">2013</a></li><li><a href="/2012/">2012</a></li><li><a href="/2011/">2011</a></li><li><a href="/2010/">2010</a></li><li><a href="/2009/">2009</a></li><li><a href="/2008/">2008</a></li><li><a href="/2007/">2007</a></li><li><a href="/2006/">2006</a></li><li class="nt"><a href="/2005/">2005</a></li><li class="ns"><a href="/xmlfeed/weblog-rss20.xml">RSS Feed</a></li><li class="nt"><a href="/xmlfeed/weblog-atom10.xml">XML Atom</a></li><li class="ns"><a href="/search.html">Search</a></li></ul></li><li class="top"><a class="ni" href="/tags/"><i class="icon-tags"></i> Tags</a><div style="width: 14em; margin-left: -9em; margin-top: 4px"><a style="font-size: 10pt" href="/tags/algebra.html">algebra</a> <a style="font-size: 16pt" href="/tags/c++.html">c++</a> <a style="font-size: 12pt" href="/tags/code-example.html">code-example</a> <a style="font-size: 14pt" href="/tags/code-snippet.html">code-snippet</a> <a style="font-size: 11pt" href="/tags/coding_tricks.html">coding tricks</a> <a style="font-size: 10pt" href="/tags/compsci.html">compsci</a> <a style="font-size: 10pt" href="/tags/compsci_study_thesis.html">compsci study thesis</a> <a style="font-size: 9pt" href="/tags/crypto-speedtest.html">crypto-speedtest</a> <a style="font-size: 10pt" href="/tags/cryptography.html">cryptography</a> <a style="font-size: 9pt" href="/tags/cryptote.html">cryptote</a> <a style="font-size: 11pt" href="/tags/dissertation.html">dissertation</a> <a style="font-size: 12pt" href="/tags/flex-bison-cpp-example.html">flex-bison-cpp-example</a> <a style="font-size: 16pt" href="/tags/frontpage.html">frontpage</a> <a style="font-size: 15pt" href="/tags/fun.html">fun</a> <a style="font-size: 10pt" href="/tags/graphviz.html">graphviz</a> <a style="font-size: 9pt" href="http://www.hmtg.de">hartmetall</a> <a style="font-size: 9pt" href="/tags/helppc.html">helppc</a> <a style="font-size: 9pt" href="/tags/hifi_selbstbau.html">hifi selbstbau</a> <a style="font-size: 10pt" href="/tags/latex.html">latex</a> <a style="font-size: 10pt" href="/tags/librivox.html">librivox</a> <a style="font-size: 10pt" href="/tags/linux.html">linux</a> <a style="font-size: 9pt" href="/tags/market.html">market</a> <a style="font-size: 9pt" href="/tags/massive-sorting.html">massive-sorting</a> <a style="font-size: 11pt" href="/tags/maths.html">maths</a> <a style="font-size: 9pt" href="/tags/music.html">music</a> <a style="font-size: 10pt" href="/tags/netfundamentals.html">netfundamentals</a> <a style="font-size: 11pt" href="/tags/ns-3.html">ns-3</a> <a style="font-size: 10pt" href="/tags/parallel-string-sorting.html">parallel-string-sorting</a> <a style="font-size: 14pt" href="/tags/parsing.html">parsing</a> <a style="font-size: 9pt" href="/tags/qtsqlview.html">qtsqlview</a> <a style="font-size: 14pt" href="/tags/research.html">research</a> <a style="font-size: 11pt" href="/tags/sdios06.html">sdios06</a> <a style="font-size: 9pt" href="/tags/sdlfractal.html">sdlfractal</a> <a style="font-size: 14pt" href="/tags/sorting.html">sorting</a> <a style="font-size: 11pt" href="/tags/sound_of_sorting.html">sound of sorting</a> <a style="font-size: 10pt" href="/tags/stringology.html">stringology</a> <a style="font-size: 16pt" href="/tags/stx-btree.html">stx-btree</a> <a style="font-size: 16pt" href="/tags/stxxl.html">stxxl</a> <a style="font-size: 16pt" href="/tags/talk.html">talk</a> <a style="font-size: 15pt" href="/tags/thrill.html">thrill</a> <a style="font-size: 10pt" href="/tags/tutorium.html">tutorium</a> <a style="font-size: 16pt" href="/tags/university.html">university</a> <a style="font-size: 13pt" href="/tags/utilities.html">utilities</a> <a style="font-size: 10pt" href="/tags/vncrec.html">vncrec</a> <a style="font-size: 9pt" href="/tags/webdesign.html">webdesign</a> </div></li><li class="top"> <a class="ni" href="#"><i class="icon-cubes"></i> Projects</a> <ul style="margin-left: -8em; margin-top: 4px;" class="nx"> <li><a href="/2009/cryptote/">CryptoTE</a></li> <li><a href="/2009/digup/">digup</a></li> <li><a href="/2013/disk-filltest/">disk-filltest</a></li> <li><a href="/2012/1119-eSAIS-Inducing-Suffix-and-LCP-Arrays-in-External-Memory/">eSAIS-LCP</a></li> <li><a href="/2007/flex-bison-cpp-example/">Flex Bison C++ Example</a></li> <li><a href="/2013/malloc_count/">malloc_count</a></li> <li><a href="/2016/0114-diploma-thesis/">On Bispanning Graphs</a></li> <li><a href="/2013/pmbw/">Parallel Memory Bandwidth</a></li> <li><a href="/2013/parallel-string-sorting/">Parallel String Sorting</a></li> <li><a href="/2014/sqlplot-tools/">SqlPlotTools</a></li> <li><a href="/2013/sound-of-sorting/">The Sound of Sorting</a></li> <li><a href="/2007/stx-btree/">STX B+ Tree</a></li> <li><a href="/2010/stx-cbtreedb/">STX Constant BTreeDB</a></li> <li><a href="/2010/stx-execpipe/">STX ExecPipe</a></li> <li><a href="/2007/stx-exparser/">STX Expression Parser</a></li> <li><a href="/tags/stxxl.html">STXXL 1.4</a></li> <li><a href="/tags/thrill.html">Thrill - Big Data Framework</a></li> <li class="nt"><a href="/2014/vncrec-rgb/">VNCrec RGB 0.4</a></li> <li class="ns"><a href="/search.html">Search</a></li> </ul></li><li class="top"> <a class="ni" href="/publications.html"><i class="icon-graduation-cap"></i> Publications</a></li><li class="top"> <a class="ni" href="/about/"><i class="icon-info-circled"></i> About</a> <ul style="margin-left: -6em; margin-top: 4px" class="nx"> <li><a href="/about/">Timo Bingmann</a></li> <li><a href="/about/impressum.html">Impressum</a></li> </ul></li><li class="top"> <a class="ni" href="/subscribe.html"><i class="icon-rss-squared"></i> Subscribe</a></li></ul></div><div style="padding: 6px"><a href="/">panthema</a>  / <a href="/2018/">2018</a> / <a href="/2018/0912-Boost-Spirit-Tutorial/">0912-Boost-Spirit-Tutorial</a> / <a href="/2018/0912-Boost-Spirit-Tutorial/examples/">examples</a> / <a href="/2018/0912-Boost-Spirit-Tutorial/examples/spirit7_html.cpp.html">spirit7_html.cpp</a> (<a href="/2018/0912-Boost-Spirit-Tutorial/examples/spirit7_html.cpp">Download File</a>)</div></div><div class="ptfullwidth"><pre class="codesnippet" style="font-family: monospace"><tt><span class="comment">// Example how to use Boost Spirit to parse a HTML-like markup language with</span>
<span class="comment">// Markdown elements and enable additional instructions. This example was</span>
<span class="comment">// extracted from a HTML template engine, but only the AST printer is included.</span>
<span class="comment">//</span>
<span class="comment">// This example is designed to read "example.html".</span>

<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;fstream&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;iostream&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;iomanip&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;stdexcept&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;memory&gt;</span>

<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;boost/spirit/include/qi.hpp&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;boost/spirit/include/phoenix.hpp&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;boost/variant/recursive_variant.hpp&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;boost/fusion/include/adapt_struct.hpp&gt;</span>

<span class="keyword">namespace</span><span class="normal"> qi </span><span class="symbol">=</span><span class="normal"> boost</span><span class="symbol">::</span><span class="normal">spirit</span><span class="symbol">::</span><span class="normal">qi</span><span class="symbol">;</span>
<span class="keyword">namespace</span><span class="normal"> phx </span><span class="symbol">=</span><span class="normal"> boost</span><span class="symbol">::</span><span class="normal">phoenix</span><span class="symbol">;</span>
<span class="keyword">namespace</span><span class="normal"> ascii </span><span class="symbol">=</span><span class="normal"> boost</span><span class="symbol">::</span><span class="normal">spirit</span><span class="symbol">::</span><span class="normal">ascii</span><span class="symbol">;</span>

<span class="comment">/******************************************************************************/</span>
<span class="comment">// AST node structs</span>

<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_null</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_comment</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_nodelist</span><span class="symbol">;</span>

<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_variable</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_string</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_integer</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_double</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_call</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_filter</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_set</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_if</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_for</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_expr</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_template</span><span class="symbol">;</span>

<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_tagged_node</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_html_node</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_html_selfnode</span><span class="symbol">;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_highlight</span><span class="symbol">;</span>

<span class="comment">// boost variant representing an AST node</span>

<span class="keyword">typedef</span><span class="normal"> boost</span><span class="symbol">::</span><span class="normal">variant</span><span class="symbol">&lt;</span>
<span class="normal">    ast_null</span><span class="symbol">,</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span>
<span class="normal">    ast_comment</span><span class="symbol">,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_nodelist</span><span class="symbol">&gt;,</span>
<span class="normal">    ast_func_variable</span><span class="symbol">,</span>
<span class="normal">    ast_func_string</span><span class="symbol">,</span>
<span class="normal">    ast_func_integer</span><span class="symbol">,</span>
<span class="normal">    ast_func_double</span><span class="symbol">,</span>
<span class="normal">    ast_func_template</span><span class="symbol">,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_func_call</span><span class="symbol">&gt;,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_func_filter</span><span class="symbol">&gt;,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_func_set</span><span class="symbol">&gt;,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_func_if</span><span class="symbol">&gt;,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_func_for</span><span class="symbol">&gt;,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_func_expr</span><span class="symbol">&gt;,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_tagged_node</span><span class="symbol">&gt;,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_html_node</span><span class="symbol">&gt;,</span>
<span class="normal">    boost</span><span class="symbol">::</span><span class="normal">recursive_wrapper</span><span class="symbol">&lt;</span><span class="normal">ast_html_selfnode</span><span class="symbol">&gt;,</span>
<span class="normal">    ast_highlight</span>
<span class="normal">    </span><span class="symbol">&gt;</span>
<span class="normal">ast_node</span><span class="symbol">;</span>

<span class="comment">// *** Individual AST node structs</span>

<span class="comment">//! represent null or undefined</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_null</span>
<span class="cbracket">{</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">//! a comment &lt;# clause #&gt;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_comment</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="keyword">public</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span>
<span class="cbracket">{</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">//! a sequence of multiple AST nodes</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_nodelist</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="keyword">public</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">vector</span><span class="symbol">&lt;</span><span class="normal">ast_node</span><span class="symbol">&gt;</span>
<span class="cbracket">{</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">//! MyFunc node representing a variable</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_variable</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="keyword">public</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span>
<span class="cbracket">{</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">//! MyFunc node representing a literal string</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_string</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="keyword">public</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span>
<span class="cbracket">{</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">//! MyFunc node representing a template name</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_template</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="keyword">public</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span>
<span class="cbracket">{</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">//! MyFunc node representing a literal integer</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_integer</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="type">long</span><span class="normal"> </span><span class="type">long</span><span class="normal">   value</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">explicit</span><span class="normal"> </span><span class="keyword">inline</span><span class="normal"> </span><span class="function">ast_func_integer</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> </span><span class="type">long</span><span class="normal"> </span><span class="type">long</span><span class="symbol">&amp;</span><span class="normal"> v</span><span class="symbol">=</span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">        </span><span class="symbol">:</span><span class="normal"> </span><span class="function">value</span><span class="symbol">(</span><span class="normal">v</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{}</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_func_integer</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="type">long</span><span class="normal"> </span><span class="type">long</span><span class="symbol">,</span><span class="normal"> value</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! MyFunc node representing a literal double</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_double</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="type">double</span><span class="normal">      value</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_func_double</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="type">double</span><span class="symbol">,</span><span class="normal"> value</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! tagged sequence of multiple AST nodes with HTML attributes, like &lt;p [attr]&gt; [nodes] &lt;/p&gt;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_highlight</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">                 language</span><span class="symbol">;</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">                 content</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_highlight</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> language</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> content</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! MyFunc node representing a function call with argument list</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_call</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">         funcname</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_nodelist</span><span class="normal">        args</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_func_call</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> funcname</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_nodelist</span><span class="symbol">,</span><span class="normal"> args</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! MyFunc node representing a conditional clause</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_filter</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal">            node</span><span class="symbol">;</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">         content</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_func_filter</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> node</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> content</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! MyFunc node representing a function call with argument list and filter content</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_set</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">         varname</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal">            value</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_func_set</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> varname</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> value</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! MyFunc node representing a function call with argument list and filter content</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_if</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal">            condition</span><span class="symbol">,</span><span class="normal"> iftrue</span><span class="symbol">,</span><span class="normal"> iffalse</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_func_if</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> condition</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> iftrue</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> iffalse</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! MyFunc node representing a function call with argument list and filter content</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_for</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">         varname</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal">            arg</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal">            subtree</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_func_for</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> varname</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> arg</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> subtree</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! MyFunc node representing a sequence of expressions with operators intermingled</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_func_expr</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="keyword">public</span><span class="normal"> ast_nodelist</span>
<span class="cbracket">{</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">//! tagged sequence of multiple AST nodes like &lt;p&gt; [nodes] &lt;/p&gt;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_tagged_node</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">         tag</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal">            subtree</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_tagged_node</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> tag</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> subtree</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! key-value attributes for HTML like name=value</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_html_attr</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">         name</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal">            value</span><span class="symbol">;</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_html_attr</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> name</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> value</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! a sequence of multiple key-value attributes for HTML</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_html_attrlist</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="keyword">public</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">vector</span><span class="symbol">&lt;</span><span class="normal">ast_html_attr</span><span class="symbol">&gt;</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">const</span><span class="normal"> ast_html_attr</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">find</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> key</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">const</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="usertype">const_iterator</span><span class="normal"> it </span><span class="symbol">=</span><span class="normal"> </span><span class="function">begin</span><span class="symbol">();</span><span class="normal"> it </span><span class="symbol">!=</span><span class="normal"> </span><span class="function">end</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">it</span><span class="symbol">)</span>
<span class="normal">        </span><span class="cbracket">{</span>
<span class="normal">            </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">it</span><span class="symbol">-&gt;</span><span class="normal">name </span><span class="symbol">!=</span><span class="normal"> key</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">continue</span><span class="symbol">;</span>
<span class="normal">            </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">it</span><span class="symbol">;</span>
<span class="normal">        </span><span class="cbracket">}</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"{ERROR cannot find HTML attribute "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> key </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"}"</span>
<span class="normal">                  </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">abort</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">//! tagged sequence of multiple AST nodes with HTML attributes, like &lt;p [attr]&gt; [nodes] &lt;/p&gt;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_html_node</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">         tag</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_html_attrlist</span><span class="normal">   attrlist</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal">            subtree</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">ast_html_node</span><span class="symbol">()</span><span class="normal"> </span><span class="cbracket">{}</span>

<span class="normal">    </span><span class="function">ast_html_node</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> _tag</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> ast_html_attr</span><span class="symbol">&amp;</span><span class="normal"> attr</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> ast_node</span><span class="symbol">&amp;</span><span class="normal"> _subtree</span><span class="symbol">)</span>
<span class="normal">        </span><span class="symbol">:</span><span class="normal"> </span><span class="function">tag</span><span class="symbol">(</span><span class="normal">_tag</span><span class="symbol">),</span><span class="normal"> </span><span class="function">subtree</span><span class="symbol">(</span><span class="normal">_subtree</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        attrlist</span><span class="symbol">.</span><span class="function">push_back</span><span class="symbol">(</span><span class="normal">attr</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_html_node</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> tag</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_html_attrlist</span><span class="symbol">,</span><span class="normal"> attrlist</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_node</span><span class="symbol">,</span><span class="normal"> subtree</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">//! tagged sequence of multiple AST nodes with HTML attributes, like &lt;img [attr] /&gt;</span>
<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_html_selfnode</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal">         tag</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_html_attrlist</span><span class="normal">   attrlist</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">ast_html_selfnode</span><span class="symbol">()</span><span class="normal"> </span><span class="cbracket">{}</span>

<span class="normal">    </span><span class="function">ast_html_selfnode</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> _tag</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> ast_html_attr</span><span class="symbol">&amp;</span><span class="normal"> attr1</span><span class="symbol">)</span>
<span class="normal">        </span><span class="symbol">:</span><span class="normal"> </span><span class="function">tag</span><span class="symbol">(</span><span class="normal">_tag</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        attrlist</span><span class="symbol">.</span><span class="function">push_back</span><span class="symbol">(</span><span class="normal">attr1</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="function">ast_html_selfnode</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> _tag</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> ast_html_attr</span><span class="symbol">&amp;</span><span class="normal"> attr1</span><span class="symbol">,</span>
<span class="normal">                      </span><span class="keyword">const</span><span class="normal"> ast_html_attr</span><span class="symbol">&amp;</span><span class="normal"> attr2</span><span class="symbol">)</span>
<span class="normal">        </span><span class="symbol">:</span><span class="normal"> </span><span class="function">tag</span><span class="symbol">(</span><span class="normal">_tag</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        attrlist</span><span class="symbol">.</span><span class="function">push_back</span><span class="symbol">(</span><span class="normal">attr1</span><span class="symbol">);</span>
<span class="normal">        attrlist</span><span class="symbol">.</span><span class="function">push_back</span><span class="symbol">(</span><span class="normal">attr2</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="function">BOOST_FUSION_ADAPT_STRUCT</span><span class="symbol">(</span>
<span class="normal">    ast_html_selfnode</span><span class="symbol">,</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">,</span><span class="normal"> tag</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">(</span><span class="normal">ast_html_attrlist</span><span class="symbol">,</span><span class="normal"> attrlist</span><span class="symbol">)</span>
<span class="symbol">)</span>

<span class="comment">/******************************************************************************/</span>
<span class="comment">// MyMarkup parser</span>

<span class="keyword">struct</span><span class="normal"> </span><span class="classname">MyMarkupParser</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">grammar</span><span class="symbol">&lt;</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">::</span><span class="normal">const_iterator</span><span class="symbol">,</span><span class="normal"> </span><span class="function">ast_node</span><span class="symbol">()&gt;</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">typedef</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">::</span><span class="usertype">const_iterator</span><span class="normal"> Iterator</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** General Base Character Parsers</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, std::string()&gt;</span><span class="normal"> HtmlText</span><span class="symbol">,</span><span class="normal"> SpecialChar</span><span class="symbol">,</span><span class="normal"> PlainText</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator&gt;</span><span class="normal"> BlankLine</span><span class="symbol">,</span><span class="normal"> Indent</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Inline Blocks with Special Formatting</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node()&gt;</span><span class="normal"> Inline</span><span class="symbol">,</span><span class="normal"> InlinePlain</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_comment()&gt;</span><span class="normal"> Comment</span><span class="symbol">,</span><span class="normal"> CommentBlock</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_tagged_node()&gt;</span><span class="normal"> Code</span><span class="symbol">,</span><span class="normal"> Emph</span><span class="symbol">,</span><span class="normal"> Strong</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> CodeBlock</span><span class="symbol">,</span><span class="normal"> EmphBlock</span><span class="symbol">,</span><span class="normal"> StrongBlock</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_node()&gt;</span><span class="normal"> MarkLink</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> MarkLinkText</span><span class="symbol">,</span><span class="normal"> MarkLinkRefList</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_attr()&gt;</span><span class="normal"> MarkLinkRef</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_selfnode()&gt;</span><span class="normal"> MarkImage</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_attr()&gt;</span><span class="normal"> MarkImageAlt</span><span class="symbol">,</span><span class="normal"> MarkImageSrc</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_selfnode()&gt;</span><span class="normal"> MarkDownload</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_attr()&gt;</span><span class="normal"> MarkDownloadRef</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, std::string()&gt;</span><span class="normal"> HttpLink</span><span class="symbol">,</span><span class="normal"> SelfLink</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node()&gt;</span><span class="normal"> FuncBlock</span><span class="symbol">,</span><span class="normal"> FuncInline</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_filter()&gt;</span><span class="normal"> FilterBlock</span><span class="symbol">,</span><span class="normal"> FilterInline</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, std::string()&gt;</span><span class="normal"> VerbatimBlock</span><span class="symbol">,</span><span class="normal"> VerbatimInline</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Inline HTML blocks</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, std::string()&gt;</span><span class="normal"> HtmlTagName</span><span class="symbol">,</span><span class="normal"> HtmlComment</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node()&gt;</span><span class="normal"> HtmlPhrase</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_node()&gt;</span><span class="normal"> HtmlTagBlock</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_selfnode()&gt;</span><span class="normal"> HtmlTagSelfClose</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> HtmlInline</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_html_attr()&gt;</span><span class="normal"> HtmlAttribute</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> HtmlQuoted</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, std::string()&gt;</span><span class="normal"> HtmlQuotedText</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Paragraph Blocks: Enumerations</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator&gt;</span><span class="normal"> Bullet</span><span class="symbol">,</span><span class="normal"> Enumet</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_tagged_node()&gt;</span><span class="normal"> BulletList0</span><span class="symbol">,</span><span class="normal"> BulletList1</span><span class="symbol">,</span><span class="normal"> BulletList2</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_tagged_node()&gt;</span><span class="normal"> OrderedList0</span><span class="symbol">,</span><span class="normal"> OrderedList1</span><span class="symbol">,</span><span class="normal"> OrderedList2</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> List0</span><span class="symbol">,</span><span class="normal"> List1</span><span class="symbol">,</span><span class="normal"> List2</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_tagged_node()&gt;</span><span class="normal"> ListItem0</span><span class="symbol">,</span><span class="normal"> ListItem1</span><span class="symbol">,</span><span class="normal"> ListItem2</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> ListBlock0</span><span class="symbol">,</span><span class="normal"> ListBlock1</span><span class="symbol">,</span><span class="normal"> ListBlock2</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> ListBlockLine0</span><span class="symbol">,</span><span class="normal"> ListBlockLine1</span><span class="symbol">,</span><span class="normal"> ListBlockLine2</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> Line</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Paragraph Blocks: Headers</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_tagged_node()&gt;</span><span class="normal"> Header</span><span class="symbol">,</span><span class="normal"> Header1</span><span class="symbol">,</span><span class="normal"> Header2</span><span class="symbol">,</span><span class="normal"> Header3</span><span class="symbol">,</span><span class="normal"> Header4</span><span class="symbol">,</span><span class="normal"> Header5</span><span class="symbol">,</span><span class="normal"> Header6</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> HeaderA</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, std::string()&gt;</span><span class="normal"> HeaderAnchor</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_tagged_node()&gt;</span><span class="normal"> Header1A</span><span class="symbol">,</span><span class="normal"> Header2A</span><span class="symbol">,</span><span class="normal"> Header3A</span><span class="symbol">,</span><span class="normal"> Header4A</span><span class="symbol">,</span><span class="normal"> Header5A</span><span class="symbol">,</span><span class="normal"> Header6A</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Source Highlighting Code Blocks</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_highlight()&gt;</span><span class="normal"> HighlightBlock</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Paragraph Blocks: Paragraphs and Plain</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_tagged_node()&gt;</span><span class="normal"> Paragraph</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> ParagraphBlock</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> InlineList</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node()&gt;</span><span class="normal"> Block</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_nodelist()&gt;</span><span class="normal"> BlockList</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node()&gt;</span><span class="normal"> Start</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Inline Procedural Language</span>

<span class="normal">    </span><span class="keyword">typedef</span><span class="normal"> qi</span><span class="symbol">::</span><span class="usertype">space_type</span><span class="normal"> Skip</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, std::string()&gt;</span><span class="normal"> FIdentifier</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_variable(), Skip&gt;</span><span class="normal"> FVariable</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_string()&gt;</span><span class="normal"> FString</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_double(), Skip&gt;</span><span class="normal"> FDouble</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_integer(), Skip&gt;</span><span class="normal"> FInteger</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_call(), Skip&gt;</span><span class="normal"> FCall</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node(), Skip&gt;</span><span class="normal"> FBracket</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node(), Skip&gt;</span><span class="normal"> FAtomic</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_expr(), Skip&gt;</span><span class="normal"> FExpr</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_set(), Skip&gt;</span><span class="normal"> FSetClause</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_if(), Skip&gt;</span><span class="normal"> FIfClause</span><span class="symbol">,</span><span class="normal"> FEvalIfClause</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_for(), Skip&gt;</span><span class="normal"> FForClause</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_call(), Skip&gt;</span><span class="normal"> FInclude</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node(), Skip&gt;</span><span class="normal"> FClause</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_variable(), Skip&gt;</span><span class="normal"> FFilterSetClause</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_func_template(), Skip&gt;</span><span class="normal"> FFilterTemplateClause</span><span class="symbol">;</span>
<span class="normal">    qi</span><span class="symbol">::</span><span class="usertype">rule&lt;Iterator, ast_node(), Skip&gt;</span><span class="normal"> FFilterClause</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Construction</span>

<span class="normal">    </span><span class="function">MyMarkupParser</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">static</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> MyMarkupParser</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">get</span><span class="symbol">();</span><span class="normal"> </span><span class="comment">// get singleton</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="normal">MyMarkupParser</span><span class="symbol">::</span><span class="function">MyMarkupParser</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="function">base_type</span><span class="symbol">(</span><span class="normal">Start</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"MyMarkupParser"</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">using</span><span class="normal"> </span><span class="keyword">namespace</span><span class="normal"> boost</span><span class="symbol">::</span><span class="normal">spirit</span><span class="symbol">::</span><span class="normal">ascii</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">using</span><span class="normal"> </span><span class="keyword">namespace</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">labels</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">using</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">lit</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">using</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">eoi</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">using</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">eol</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">using</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">attr</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">using</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">omit</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">using</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">as_string</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="normal">    </span><span class="comment">// *** General Base Character Parsers</span>

<span class="normal">    </span><span class="comment">// text is composed of non-special characters</span>
<span class="normal">    HtmlText </span><span class="symbol">=</span><span class="normal">      </span><span class="symbol">+(</span><span class="normal"> </span><span class="function">char_</span><span class="symbol">(</span><span class="string">"A-Za-z0-9~@$^.,:;_=+({}|?/-"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> _1 </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'&amp;'</span><span class="symbol">)</span><span class="normal">     </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;amp;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'"'</span><span class="symbol">)</span><span class="normal">     </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;quot;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\'</span><span class="string">'</span><span class="symbol">)</span><span class="normal">    </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;apos;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'&gt;'</span><span class="symbol">)</span><span class="normal">     </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;gt;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">04'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;Auml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">26'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;Ouml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">34'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;Uuml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">37'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;szlig;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">44'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;auml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">50'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;egrave;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">51'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;eacute;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">66'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;ouml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">74'</span><span class="symbol">)</span><span class="normal">  </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;uuml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="symbol">(+</span><span class="normal">blank </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">-(</span><span class="normal">eol </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">blank </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">eol</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">" "</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                       </span><span class="symbol">|</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">eol </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">blank </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">eol</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">" "</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">        </span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// special characters, accepted if no special meaning</span>
<span class="normal">    SpecialChar </span><span class="symbol">=</span><span class="normal">   </span><span class="symbol">(</span><span class="normal"> </span><span class="function">char_</span><span class="symbol">(</span><span class="string">"*`#[])!"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> _1 </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="comment">//| (lit('&lt;') &gt;&gt; !lit("%")) [ _val += "&amp;lt;" ]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\\\</span><span class="string">"</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'</span><span class="specialchar">\\</span><span class="string">'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\\"</span><span class="string">"</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'"'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\</span><span class="string">&amp;"</span><span class="symbol">)</span><span class="normal">    </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'&amp;'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\</span><span class="string">*"</span><span class="symbol">)</span><span class="normal">    </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'*'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\</span><span class="string">#"</span><span class="symbol">)</span><span class="normal">    </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'#'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\</span><span class="string">`"</span><span class="symbol">)</span><span class="normal">    </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'`'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\</span><span class="string">["</span><span class="symbol">)</span><span class="normal">    </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'['</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\</span><span class="string">&lt;"</span><span class="symbol">)</span><span class="normal">    </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;lt;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                      </span><span class="symbol">|</span><span class="normal"> </span><span class="symbol">(</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'%'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'%'</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'%'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">        </span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// a blank file</span>
<span class="normal">    BlankLine </span><span class="symbol">=</span><span class="normal">     </span><span class="symbol">*</span><span class="normal">blank </span><span class="symbol">&gt;&gt;</span><span class="normal"> eol</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// identation for lists</span>
<span class="normal">    Indent </span><span class="symbol">=</span><span class="normal">        </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\t</span><span class="string">'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"  "</span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="normal">    </span><span class="comment">// *** Inline Blocks with Special Formatting</span>

<span class="normal">    Inline </span><span class="symbol">%=</span><span class="normal">       Comment </span><span class="symbol">|</span><span class="normal"> VerbatimInline </span><span class="symbol">|</span><span class="normal"> FilterInline </span><span class="symbol">|</span><span class="normal"> FuncInline </span><span class="symbol">|</span><span class="normal"> Code </span><span class="symbol">|</span><span class="normal"> Strong </span><span class="symbol">|</span><span class="normal"> Emph </span><span class="symbol">|</span><span class="normal"> SelfLink </span><span class="symbol">|</span><span class="normal"> MarkDownload </span><span class="symbol">|</span><span class="normal"> MarkLink </span><span class="symbol">|</span><span class="normal"> MarkImage </span><span class="symbol">|</span><span class="normal"> HtmlPhrase </span><span class="symbol">|</span><span class="normal"> HtmlText </span><span class="symbol">|</span><span class="normal"> SpecialChar</span><span class="symbol">;</span>

<span class="normal">    InlinePlain </span><span class="symbol">%=</span><span class="normal">  Comment </span><span class="symbol">|</span><span class="normal"> VerbatimInline </span><span class="symbol">|</span><span class="normal"> FilterInline </span><span class="symbol">|</span><span class="normal"> FuncInline </span><span class="symbol">|</span><span class="normal"> PlainText</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// inline comments</span>

<span class="normal">    Comment </span><span class="symbol">%=</span><span class="normal">      </span><span class="string">"&lt;%#"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"%&gt;"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> char_</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%&gt;"</span><span class="symbol">;</span>

<span class="normal">    CommentBlock </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">"&lt;%#"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"%&gt;"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> char_</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%&gt;"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">eol</span><span class="symbol">];</span>

<span class="normal">    </span><span class="comment">// inline styling blocks</span>

<span class="normal">    Code </span><span class="symbol">%=</span><span class="normal">         </span><span class="string">'`'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"code"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> CodeBlock </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'`'</span><span class="symbol">;</span>
<span class="normal">    CodeBlock </span><span class="symbol">%=</span><span class="normal">    </span><span class="symbol">+(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'`'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Inline</span><span class="symbol">);</span>

<span class="normal">    Emph </span><span class="symbol">%=</span><span class="normal">         </span><span class="string">'*'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"i"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> EmphBlock </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'*'</span><span class="symbol">;</span>
<span class="normal">    EmphBlock </span><span class="symbol">%=</span><span class="normal">    </span><span class="symbol">+(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'*'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Inline</span><span class="symbol">);</span>

<span class="normal">    Strong </span><span class="symbol">%=</span><span class="normal">       </span><span class="string">"**"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"b"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> StrongBlock </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"**"</span><span class="symbol">;</span>
<span class="normal">    StrongBlock </span><span class="symbol">%=</span><span class="normal">  </span><span class="symbol">+(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"**"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Inline</span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// markdown inline links</span>

<span class="normal">    MarkLink </span><span class="symbol">=</span><span class="normal">      </span><span class="symbol">(</span><span class="string">'['</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> MarkLinkText </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"]("</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> MarkLinkRef </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">')'</span><span class="symbol">)</span>
<span class="normal">        </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">=</span><span class="normal"> phx</span><span class="symbol">::</span><span class="normal">construct</span><span class="symbol">&lt;</span><span class="normal">ast_html_node</span><span class="symbol">&gt;(</span><span class="normal">std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="string">"markdown-a"</span><span class="symbol">),</span><span class="normal"> _2</span><span class="symbol">,</span><span class="normal"> _1</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">];</span>

<span class="normal">    MarkLinkText </span><span class="symbol">%=</span><span class="normal"> </span><span class="symbol">+(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">']'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Inline</span><span class="symbol">);</span>
<span class="normal">    MarkLinkRef </span><span class="symbol">%=</span><span class="normal">  </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"href"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> MarkLinkRefList</span><span class="symbol">;</span>
<span class="normal">    MarkLinkRefList </span><span class="symbol">%=</span><span class="normal"> </span><span class="symbol">+(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">')'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Inline</span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// markdown inline images</span>

<span class="normal">    MarkImage </span><span class="symbol">=</span><span class="normal">     </span><span class="symbol">(</span><span class="string">"!["</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> MarkImageAlt </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"]("</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> MarkImageSrc </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">')'</span><span class="symbol">)</span>
<span class="normal">        </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">=</span><span class="normal"> phx</span><span class="symbol">::</span><span class="normal">construct</span><span class="symbol">&lt;</span><span class="normal">ast_html_selfnode</span><span class="symbol">&gt;(</span><span class="normal">std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="string">"markdown-img"</span><span class="symbol">),</span><span class="normal"> _1</span><span class="symbol">,</span><span class="normal"> _2</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">];</span>

<span class="normal">    MarkImageAlt </span><span class="symbol">%=</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"alt"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> MarkLinkText</span><span class="symbol">;</span>
<span class="normal">    MarkImageSrc </span><span class="symbol">%=</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"src"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> MarkLinkRefList</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// markdown download/view links</span>

<span class="normal">    MarkDownload </span><span class="symbol">=</span><span class="normal">  </span><span class="string">"[["</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span>
<span class="normal">        MarkDownloadRef </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">=</span><span class="normal"> phx</span><span class="symbol">::</span><span class="normal">construct</span><span class="symbol">&lt;</span><span class="normal">ast_html_selfnode</span><span class="symbol">&gt;(</span><span class="normal">std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="string">"markdown-download"</span><span class="symbol">),</span><span class="normal"> _1</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span>
<span class="normal">        </span><span class="string">"]]"</span><span class="symbol">;</span>

<span class="normal">    MarkDownloadRef </span><span class="symbol">%=</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"href"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> as_string</span><span class="symbol">[</span><span class="normal"> </span><span class="symbol">+~</span><span class="function">char_</span><span class="symbol">(</span><span class="string">']'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">];</span>

<span class="normal">    </span><span class="comment">// self-link inline</span>

<span class="normal">    HttpLink </span><span class="symbol">%=</span><span class="normal">     </span><span class="function">string</span><span class="symbol">(</span><span class="string">"http"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">+~</span><span class="function">char_</span><span class="symbol">(</span><span class="string">'&gt;'</span><span class="symbol">);</span>

<span class="normal">    SelfLink </span><span class="symbol">=</span><span class="normal">      </span><span class="symbol">&amp;</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"&lt;http"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'&lt;'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HttpLink</span>
<span class="normal">        </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">=</span><span class="normal"> </span><span class="string">"&lt;a href=</span><span class="specialchar">\"</span><span class="string">"</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> _1 </span><span class="symbol">+</span><span class="normal"> </span><span class="string">"</span><span class="specialchar">\"</span><span class="string">&gt;"</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> _1 </span><span class="symbol">+</span><span class="normal"> </span><span class="string">"&lt;/a&gt;"</span><span class="normal"> </span><span class="symbol">]</span><span class="normal">  </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'&gt;'</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// inline functional language</span>

<span class="normal">    FuncBlock </span><span class="symbol">%=</span><span class="normal">    </span><span class="string">"&lt;%"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> qi</span><span class="symbol">::</span><span class="function">skip</span><span class="symbol">(</span><span class="normal">qi</span><span class="symbol">::</span><span class="normal">space</span><span class="symbol">)[</span><span class="normal">FClause</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">space</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%&gt;"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[</span><span class="normal">eol</span><span class="symbol">];</span>

<span class="normal">    FuncInline </span><span class="symbol">%=</span><span class="normal">   </span><span class="string">"&lt;%"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> qi</span><span class="symbol">::</span><span class="function">skip</span><span class="symbol">(</span><span class="normal">qi</span><span class="symbol">::</span><span class="normal">space</span><span class="symbol">)[</span><span class="normal">FClause</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">space</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%&gt;"</span><span class="symbol">;</span>

<span class="normal">    FilterBlock </span><span class="symbol">%=</span><span class="normal">  </span><span class="string">"&lt;%|"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> qi</span><span class="symbol">::</span><span class="function">skip</span><span class="symbol">(</span><span class="normal">qi</span><span class="symbol">::</span><span class="normal">space</span><span class="symbol">)[</span><span class="normal">FFilterClause</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">space</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%&gt;"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[</span><span class="normal">eol</span><span class="symbol">]</span>
<span class="normal">                          </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!(</span><span class="normal">eol </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"&lt;%|%&gt;"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> char_</span><span class="symbol">)</span>
<span class="normal">                          </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[</span><span class="normal">eol</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"&lt;%|%&gt;"</span><span class="symbol">;</span>

<span class="normal">    FilterInline </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">"&lt;%|"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> qi</span><span class="symbol">::</span><span class="function">skip</span><span class="symbol">(</span><span class="normal">qi</span><span class="symbol">::</span><span class="normal">space</span><span class="symbol">)[</span><span class="normal">FFilterClause</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">space</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%&gt;"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[-</span><span class="normal">eol</span><span class="symbol">]</span>
<span class="normal">                          </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!(-</span><span class="normal">eol </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"&lt;%|%&gt;"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> char_</span><span class="symbol">)</span>
<span class="normal">                          </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[-</span><span class="normal">eol</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"&lt;%|%&gt;"</span><span class="symbol">;</span>

<span class="normal">    VerbatimBlock </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">"&lt;%$"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[</span><span class="normal">eol</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"%&gt;"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> char_</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%&gt;"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[</span><span class="normal">eol</span><span class="symbol">];</span>

<span class="normal">    VerbatimInline </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">"&lt;%$"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"%&gt;"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> char_</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%&gt;"</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="normal">    </span><span class="comment">// *** Inline HTML blocks</span>

<span class="normal">    HtmlTagName </span><span class="symbol">=</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"big"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"br"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"button"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"caption"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"code"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"col"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"dd"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"div"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"dl"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"dt"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"em"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"form"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"h1"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"h2"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"h3"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"h4"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"h5"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"h6"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"hr"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"iframe"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"img"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"input"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"li"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"longversion"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"object"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"ol"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"option"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"param"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"pre"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"select"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"script"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"span"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"strong"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"sup"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"table"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"tbody"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"td"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"textarea"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"tfoot"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"thead"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"tr"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"tt"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"ul"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="comment">// two letter overlap</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"th"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span>
<span class="normal">        </span><span class="comment">// one letter matches</span>
<span class="normal">        </span><span class="function">string</span><span class="symbol">(</span><span class="string">"a"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"b"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"i"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"p"</span><span class="symbol">)</span>
<span class="normal">        </span><span class="symbol">;</span>

<span class="normal">    HtmlPhrase </span><span class="symbol">%=</span><span class="normal">   </span><span class="symbol">&amp;</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'&lt;'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span><span class="normal"> HtmlTagBlock </span><span class="symbol">|</span><span class="normal"> HtmlComment </span><span class="symbol">|</span><span class="normal"> HtmlTagSelfClose </span><span class="symbol">);</span>

<span class="normal">    HtmlTagBlock </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">'&lt;'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HtmlTagName </span><span class="symbol">[</span><span class="normal">phx</span><span class="symbol">::</span><span class="normal">at_c</span><span class="symbol">&lt;</span><span class="number">0</span><span class="symbol">&gt;(</span><span class="normal">_val</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">=</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">_1</span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">HtmlAttribute </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">space</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'&gt;'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">eol</span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">&gt;&gt;</span><span class="normal"> HtmlInline</span>
<span class="normal">                        </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[</span><span class="string">"&lt;/"</span><span class="normal"> </span><span class="symbol">&gt;</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="normal">phx</span><span class="symbol">::</span><span class="normal">at_c</span><span class="symbol">&lt;</span><span class="number">0</span><span class="symbol">&gt;(</span><span class="normal">_val</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'&gt;'</span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">eol</span><span class="symbol">];</span>

<span class="normal">    HtmlInline </span><span class="symbol">%=</span><span class="normal">   </span><span class="symbol">*(</span><span class="normal"> Inline </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">eol</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">);</span>

<span class="normal">    HtmlTagSelfClose </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">'&lt;'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HtmlTagName</span>
<span class="normal">                            </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">HtmlAttribute </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">space</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"/&gt;"</span>
<span class="normal">                            </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">eol</span><span class="symbol">];</span>

<span class="normal">    HtmlComment </span><span class="symbol">%=</span><span class="normal">  </span><span class="function">string</span><span class="symbol">(</span><span class="string">"&lt;!--"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"--&gt;"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> char_</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">string</span><span class="symbol">(</span><span class="string">"--&gt;"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">eol</span><span class="symbol">];</span>

<span class="normal">    HtmlAttribute </span><span class="symbol">%=</span><span class="normal"> omit</span><span class="symbol">[+</span><span class="normal">space</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">+(</span><span class="normal">alnum </span><span class="symbol">|</span><span class="normal"> </span><span class="function">char_</span><span class="symbol">(</span><span class="string">'-'</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">space </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'='</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">space</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HtmlQuoted</span><span class="symbol">;</span>

<span class="normal">    HtmlQuotedText </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">+(</span><span class="normal"> </span><span class="function">char_</span><span class="symbol">(</span><span class="string">"A-Za-z0-9~!@#$%^.,:;_=+*()[]{}&gt;'|?/ -"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> _1 </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="symbol">(</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'&lt;'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'%'</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'&lt;'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'&amp;'</span><span class="symbol">)</span><span class="normal">      </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;amp;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">04'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;Auml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">26'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;Ouml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">34'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;Uuml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">37'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;szlig;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">44'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;auml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">50'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;egrave;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">51'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;eacute;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">66'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;ouml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\3</span><span class="string">74'</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">"&amp;uuml;"</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">                        </span><span class="symbol">|</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\\"</span><span class="string">"</span><span class="symbol">)</span><span class="normal">   </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">+=</span><span class="normal"> </span><span class="string">'"'</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">        </span><span class="symbol">);</span>

<span class="normal">    HtmlQuoted </span><span class="symbol">%=</span><span class="normal">   </span><span class="string">'"'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'"'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Comment </span><span class="symbol">|</span><span class="normal"> FuncInline </span><span class="symbol">|</span><span class="normal"> HtmlQuotedText</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'"'</span><span class="symbol">;</span>

<span class="normal">    qi</span><span class="symbol">::</span><span class="normal">on_error</span><span class="symbol">&lt;</span><span class="normal">qi</span><span class="symbol">::</span><span class="normal">fail</span><span class="symbol">&gt;(</span>
<span class="normal">        HtmlTagBlock</span><span class="symbol">,</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> phx</span><span class="symbol">::</span><span class="function">val</span><span class="symbol">(</span><span class="string">"{debug error expecting "</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> _4 </span><span class="symbol">&lt;&lt;</span><span class="normal"> phx</span><span class="symbol">::</span><span class="function">val</span><span class="symbol">(</span><span class="string">" here: </span><span class="specialchar">\"</span><span class="string">"</span><span class="symbol">)</span>
<span class="normal">        </span><span class="symbol">&lt;&lt;</span><span class="normal"> phx</span><span class="symbol">::</span><span class="normal">construct</span><span class="symbol">&lt;</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&gt;(</span><span class="normal">_3</span><span class="symbol">,</span><span class="normal"> _2</span><span class="symbol">)</span><span class="normal">   </span><span class="comment">// iterators to error-pos, end</span>
<span class="normal">        </span><span class="symbol">&lt;&lt;</span><span class="normal"> phx</span><span class="symbol">::</span><span class="function">val</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\"</span><span class="string">}"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span>
<span class="normal">        </span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="normal">    </span><span class="comment">// *** Paragraph Blocks: Enumerations</span>

<span class="normal">    Bullet </span><span class="symbol">=</span><span class="normal">          </span><span class="function">char_</span><span class="symbol">(</span><span class="string">"+*-"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">+</span><span class="normal">blank</span><span class="symbol">;</span>
<span class="normal">    Enumet </span><span class="symbol">=</span><span class="normal">          </span><span class="symbol">+</span><span class="normal">digit </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'.'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">+</span><span class="normal">blank</span><span class="symbol">;</span>

<span class="normal">    BulletList0 </span><span class="symbol">%=</span><span class="normal">    </span><span class="symbol">&amp;</span><span class="normal">Bullet </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"ul"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> List0</span><span class="symbol">;</span>
<span class="normal">    OrderedList0 </span><span class="symbol">%=</span><span class="normal">   </span><span class="symbol">&amp;</span><span class="normal">Enumet </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"ol"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> List0</span><span class="symbol">;</span>

<span class="normal">    BulletList1 </span><span class="symbol">%=</span><span class="normal">    </span><span class="symbol">&amp;(</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Bullet</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"ul"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> List1</span><span class="symbol">;</span>
<span class="normal">    OrderedList1 </span><span class="symbol">%=</span><span class="normal">   </span><span class="symbol">&amp;(</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Enumet</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"ol"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> List1</span><span class="symbol">;</span>

<span class="normal">    BulletList2 </span><span class="symbol">%=</span><span class="normal">    </span><span class="symbol">&amp;(</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Bullet</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"ul"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> List2</span><span class="symbol">;</span>
<span class="normal">    OrderedList2 </span><span class="symbol">%=</span><span class="normal">   </span><span class="symbol">&amp;(</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Enumet</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"ol"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> List2</span><span class="symbol">;</span>

<span class="normal">    List0 </span><span class="symbol">%=</span><span class="normal">          </span><span class="symbol">+</span><span class="normal">ListItem0</span><span class="symbol">;</span>
<span class="normal">    List1 </span><span class="symbol">%=</span><span class="normal">          </span><span class="symbol">+</span><span class="normal">ListItem1</span><span class="symbol">;</span>
<span class="normal">    List2 </span><span class="symbol">%=</span><span class="normal">          </span><span class="symbol">+</span><span class="normal">ListItem2</span><span class="symbol">;</span>

<span class="normal">    ListItem0 </span><span class="symbol">%=</span><span class="normal">      omit</span><span class="symbol">[(</span><span class="normal">Bullet </span><span class="symbol">|</span><span class="normal"> Enumet</span><span class="symbol">)]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"li"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> ListBlock0</span><span class="symbol">;</span>
<span class="normal">    ListItem1 </span><span class="symbol">%=</span><span class="normal">      omit</span><span class="symbol">[</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Bullet </span><span class="symbol">|</span><span class="normal"> Enumet</span><span class="symbol">)]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"li"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> ListBlock1</span><span class="symbol">;</span>
<span class="normal">    ListItem2 </span><span class="symbol">%=</span><span class="normal">      omit</span><span class="symbol">[</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Bullet </span><span class="symbol">|</span><span class="normal"> Enumet</span><span class="symbol">)]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"li"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> ListBlock2</span><span class="symbol">;</span>

<span class="normal">    ListBlock0 </span><span class="symbol">%=</span><span class="normal">     </span><span class="symbol">!</span><span class="normal">BlankLine </span><span class="symbol">&gt;&gt;</span><span class="normal"> Line </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(</span><span class="normal"> BulletList1 </span><span class="symbol">|</span><span class="normal"> OrderedList1 </span><span class="symbol">|</span><span class="normal"> ListBlockLine0 </span><span class="symbol">);</span>
<span class="normal">    ListBlock1 </span><span class="symbol">%=</span><span class="normal">     </span><span class="symbol">!</span><span class="normal">BlankLine </span><span class="symbol">&gt;&gt;</span><span class="normal"> Line </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(</span><span class="normal"> BulletList2 </span><span class="symbol">|</span><span class="normal"> OrderedList2 </span><span class="symbol">|</span><span class="normal"> ListBlockLine1 </span><span class="symbol">);</span>
<span class="normal">    ListBlock2 </span><span class="symbol">%=</span><span class="normal">     </span><span class="symbol">!</span><span class="normal">BlankLine </span><span class="symbol">&gt;&gt;</span><span class="normal"> Line </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(</span><span class="normal"> ListBlockLine2 </span><span class="symbol">);</span>

<span class="normal">    ListBlockLine0 </span><span class="symbol">%=</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">BlankLine </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">!(</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Bullet </span><span class="symbol">|</span><span class="normal"> Enumet</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">)</span>
<span class="normal">                                 </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">" "</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Line</span><span class="symbol">;</span>

<span class="normal">    ListBlockLine1 </span><span class="symbol">%=</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">BlankLine </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">!(</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Bullet </span><span class="symbol">|</span><span class="normal"> Enumet</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">)</span>
<span class="normal">                                 </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">" "</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Line</span><span class="symbol">;</span>

<span class="normal">    ListBlockLine2 </span><span class="symbol">%=</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">BlankLine </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">!(</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Bullet </span><span class="symbol">|</span><span class="normal"> Enumet</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">)</span>
<span class="normal">                                 </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> Indent </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">" "</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Line</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// inline will gobble single eols, but stop at double eols.</span>
<span class="normal">    Line </span><span class="symbol">%=</span><span class="normal">           </span><span class="symbol">+</span><span class="normal">Inline </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[(</span><span class="normal">eol </span><span class="symbol">&gt;&gt;</span><span class="normal"> BlankLine</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> </span><span class="symbol">(*</span><span class="normal">eol </span><span class="symbol">&gt;&gt;</span><span class="normal"> eoi</span><span class="symbol">)];</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="normal">    </span><span class="comment">// *** Paragraph Blocks: Headers</span>

<span class="normal">    Header6 </span><span class="symbol">%=</span><span class="normal">        </span><span class="string">"###### "</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h6"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> InlineList</span><span class="symbol">;</span>
<span class="normal">    Header5 </span><span class="symbol">%=</span><span class="normal">        </span><span class="string">"##### "</span><span class="normal">  </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h5"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> InlineList</span><span class="symbol">;</span>
<span class="normal">    Header4 </span><span class="symbol">%=</span><span class="normal">        </span><span class="string">"#### "</span><span class="normal">   </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h4"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> InlineList</span><span class="symbol">;</span>
<span class="normal">    Header3 </span><span class="symbol">%=</span><span class="normal">        </span><span class="string">"### "</span><span class="normal">    </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h3"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> InlineList</span><span class="symbol">;</span>
<span class="normal">    Header2 </span><span class="symbol">%=</span><span class="normal">        </span><span class="string">"## "</span><span class="normal">     </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h2"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> InlineList</span><span class="symbol">;</span>
<span class="normal">    Header1 </span><span class="symbol">%=</span><span class="normal">        </span><span class="string">"# "</span><span class="normal">      </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h1"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> InlineList</span><span class="symbol">;</span>

<span class="normal">    HeaderAnchor </span><span class="symbol">=</span><span class="normal">    as_string</span><span class="symbol">[</span><span class="normal"> </span><span class="symbol">+~</span><span class="function">char_</span><span class="symbol">(</span><span class="string">')'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">]</span>
<span class="normal">        </span><span class="symbol">[</span><span class="normal"> _val </span><span class="symbol">=</span><span class="normal"> </span><span class="string">"&lt;a id=</span><span class="specialchar">\"</span><span class="string">"</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> _1 </span><span class="symbol">+</span><span class="normal"> </span><span class="string">"</span><span class="specialchar">\"</span><span class="string">&gt;&lt;/a&gt;"</span><span class="normal"> </span><span class="symbol">];</span>

<span class="normal">    HeaderA </span><span class="symbol">%=</span><span class="normal">        HeaderAnchor </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">lit</span><span class="symbol">(</span><span class="string">") "</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> InlineList</span><span class="symbol">;</span>

<span class="normal">    Header6A </span><span class="symbol">%=</span><span class="normal">       </span><span class="string">"######("</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h6"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HeaderA</span><span class="symbol">;</span>
<span class="normal">    Header5A </span><span class="symbol">%=</span><span class="normal">       </span><span class="string">"#####("</span><span class="normal">  </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h5"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HeaderA</span><span class="symbol">;</span>
<span class="normal">    Header4A </span><span class="symbol">%=</span><span class="normal">       </span><span class="string">"####("</span><span class="normal">   </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h4"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HeaderA</span><span class="symbol">;</span>
<span class="normal">    Header3A </span><span class="symbol">%=</span><span class="normal">       </span><span class="string">"###("</span><span class="normal">    </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h3"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HeaderA</span><span class="symbol">;</span>
<span class="normal">    Header2A </span><span class="symbol">%=</span><span class="normal">       </span><span class="string">"##("</span><span class="normal">     </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h2"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HeaderA</span><span class="symbol">;</span>
<span class="normal">    Header1A </span><span class="symbol">%=</span><span class="normal">       </span><span class="string">"#("</span><span class="normal">      </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"h1"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> HeaderA</span><span class="symbol">;</span>

<span class="normal">    Header </span><span class="symbol">%=</span><span class="normal">         </span><span class="symbol">&amp;</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'#'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span><span class="normal"> Header6A </span><span class="symbol">|</span><span class="normal"> Header5A </span><span class="symbol">|</span><span class="normal"> Header4A </span><span class="symbol">|</span><span class="normal"> Header3A </span><span class="symbol">|</span><span class="normal"> Header2A </span><span class="symbol">|</span><span class="normal"> Header1A </span><span class="symbol">|</span>
<span class="normal">                                     Header6 </span><span class="symbol">|</span><span class="normal"> Header5 </span><span class="symbol">|</span><span class="normal"> Header4 </span><span class="symbol">|</span><span class="normal"> Header3 </span><span class="symbol">|</span><span class="normal"> Header2 </span><span class="symbol">|</span><span class="normal"> Header1 </span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="normal">    </span><span class="comment">// *** Source Highlighting Code Blocks</span>

<span class="normal">    HighlightBlock </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">"```"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">blank</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">print </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[</span><span class="normal">eol</span><span class="symbol">]</span>
<span class="normal">                            </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!(</span><span class="normal">eol </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"```"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> char_</span><span class="symbol">)</span>
<span class="normal">                            </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[</span><span class="normal">eol</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"```"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[*</span><span class="normal">blank </span><span class="symbol">&gt;&gt;</span><span class="normal"> eol</span><span class="symbol">];</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="normal">    </span><span class="comment">// *** Paragraph Blocks: Paragraphs and Plain</span>

<span class="normal">    Paragraph </span><span class="symbol">%=</span><span class="normal">    </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"p"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> ParagraphBlock </span><span class="symbol">&gt;&gt;</span><span class="normal"> omit</span><span class="symbol">[+(</span><span class="normal">eol </span><span class="symbol">|</span><span class="normal"> blank </span><span class="symbol">&gt;&gt;</span><span class="normal"> eoi</span><span class="symbol">)];</span>
<span class="normal">    ParagraphBlock </span><span class="symbol">%=</span><span class="normal"> InlineList</span><span class="symbol">;</span>

<span class="normal">    InlineList </span><span class="symbol">%=</span><span class="normal">   </span><span class="symbol">+</span><span class="normal">Inline</span><span class="symbol">;</span>

<span class="normal">    Block </span><span class="symbol">%=</span><span class="normal">        omit</span><span class="symbol">[*</span><span class="normal">BlankLine</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">(</span>
<span class="normal">        CommentBlock </span><span class="symbol">|</span>
<span class="normal">        VerbatimBlock </span><span class="symbol">|</span><span class="normal"> FilterBlock </span><span class="symbol">|</span><span class="normal"> FuncBlock </span><span class="symbol">|</span>
<span class="normal">        HighlightBlock </span><span class="symbol">|</span>
<span class="normal">        Header </span><span class="symbol">|</span>
<span class="normal">        BulletList0 </span><span class="symbol">|</span><span class="normal"> OrderedList0 </span><span class="symbol">|</span>
<span class="normal">        HtmlPhrase </span><span class="symbol">|</span>
<span class="normal">        Paragraph </span><span class="symbol">|</span><span class="normal"> InlineList </span><span class="symbol">);</span>

<span class="normal">    BlockList </span><span class="symbol">%=</span><span class="normal">    </span><span class="symbol">*</span><span class="normal">Block</span><span class="symbol">;</span>

<span class="normal">    Start </span><span class="symbol">%=</span><span class="normal">        BlockList</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="normal">    </span><span class="comment">// *** Inline Procedural Language</span>

<span class="normal">    FIdentifier </span><span class="symbol">%=</span><span class="normal">  </span><span class="function">char_</span><span class="symbol">(</span><span class="string">"A-Za-z_"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*</span><span class="function">char_</span><span class="symbol">(</span><span class="string">"A-Za-z0-9_"</span><span class="symbol">);</span>

<span class="normal">    FVariable </span><span class="symbol">%=</span><span class="normal">    FIdentifier</span><span class="symbol">;</span>

<span class="normal">    FString </span><span class="symbol">%=</span><span class="normal">      </span><span class="string">'"'</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">*(!</span><span class="function">lit</span><span class="symbol">(</span><span class="string">'"'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">((</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"</span><span class="specialchar">\\\"</span><span class="string">"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">'"'</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">|</span><span class="normal"> char_</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'"'</span><span class="symbol">;</span>

<span class="normal">    FDouble </span><span class="symbol">%=</span><span class="normal">      qi</span><span class="symbol">::</span><span class="normal">real_parser</span><span class="symbol">&lt;</span><span class="normal"> </span><span class="type">double</span><span class="symbol">,</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">strict_real_policies</span><span class="symbol">&lt;</span><span class="type">double</span><span class="symbol">&gt;</span><span class="normal"> </span><span class="symbol">&gt;();</span>

<span class="normal">    FInteger </span><span class="symbol">%=</span><span class="normal">     qi</span><span class="symbol">::</span><span class="normal">long_long</span><span class="symbol">;</span>

<span class="normal">    FCall </span><span class="symbol">%=</span><span class="normal">        FIdentifier </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'('</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">-(</span><span class="normal">FExpr </span><span class="symbol">%</span><span class="normal"> </span><span class="string">','</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">')'</span><span class="symbol">;</span>

<span class="normal">    FBracket </span><span class="symbol">%=</span><span class="normal">     </span><span class="string">'('</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FExpr </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">')'</span><span class="symbol">;</span>

<span class="normal">    FAtomic </span><span class="symbol">%=</span><span class="normal">      FBracket </span><span class="symbol">|</span><span class="normal"> FCall </span><span class="symbol">|</span><span class="normal"> FString </span><span class="symbol">|</span><span class="normal"> FDouble </span><span class="symbol">|</span><span class="normal"> FInteger </span><span class="symbol">|</span><span class="normal"> FVariable</span><span class="symbol">;</span>

<span class="normal">    FExpr </span><span class="symbol">%=</span><span class="normal">        FAtomic </span><span class="symbol">%</span><span class="normal"> as_string</span><span class="symbol">[</span><span class="function">char_</span><span class="symbol">(</span><span class="string">"+"</span><span class="symbol">)]</span><span class="normal"> </span><span class="symbol">[</span><span class="normal"> phx</span><span class="symbol">::</span><span class="function">push_back</span><span class="symbol">(</span><span class="normal">_val</span><span class="symbol">,</span><span class="normal">_1</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">];</span>

<span class="normal">    FSetClause </span><span class="symbol">%=</span><span class="normal">   </span><span class="symbol">-</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"SET"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FIdentifier </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'='</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FExpr</span><span class="symbol">;</span>

<span class="normal">    FIfClause </span><span class="symbol">%=</span><span class="normal">    </span><span class="string">"IF"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FExpr </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Start </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span>
<span class="normal">                         </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">-(</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"ELSE"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Start </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span><span class="symbol">)</span>
<span class="normal">                         </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"ENDIF"</span><span class="symbol">;</span>

<span class="normal">    FEvalIfClause </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">"EVALIF"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FExpr </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FClause </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span>
<span class="normal">                              </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="symbol">-(</span><span class="function">lit</span><span class="symbol">(</span><span class="string">"ELSE"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FClause </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span><span class="symbol">)</span>
<span class="normal">                              </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"ENDIF"</span><span class="symbol">;</span>

<span class="normal">    FForClause </span><span class="symbol">%=</span><span class="normal">   </span><span class="string">"FOR"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FIdentifier </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">'='</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FExpr </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> Start </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"%%"</span>
<span class="normal">                          </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="string">"ENDFOR"</span><span class="symbol">;</span>

<span class="normal">    FInclude </span><span class="symbol">%=</span><span class="normal">     </span><span class="string">"INCLUDE"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> </span><span class="function">attr</span><span class="symbol">(</span><span class="string">"include"</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FIdentifier</span><span class="symbol">;</span>

<span class="normal">    FClause </span><span class="symbol">%=</span><span class="normal">      FSetClause </span><span class="symbol">|</span><span class="normal"> FEvalIfClause </span><span class="symbol">|</span><span class="normal"> FIfClause </span><span class="symbol">|</span><span class="normal"> FForClause </span><span class="symbol">|</span><span class="normal"> FInclude </span><span class="symbol">|</span><span class="normal"> FExpr</span><span class="symbol">;</span>

<span class="normal">    FFilterSetClause </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">"SET"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FIdentifier</span><span class="symbol">;</span>

<span class="normal">    FFilterTemplateClause </span><span class="symbol">%=</span><span class="normal"> </span><span class="string">"TEMPLATE"</span><span class="normal"> </span><span class="symbol">&gt;&gt;</span><span class="normal"> FIdentifier</span><span class="symbol">;</span>

<span class="normal">    FFilterClause </span><span class="symbol">%=</span><span class="normal"> FFilterSetClause </span><span class="symbol">|</span><span class="normal"> FFilterTemplateClause </span><span class="symbol">|</span><span class="normal"> FCall</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// ********************************************************************</span>
<span class="cbracket">}</span>

<span class="comment">/******************************************************************************/</span>
<span class="comment">// Interpret a boost::variant&lt;&gt; object by recursively visiting the nodes inside.</span>

<span class="keyword">struct</span><span class="normal"> </span><span class="classname">ast_debug</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> boost</span><span class="symbol">::</span><span class="normal">static_visitor</span><span class="symbol">&lt;&gt;</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="type">int</span><span class="normal"> depth</span><span class="symbol">;</span>

<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">ostringstream</span><span class="normal"> oss</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">ast_debug</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> ast_node</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> </span><span class="function">depth</span><span class="symbol">(</span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        boost</span><span class="symbol">::</span><span class="function">apply_visitor</span><span class="symbol">(*</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> ast</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">inline</span><span class="normal"> std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        </span><span class="keyword">return</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="number">2</span><span class="normal"> </span><span class="symbol">*</span><span class="normal"> depth</span><span class="symbol">,</span><span class="normal"> </span><span class="string">' '</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_null</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"NULL"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> text</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"text: </span><span class="specialchar">\"</span><span class="string">"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> text </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'"'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_comment</span><span class="symbol">&amp;</span><span class="normal"> text</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"comment: </span><span class="specialchar">\"</span><span class="string">"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> text </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'"'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="function">recurse</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> ast_node</span><span class="symbol">&amp;</span><span class="normal"> node</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        </span><span class="symbol">++</span><span class="normal">depth</span><span class="symbol">;</span>
<span class="normal">        boost</span><span class="symbol">::</span><span class="function">apply_visitor</span><span class="symbol">(*</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> node</span><span class="symbol">);</span>
<span class="normal">        </span><span class="symbol">--</span><span class="normal">depth</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="function">recurse_list</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> ast_nodelist</span><span class="symbol">&amp;</span><span class="normal"> nodelist</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'{'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>

<span class="normal">        </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> ast_node</span><span class="symbol">&amp;</span><span class="normal"> n </span><span class="symbol">:</span><span class="normal"> nodelist</span><span class="symbol">)</span>
<span class="normal">            </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">n</span><span class="symbol">);</span>

<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'}'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_nodelist</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        </span><span class="function">recurse_list</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_tagged_node</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'&lt;'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">tag </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'&gt;'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">subtree</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_html_node</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'&lt;'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">tag </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'&gt;'</span><span class="symbol">;</span>
<span class="normal">        </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">attrlist</span><span class="symbol">.</span><span class="function">size</span><span class="symbol">())</span>
<span class="normal">        </span><span class="cbracket">{</span>
<span class="normal">            </span><span class="symbol">++</span><span class="normal">depth</span><span class="symbol">;</span>
<span class="normal">            oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">" ["</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">            </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> ast_html_attr</span><span class="symbol">&amp;</span><span class="normal"> attr </span><span class="symbol">:</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">attrlist</span><span class="symbol">)</span>
<span class="normal">            </span><span class="cbracket">{</span>
<span class="normal">                oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> attr</span><span class="symbol">.</span><span class="normal">name </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'='</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">                </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">attr</span><span class="symbol">.</span><span class="normal">value</span><span class="symbol">);</span>
<span class="normal">            </span><span class="cbracket">}</span>
<span class="normal">            oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">']'</span><span class="symbol">;</span>
<span class="normal">            </span><span class="symbol">--</span><span class="normal">depth</span><span class="symbol">;</span>
<span class="normal">        </span><span class="cbracket">}</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>

<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">subtree</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_html_selfnode</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'&lt;'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">tag </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'&gt;'</span><span class="symbol">;</span>
<span class="normal">        </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">attrlist</span><span class="symbol">.</span><span class="function">size</span><span class="symbol">())</span>
<span class="normal">        </span><span class="cbracket">{</span>
<span class="normal">            </span><span class="symbol">++</span><span class="normal">depth</span><span class="symbol">;</span>
<span class="normal">            oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">" ["</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">            </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> ast_html_attr</span><span class="symbol">&amp;</span><span class="normal"> attr </span><span class="symbol">:</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">attrlist</span><span class="symbol">)</span>
<span class="normal">            </span><span class="cbracket">{</span>
<span class="normal">                oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> attr</span><span class="symbol">.</span><span class="normal">name </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'='</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">                </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">attr</span><span class="symbol">.</span><span class="normal">value</span><span class="symbol">);</span>
<span class="normal">            </span><span class="cbracket">}</span>
<span class="normal">            oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">']'</span><span class="symbol">;</span>
<span class="normal">            </span><span class="symbol">--</span><span class="normal">depth</span><span class="symbol">;</span>
<span class="normal">        </span><span class="cbracket">}</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_variable</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"var: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_string</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"string: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_integer</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"integer: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">value </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_double</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"double: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">value </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_template</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"template: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_call</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"call: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">funcname </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">" {"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse_list</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">args</span><span class="symbol">);</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'}'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_filter</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"filter: ["</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">node</span><span class="symbol">);</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"] on </span><span class="specialchar">\"</span><span class="string">"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">content </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"</span><span class="specialchar">\"</span><span class="string">"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_expr</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"expr: {"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse_list</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">);</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">'}'</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_set</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"set: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">varname </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"value: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">value</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_if</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"if: ["</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">condition</span><span class="symbol">);</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"]"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"true: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">iftrue</span><span class="symbol">);</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"else: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">iffalse</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_func_for</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"for: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">varname </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"["</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">arg</span><span class="symbol">);</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"]"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"subtree: "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        </span><span class="function">recurse</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">.</span><span class="normal">subtree</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="type">void</span><span class="normal"> </span><span class="keyword">operator</span><span class="symbol">()(</span><span class="keyword">const</span><span class="normal"> ast_highlight</span><span class="symbol">&amp;</span><span class="normal"> ast</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        oss </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"highlight["</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">language </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"]"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span>
<span class="normal">            </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="function">tab</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"</span><span class="specialchar">\"</span><span class="string">"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> ast</span><span class="symbol">.</span><span class="normal">content </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"</span><span class="specialchar">\"</span><span class="string">"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span><span class="symbol">;</span>

<span class="comment">/******************************************************************************/</span>

<span class="usertype">ast_node</span><span class="normal"> </span><span class="function">parse_markup</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> input</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> name</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">::</span><span class="normal">const_iterator</span>
<span class="normal">        begin </span><span class="symbol">=</span><span class="normal"> input</span><span class="symbol">.</span><span class="function">begin</span><span class="symbol">(),</span><span class="normal"> end </span><span class="symbol">=</span><span class="normal"> input</span><span class="symbol">.</span><span class="function">end</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">static</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> </span><span class="usertype">MyMarkupParser</span><span class="normal"> p</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">ast_node</span><span class="normal"> ast</span><span class="symbol">;</span>
<span class="normal">    </span><span class="type">bool</span><span class="normal"> r </span><span class="symbol">=</span><span class="normal"> </span><span class="function">phrase_parse</span><span class="symbol">(</span><span class="normal">begin</span><span class="symbol">,</span><span class="normal"> end</span><span class="symbol">,</span><span class="normal"> p</span><span class="symbol">,</span><span class="normal"> qi</span><span class="symbol">::</span><span class="normal">space</span><span class="symbol">,</span><span class="normal"> ast</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">r </span><span class="symbol">&amp;&amp;</span><span class="normal"> begin </span><span class="symbol">==</span><span class="normal"> end</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="number">80</span><span class="symbol">,</span><span class="normal"> </span><span class="string">'-'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"Parsing "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> name </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">" succeeded."</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="number">80</span><span class="symbol">,</span><span class="normal"> </span><span class="string">'-'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>

<span class="normal">        </span><span class="usertype">ast_debug</span><span class="normal"> </span><span class="function">prn</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">);</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> prn</span><span class="symbol">.</span><span class="normal">oss</span><span class="symbol">.</span><span class="function">str</span><span class="symbol">();</span>

<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="number">80</span><span class="symbol">,</span><span class="normal"> </span><span class="string">'-'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="number">80</span><span class="symbol">,</span><span class="normal"> </span><span class="string">'-'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"Parsing "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> name </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">" failed, stopped at"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="number">80</span><span class="symbol">,</span><span class="normal"> </span><span class="string">'-'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>

<span class="normal">        </span><span class="usertype">ast_debug</span><span class="normal"> </span><span class="function">prn</span><span class="symbol">(</span><span class="normal">ast</span><span class="symbol">);</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> prn</span><span class="symbol">.</span><span class="normal">oss</span><span class="symbol">.</span><span class="function">str</span><span class="symbol">();</span>

<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="number">80</span><span class="symbol">,</span><span class="normal"> </span><span class="string">'-'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"Remaining input"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>

<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="normal">begin</span><span class="symbol">,</span><span class="normal">end</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>

<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">(</span><span class="number">80</span><span class="symbol">,</span><span class="normal"> </span><span class="string">'-'</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"!!! "</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> name </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">" parsing FAILED!"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> ast</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="comment">/******************************************************************************/</span>

<span class="type">int</span><span class="normal"> </span><span class="function">main</span><span class="symbol">(</span><span class="type">int</span><span class="normal"> argc</span><span class="symbol">,</span><span class="normal"> </span><span class="type">char</span><span class="symbol">*</span><span class="normal"> argv</span><span class="symbol">[])</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">argc </span><span class="symbol">&gt;=</span><span class="normal"> </span><span class="number">2</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="usertype">ifstream</span><span class="normal"> </span><span class="function">in</span><span class="symbol">(</span><span class="normal">argv</span><span class="symbol">[</span><span class="number">1</span><span class="symbol">]);</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal"> </span><span class="function">input</span><span class="symbol">((</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">istreambuf_iterator</span><span class="symbol">&lt;</span><span class="type">char</span><span class="symbol">&gt;(</span><span class="normal">in</span><span class="symbol">)),</span>
<span class="normal">                          std</span><span class="symbol">::</span><span class="normal">istreambuf_iterator</span><span class="symbol">&lt;</span><span class="type">char</span><span class="symbol">&gt;());</span>
<span class="normal">        </span><span class="function">parse_markup</span><span class="symbol">(</span><span class="normal">input</span><span class="symbol">,</span><span class="normal"> argv</span><span class="symbol">[</span><span class="number">1</span><span class="symbol">]);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="normal">cout </span><span class="symbol">&lt;&lt;</span><span class="normal"> </span><span class="string">"Reading stdin"</span><span class="normal"> </span><span class="symbol">&lt;&lt;</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">endl</span><span class="symbol">;</span>
<span class="normal">        std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal"> </span><span class="function">input</span><span class="symbol">((</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">istreambuf_iterator</span><span class="symbol">&lt;</span><span class="type">char</span><span class="symbol">&gt;(</span><span class="normal">std</span><span class="symbol">::</span><span class="normal">cin</span><span class="symbol">)),</span>
<span class="normal">                          std</span><span class="symbol">::</span><span class="normal">istreambuf_iterator</span><span class="symbol">&lt;</span><span class="type">char</span><span class="symbol">&gt;());</span>
<span class="normal">        </span><span class="function">parse_markup</span><span class="symbol">(</span><span class="normal">input</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"stdin"</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="comment">/******************************************************************************/</span>
</tt></pre></div><div style="text-align: right; padding: 8pt; font-size: 13px"><a href="/xmlfeed/weblog-rss20.xml"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPAgMAAAAOp6AcAAAADFBMVEVmZmb/ZgD///+JjnlbTUWmAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABQAAAADwCexKkxAAAAWUlEQVQYlWNgwAa0VmGAFQyqoSCQ/x8J/CBFMCt0ZdTU/F/7/+1HEkydFpoKVPn+93sUlUujQvP/7UcRTAuNDJ2a//s/imDqtKVZofm/1qGYSZk7sfodGwAAiobBJtffoNAAAAAASUVORK5CYII=" alt="RSS 2.0 Weblog Feed" width="80" height="15"/></a> <a href="/xmlfeed/weblog-atom10.xml"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPAgMAAAAOp6AcAAAADFBMVEVmZmb/ZgD///+JjnlbTUWmAAAAaklEQVQYlWNgwAa0VmGAFQyqoSCQ/x8J/CBFMDV16rTQ/H/7V//69+//v/3/9oMEI6cuAwr+fv/+/b5d///v//0eJBgWOhMo+Gs9UPAdXDBy6lSYyn9wQZCZS0GCYDPXQcykzJ1Y/Y4NAABKvL80wyoMPgAAAABJRU5ErkJggg==" alt="Atom 1.0 Weblog Feed" width="80" height="15"/></a> <a href="http://validator.w3.org/check?uri=referer"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAB1FBMVEUHQIgIRY0MN4QNRYoSRYsXUpIYVJQeUpUhWpgjUJMjWpgmU5QnXJkuYZ0uYpwwV5YyZJ4zaKM3ZaA5aaI6aqM6a6E8ZqA8Z6BAbaRBbqdCbaVHd61KSkpKcaZQUFBUf69UgbBVVVVXfq9Yg7NZhbJZh7RagrNeXVxeh7RfjLdgYGBiiLZmZmZnZ2doirhpkbt0m8F3m8B3ncJ5lb55ocR+ocSDgX+Do8eEpMqGhoaHp8iIpMeJjnmJpseKqMeOqsqPsdCQrcyVlZWVsM2Zs9CZtNCfu9ahoaGhuNShudSivNSjtMWjvNSmpqWnpqSrw9qvxNqyxdmyxdyzsK6zs7Ozx9y0xt21yN22tra4y+K80eK/v7/AwMDExMTEy9DH2ejK2+jM2ujN3uvP0dLR0NDR3uvS3uvS3+zU4u3V1dXY2dnY4u7Y4+3b5e/d3d3d5u/d5/De3t7f39/h4uLj4uHj6/Ll7PXm7fTn7/Xo7/Tp7/bq7Ozr6unr8ffw8PDw9vvx9fny+P7z8/Pz9vnz9vv3+fv4+vz5+vz6+vr6+/36/P36///7+/77/Pz7/f37/f78/Pz8/f38/f79/f39/f79/f/9/v79///+/v7+/v////3///+tYR2LAAABKklEQVQ4y2PQoTJg0JlNVYDPQBsyAMTAqaFes8tdsmdPCtA3MDStr3GKKK6myMAprgJ9pcpWs/MlRExYJBvNZLR0sigycHYOV1S7mtjsQJ4gf+HIFPXoWMs6qIGzIRiKZs9GFoEaMRuZhhrYqqJXy8uZYauRxC/VHew7e3YTPAxnI5swG6JxNrKBNjB1EFmIgV0+HA6C8pqqzhXG7BbJJROQIwViMYQ7G2oDQQNn57JyG7kxiCfObrBmS5+BHMuYLkTzMnYDm5WY4lOZZRPKZocxes+aPbuwCFsYohiICLvZsKBAMrDTQ7K/StveU8icTzrOL8JdLpOyWJ49u8Bx9ozw8DY7UYW03hhdxZAOSg2c3jN79rSJs1vSKmfOnpFXNJmynELlvExlAADnaZpLFGEC2wAAAABJRU5ErkJggg==" alt="Valid XHTML 1.1" width="80" height="15"/></a> <a href="http://jigsaw.w3.org/css-validator/check/referer"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAB1FBMVEUHQIgIRY0MN4QNRYoSRYsXUpIYVJQeUpUhWpgjUJMjWpgmU5QnXJkuYZ0uYpwwV5YyZJ4zaKM3ZaA5aaI6aqM6a6E8ZqA8Z6BAbaRBbqdCbaVHd61KSkpKcaZQUFBUf69UgbBVVVVXfq9Yg7NZhbJZh7RagrNeXVxeh7RfjLdgYGBiiLZmZmZnZ2doirhpkbt0m8F3m8B3ncJ5lb55ocR+ocSDgX+Do8eEpMqGhoaHp8iIpMeJjnmJpseKqMeOqsqPsdCQrcyVlZWVsM2Zs9CZtNCfu9ahoaGhuNShudSivNSjtMWjvNSmpqWnpqSrw9qvxNqyxdmyxdyzsK6zs7Ozx9y0xt21yN22tra4y+K80eK/v7/AwMDExMTEy9DH2ejK2+jM2ujN3uvP0dLR0NDR3uvS3uvS3+zU4u3V1dXY2dnY4u7Y4+3b5e/d3d3d5u/d5/De3t7f39/h4uLj4uHj6/Ll7PXm7fTn7/Xo7/Tp7/bq7Ozr6unr8ffw8PDw9vvx9fny+P7z8/Pz9vnz9vv3+fv4+vz5+vz6+vr6+/36/P36///7+/77/Pz7/f37/f78/Pz8/f38/f79/f39/f79/f/9/v79///+/v7+/v////3///+tYR2LAAABEUlEQVQ4y2PQoTJg0JlNVYDPQBsyAMTAqaFes8tdsmdPCtA3MDStr3GKKK6myMAprgJ9pcpWs/MlRExYJBvNZLR0sigycHYOV1S7mtjsQJ4gf+HIFPXoWMs6mIEQCsIjwhKoga0qerW8nBm2Gkn8Ut3BvrNnN8HCcDYM2cBIogzs8uFwEJTXVHWuMGa3SC6ZgIgUqCEwdxJr4OxcVm4jNwbxxNkN1mzpM2ajGIjsPGK9PLtZiSk+lVk2oWx2GKP3rNmzC4tQwpDoIIQb2Okh2V+lbe8pZM4nHecX4S6XSVksz55d4Dh7Rnh4m52oQlpvjK5iSAelBk7vmT172sTZLWmVM2fPyCuaTFlOoXJepjIAANlljDGY/l5pAAAAAElFTkSuQmCC" alt="Valid CSS (2.1)" width="80" height="15"/></a><br/>Copyright 2005-2019 <a href="/about/">Timo Bingmann</a> - <a href="/about/impressum.html">Impressum</a></div></body></html>