<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=iso-8859-1" http-equiv="content-type" /><meta name="viewport" content="initial-scale=1"><title>BlinkenSort with Sound - The Sound of LED Sorting Algorithms with Raspberry Pi 3 and APA102 or SK9822 LEDs - panthema.net</title><link rel="stylesheet" type="text/css" href="/css/base.css" /><link rel="stylesheet" type="text/css" href="/css/fonts.css" /><link rel="alternate" type="application/rss+xml" title="panthema.net Weblog Feed RSS 2.0" href="https://panthema.net/xmlfeed/weblog-rss20.xml" /><link rel="alternate" type="application/atom+xml" title="panthema.net Weblog Feed Atom 1.0" href="https://panthema.net/xmlfeed/weblog-atom10.xml" /><script type="text/javascript" src="/js/base.js"></script><script type="text/javascript">/* <!-- */makeIEHover = function() {var lis = document.getElementById('ptnav').getElementsByTagName('li');for (var i = 0; i < lis.length; i++) {lis[i].onmouseover = function() {this.className += ' sfhover';};lis[i].onmouseout = function() {this.className = this.className.replace(new RegExp(' sfhover\b'), '');};}};if (window.attachEvent) window.attachEvent('onload', makeIEHover);/* --> */</script></head><body lang="en"><div class="pttopbar"><div style="float: right"><ul id="ptnav"><li class="top"><a class="ni" href="/timeline/"><i class="icon-book"></i> Weblog</a><ul style="margin-left: -6px; margin-top: 4px" class="nx"><li><a href="/2020/">2020</a></li><li><a href="/2019/">2019</a></li><li><a href="/2018/">2018</a></li><li><a href="/2017/">2017</a></li><li><a href="/2016/">2016</a></li><li><a href="/2015/">2015</a></li><li><a href="/2014/">2014</a></li><li><a href="/2013/">2013</a></li><li><a href="/2012/">2012</a></li><li><a href="/2011/">2011</a></li><li><a href="/2010/">2010</a></li><li><a href="/2009/">2009</a></li><li><a href="/2008/">2008</a></li><li><a href="/2007/">2007</a></li><li><a href="/2006/">2006</a></li><li class="nt"><a href="/2005/">2005</a></li><li class="ns"><a href="/xmlfeed/weblog-rss20.xml">RSS Feed</a></li><li class="nt"><a href="/xmlfeed/weblog-atom10.xml">XML Atom</a></li></ul></li><li class="top"> <a class="ni" href="/tags/"><i class="icon-tags"></i> Tags</a></li><li class="top"> <a class="ni" href="#"><i class="icon-cubes"></i> Projects</a> <ul style="margin-left: -8em; margin-top: 4px;" class="nx"> <li><a href="/2019/1008-COBS-A-Compact-Bit-Sliced-Signature-Index/">COBS</a></li> <li><a href="/2009/cryptote/">CryptoTE</a></li> <li><a href="/2009/digup/">digup</a></li> <li><a href="/2013/disk-filltest/">disk-filltest</a></li> <li><a href="/2012/1119-eSAIS-Inducing-Suffix-and-LCP-Arrays-in-External-Memory/">eSAIS-LCP</a></li> <li><a href="/2007/flex-bison-cpp-example/">Flex Bison C++ Example</a></li> <li><a href="/2013/malloc_count/">malloc_count</a></li> <li><a href="/2016/0114-diploma-thesis/">On Bispanning Graphs</a></li> <li><a href="/2013/pmbw/">Parallel Memory Bandwidth</a></li> <li><a href="/2013/parallel-string-sorting/">Parallel String Sorting</a></li> <li><a href="/2014/sqlplot-tools/">SqlPlotTools</a></li> <li><a href="/2013/sound-of-sorting/">The Sound of Sorting</a></li> <li><a href="/2007/stx-btree/">STX B+ Tree</a></li> <li><a href="/2010/stx-cbtreedb/">STX Constant BTreeDB</a></li> <li><a href="/2010/stx-execpipe/">STX ExecPipe</a></li> <li><a href="/2007/stx-exparser/">STX Expression Parser</a></li> <li><a href="/tags/stxxl.html">STXXL 1.4</a></li> <li><a href="/tags/thrill.html">Thrill - Big Data Framework</a></li> <li class="nt"><a href="/2014/vncrec-rgb/">VNCrec RGB 0.4</a></li> </ul></li><li class="top"> <a class="ni" href="/publications.html"><i class="icon-graduation-cap"></i> Publications</a></li><li class="top"> <a class="ni" href="/search.html"><i class="icon-search"></i> Search</a></li><li class="top"> <a class="ni" href="/subscribe.html"><i class="icon-rss-squared"></i> Subscribe</a></li><li class="top"> <a class="ni" href="/about/"><i class="icon-info-circled"></i> About</a></li></ul></div><div style="padding: 6px"><a href="/">panthema</a>  / <a href="/2019/">2019</a> / <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/">0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822</a></div></div><div class="ptcontent"><article><header><div style="float: right; clear: right; margin: 12pt 0pt 12pt 12pt; font-size: smaller; text-align: center" class="aimg"><a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/thumb-big.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/thumb.jpg" width="375" height="250" alt="BlinkenSort with Sound on Raspberry Pi 3 with APA102 or SK9822 LEDs" title="BlinkenSort with Sound on Raspberry Pi 3 with APA102 or SK9822 LEDs" /></a></div><h1>BlinkenSort with Sound - The Sound of LED Sorting Algorithms with Raspberry Pi 3 and APA102 or SK9822 LEDs</h1><p class="info">Posted on 2019-08-02 19:00 by <a href="/about/">Timo Bingmann</a><a href="http://plus.google.com/+TimoBingmann?rel=author"></a> at <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/">Permlink</a> with <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/#notes">0 Comments</a>. Tags: <a href="/tags/sorting.html">#sorting</a> <a href="/tags/electronics.html">#electronics</a> <a href="/tags/LEDs.html">#LEDs</a> <a href="/tags/sound_of_sorting.html">#sound of sorting</a> <a href="/tags/frontpage.html">#frontpage</a> <a href="/tags/blinken-algorithms.html">#blinken-algorithms</a></p></header><div class="textcontent"><p>Once <b>BlinkenSort</b> successfully showed fascinatingly complex <a href="/2019/0801-BlinkenSort-Sorting-Algorithms-on-LEDs-with-ESP8266-and-SK6812-or-WS2812B/">sorting algorithms on an LED strip using an ESP8266 (see other article)</a>, I naturally ventured to <b>add the sound output</b> from the <a href="/2013/sound-of-sorting/"><b>Sound of Sorting</b></a> program. This turned out much harder than initially thought, because the sound generation software required more processing power than available in the cheap standard microcontrollers. After much trail and error, I found out that a sufficiently new <b>Raspberry Pi</b> (I happened to have a Pi 3 model B) has the rare combination of <b>enough compute power</b>, can <b>drive an LED strip</b> directly via SPI, and has an <b>audio line-out</b>.</p><p>The Raspberry Pi, however, cannot drive the same type of LED strip reliably as the ESP8266 can, because the Raspberry Pi runs a time-shared Linux system instead of a real-time program. But it can drive the more expensive APA102 or SK9822 LEDs which have a separate clock line. These are 4-pin LED strips with clock and data, which can easily be attached to the Pi&apos;s SPI output pins. Furthermore, the <b>APA102 LEDs</b> can be driven at a <b>much higher refresh rate</b> than the WS2812B and SK6812, due to the extra clock signal. This ultimately makes the sorting animations <b>even smoother</b> than with the ESP8266 (where the frame rate is already unnoticeable). I could not find any off-the-shelf library to drive the APA102 with a C++ program on the Pi, but it was trivial to write a frame buffer class and access the <code>/dev/spi0.0</code> devices directly.</p><p>Then there was the question of adding a display. And after more experimentation, I found the <b>MAX7219 dot LED matrix modules</b> work well. These can also be driven by SPI from the Pi, which actually has two SPI outputs on the models with 40 pins. And as a bonus these dot LED matrix models can pull off an amazing frame rate. That means that besides showing the algorithm name, the super-fast refresh rate enables displaying of (nearly) <b>every comparison counter increment</b>, despite the human viewer only being able to see around 25 changes per second. Simply adding a HDMI display to the Pi would have also worked, but the LED matrix is cooler and has a retro feeling to it.</p><p>As you can see in the following YouTube video, each algorithm does something quite different which makes this a <b>very interesting art installation with deep connections to informatics</b>. BlinkenSort currently contains the following <b>eighteen sorting algorithms</b> (listed in the same order as in the video): MergeSort, Insertion Sort, QuickSort (LR) Hoare, QuickSort (LL) Lomoto, QuickSort Dual Pivot, ShellSort, HeapSort, CycleSort, RadixSort-MSD (High First), RadixSort-LSD (Low First), <code>std::sort</code>, <code>std::stable_sort</code>, WikiSort, TimSort, Selection Sort, Bubble Sort, Cocktail-Shaker Sort, and BozoSort. Besides sorting algorithms the collection also contains <b>four hash table implementations</b>: Linear Probing Hash Table, Quadratic Probing Hash Table, Cuckoo-Hashing with two places, and Cuckoo-Hashing with three places.</p><div class="center" style="text-align:center"><iframe width="640" height="360" src="https://www.youtube.com/embed/kAjQ8shElP8" frameborder="0" allowfullscreen="yes" id="yt_kAjQ8shElP8"></iframe></div><p>The video above (<a href="https://youtu.be/kAjQ8shElP8">https://youtu.be/kAjQ8shElP8</a>) shows the LED strip with sound in action and I added a voice-over commentary about the algorithms. There is also a <a href="https://www.youtube.com/watch?v=fkUZCRgX8yk">second YouTube video available</a>, without my commentary.</p><p>All source code for the sorting algorithms and other Neopixel animations is available from Github:<br /><a href="https://github.com/bingmann/BlinkenAlgorithms.git">https://github.com/bingmann/BlinkenAlgorithms.git</a></p><h1>Construction Manual for BlinkenSort with Sound on Raspberry Pi 3 with APA102 or SK9822 LEDs</h1><p>The project is made out of the following parts:</p><ul> <li> <p>APA102 or SK9822 LED strip (below: APA102, 5 meters, 96 LEDs/m, IP65, black PCB).</p> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex"> <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/apa102-96-led-strip-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/apa102-96-led-strip.jpg" height="250" class="zoom" /></a> </div> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex; max-width:60ex"> <p>Price: ~39 Euro.</p>  <p>My preferred type: <a href="http://s.click.aliexpress.com/e/ctOaAlc4" target="_blank">Aliexpress/BTF-Lightning</a></p> <p>The strip in the picture has 96 LEDs/m, I would recommend less: 60 LEDs/m as these are cheaper. The 96 LEDs/m pitch however has smaller, nearly square &quot;pixels&quot;.</p> <p>WS8212B, SK6812 will NOT WORK properly with a Raspberry Pi. The SK9822/APA102 have 4-pins with a separate clock line.</p> <p>The strips come with a 4-pin plug for attaching it to the Raspberry Pi.</p> </div> </li> <li> <p>Raspberry Pi 3 Model B+ with SD Card.</p> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex"> <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/raspberry-pi-3-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/raspberry-pi-3.jpg" height="250" class="zoom" /></a> </div> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex; max-width:60ex"> <p>Price: ~40 Euro.</p> <p>I happened to have Raspberry Pi 3 model B+ with 32 GB MicroSD card. Other models and clones, older or newer, with 40 pin header may work too. However, I think at least a quad-core ARM SoC is required for sound generation.</p> <p>Raspberry Pis can be bought from the major local hardware dealers or <a href="https://www.aliexpress.com/item/32615114907.html" target="_blank">Aliexpress/JunRoc</a>.</p>  <p>My Raspberry Pi in the picture received a 14x14x10mm heat sink (<a href="http://s.click.aliexpress.com/e/ciTi5hTK" target="_blank">Aliexpress/En-Labs</a>, 2.50 Euro for 10 pieces) after growing hot.</p> </div> </li> <li> <p>Hookup Material: a 2x20 female socket 2.54 mm pitch pin header, (optionally) a small piece of prototyping PCB, some wires.</p> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex"> <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/hookup-material-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/hookup-material.jpg" height="250" class="zoom" /></a> </div> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex; max-width:60ex"> <p>Price: &lt; 5 Euro.</p> <p>My preferred type: 2x20 pin header <a href="https://www.aliexpress.com/item/32897619298.html" target="_blank">Aliexpress/A+A Technology</a> (10 pieces), and some scrap prototyping PCB.</p> </div> </li> <li> <p>Any 5 volt 3 ampere power supply and a matching (female) power plug.</p> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex"> <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/power-supply-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/power-supply.jpg" height="250" class="zoom" /></a> </div> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex; max-width:60ex"> <p>Price: ~8 Euro.</p> <p>I just reused an older adjustable power supply (set to 5V). I would stay away from USB switching power supplies due to the noise induced on the Pi&apos;s sound output.</p> <p>Examples: <a href="https://www.aliexpress.com/item/32959107934.html" target="_blank">5V/3A power supply</a> and <a href="https://www.aliexpress.com/item/32931237606.html" target="_blank">2.1mm/5.5mm screw plugs</a>.</p> </div> </li> <li> <p>Optionally: 16 &times; MAX7219 Dot LED Matrix Display, 8&times;8 pixel each.</p> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex"> <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/led-matrix-display-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/led-matrix-display.jpg" height="250" class="zoom" /></a> </div> <div style="display: inline-block; vertical-align: middle; padding: 0 1ex; max-width:60ex"> <p>Price: ~24 Euro.</p>  <p>My preferred type: 4 &times; <a href="http://s.click.aliexpress.com/e/c8lxTGAc" target="_blank">Aliexpress/GreatWallElectronics</a></p> <p>This is a pretty large display (26mm &times; 6.5mm), I constructed it by gluing together 2&times;2 boards, each board containing four pre-assembled MAX7219 modules.</p>   <p>For nicer hookup I also got a 5-pin ribbon cable (<a href="http://s.click.aliexpress.com/e/cWGWAOPe" target="_blank">Aliexpress/YJBCo</a>) and some 5-pin JST connectors like the LED strip has (<a href="http://s.click.aliexpress.com/e/ci7QUzX6" target="_blank">Aliexpress/YJBCo</a>).</p> </div> </li></ul><h2>Soldering the Pin Socket &quot;Hat&quot; for the Raspberry Pi</h2><p>To be able to attach and remove the LED project from the Raspberry Pi quickly and conveniently, I decided to make a custom <b>&quot;hat&quot; board</b> for the 2x20 pin header on the Pi. The only parts which need to be connected are the 4-pin LED strip cable to the first SPI interface of the Pi, and optionally the 5-pin LED matrix cable to the second SPI interface. Since the required pins are somewhat stretched apart on the 2x20 pin header, I cut a small prototype PCB to route the wires to the ribbon cables.</p><p>I recommend NOT to solder all pins of the 2x20 socket (as I did in the pictures), instead only use those pins you need and maybe a few additional ones for stability.</p><p>The LED strip has 4 wires: red for 5V power, green for SPI data, yellow for SPI clock, and black for GND.</p><p>Use copious amounts of hot glue to stabilize the socket header and to fixate the cable to the PCB, such that pulling on the cable will not break any connections.</p><p style="text-align: center"><a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/hookup-front-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/hookup-front.jpg" height="250" class="zoom" /></a>&nbsp; <a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/hookup-back-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/hookup-back.jpg" height="250" class="zoom" /></a></p><p>You can find the necessary pins below: red is 5V goes to 02 or 04, green is SPI data goes to pin 19, yellow is the SPI clock line and goes to pin 23, and black is ground and can be attached to any GND pin. More details on the <a href="https://pinout.xyz/pinout/spi" target="_blank">SPI pinout of the Raspberry Pi</a> can be found on the linked website.</p><p>As in the ESP8266 project, I find it convenient to attach the 5V power supply to the LED strip&apos;s second pair of wires as it consumes a lots of power when completely lit. The Raspberry Pi is then powered via the red/black wires in the 4-pin connector by attaching it to the correct pins in the header.</p><table class="darkframe" style="margin: 0 auto"> <tr> <td></td> <td></td> <td class="darkframe" style="text-align:center; vertical-align:middle">Raspberry Pi 3<br />2x20 Pin Header</td> <td></td> <td></td> </tr> <tr> <td class="darkframe" style="text-align: right">Matrix display SCLK &lt;- SPI1 SCLK</td> <td class="darkframe">40</td> <td rowspan="20" class="darkframe" style="text-align:center; vertical-align:middle; background:white"><a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/raspberry-pi-3-pins-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/raspberry-pi-3-pins.jpg" style="height:34em" class="zoom" /></a></td> <td class="darkframe">39</td> <td>GND</td> </tr> <tr> <td class="darkframe" style="text-align: right">Matrix display SCLK &lt;- SPI1 MOSI</td> <td class="darkframe">38</td> <td class="darkframe">37</td> <td></td> </tr> <tr> <td></td> <td class="darkframe">36</td> <td class="darkframe">35</td> <td></td> </tr> <tr> <td class="darkframe" style="text-align: right">Matrix display GND &lt;- GND</td> <td class="darkframe">34</td> <td class="darkframe">33</td> <td></td> </tr> <tr> <td></td> <td class="darkframe">32</td> <td class="darkframe">31</td> <td></td> </tr> <tr> <td style="text-align: right">GND</td> <td class="darkframe">30</td> <td class="darkframe">29</td> <td></td> </tr> <tr> <td></td> <td class="darkframe">28</td> <td class="darkframe">27</td> <td></td> </tr> <tr> <td></td> <td class="darkframe">26</td> <td class="darkframe">25</td> <td>GND</td> </tr> <tr> <td></td> <td class="darkframe">24</td> <td class="darkframe">23</td> <td class="darkframe">SPI SCLK -&gt; LED strip clock wire (yellow)</td> </tr> <tr> <td></td> <td class="darkframe">22</td> <td class="darkframe">21</td> <td></td> </tr> <tr> <td style="text-align: right">GND</td> <td class="darkframe">20</td> <td class="darkframe">19</td> <td class="darkframe">SPI MOSI -&gt; LED strip data wire (green)</td> </tr> <tr> <td></td> <td class="darkframe">18</td> <td class="darkframe">17</td> <td></td> </tr> <tr> <td class="darkframe" style="text-align: right">Matrix display CS &lt;- GPIO 23</td> <td class="darkframe">16</td> <td class="darkframe">15</td> <td></td> </tr> <tr> <td class="darkframe" style="text-align: right">LED strip ground (black) &lt;- GND</td> <td class="darkframe">14</td> <td class="darkframe">13</td> <td></td> </tr> <tr> <td></td> <td class="darkframe">12</td> <td class="darkframe">11</td> <td></td> </tr> <tr> <td></td> <td class="darkframe">10</td> <td class="darkframe">09</td> <td></td> </tr> <tr> <td></td> <td class="darkframe">08</td> <td class="darkframe">07</td> <td></td> </tr> <tr> <td style="text-align: right">GND</td> <td class="darkframe">06</td> <td class="darkframe">05</td> <td></td> </tr> <tr> <td class="darkframe" style="text-align: right">LED strip 5V power (red) + bridge to 02 &lt;- 5V</td> <td class="darkframe">04</td> <td class="darkframe">03</td> <td></td> </tr> <tr> <td class="darkframe" style="text-align: right">Matrix display 5V VCC + bridge to 04 &lt;- 5V</td> <td class="darkframe">02</td> <td class="darkframe">01</td> <td></td> </tr></table><h2>Optionally Connecting the MAX7219 Dot LED Matrix Display</h2><p>Building the large MAX7219 dot LED matrix display is quite a hassle. My version of the display is held together with lots of hot glue on the inside. Alignment of the modules is critical otherwise you won&apos;t be able to read the letters. The MAX7219 form a chain of 8&times;8 matrix modules, which means the boards have to be connected in serial on the underside. Again lots of hot glue to keep the wires in place. Overall it turned out pretty good. It requires an amazing amount of power though (measured by how warm it gets).</p><p style="text-align: center"><a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/led-matrix-display-back-large.jpg"><img src="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/led-matrix-display-back.jpg" height="250" class="zoom" /></a></p><p>The MAX7219 dot led matrix display boards have 5 connections: VCC (5V) power, GND, DIN/DOUT (SPI data), CS (SPI chip select), and CLK (SPI SLCK clock). I directly connected the 5-pin ribbon cable to the first LED matrix module with the following unusual coloring: VCC (black), GND (green), DIN/DOUT (red), CS (blue), CLK (white). The ribbon cable is attached to a 5-pin JST connector, and the connector is glued to the &quot;hat&quot; board.</p><p>The MAX7219 chain is connected to the Raspberry Pi&apos;s second SPI controller. SPI data (DIN/DOUT) is attached to pin 38 (SPI1 MOSI), SPI clock (CLK) is attached to pin 40 (SPI1 SCLK), and SPI chip select (CS) is attached to pin 16. Pin 16 is not a special pin, it is GPIO pin 23 as counted by the kernel (not WiringPi). Pin 16 / GPIO23 is switched directly by the BlinkenAlgorithms program to control the LED matrix display. Due to the power consumption of the LED matrix display, I used a pretty thick red wire for the 5V connection from the LED strip&apos;s power wire. That was probably overkill.</p><h2>Installing Raspbian and BlinkenAlgorithms</h2><p>Download the current version of Raspbian lite from <a href="https://www.raspberrypi.org/downloads/raspbian/">https://www.raspberrypi.org/downloads/raspbian/</a>. Direct link: <a href="https://downloads.raspberrypi.org/raspbian_lite_latest">raspbian_lite_latest</a>, which delivered <code>2019-07-10-raspbian-buster-lite.zip</code> at the time of writing. Unzip the download and write the <code>.img</code> file to the microSD card.</p><p>I like to configure the Raspberry Pi via <code>ssh</code> by attaching it to a local network. Due to security, the <code>ssh</code> server is disabled by default, but can easily be activated by creating an empty file <code>ssh</code> in the &quot;boot&quot; partition on the SD card.</p><div class="codesnippet termframe" style="font-family: monospace"><pre><span class="comment"># find Raspberry Pi on the LAN using nmap and log in via ssh, default password is &quot;raspberry&quot;</span><br/><span class="shell no-select">$ </span><span class="shellcmd">nmap -sP 192.168.77.*</span><br/>(list of hosts)<br/><span class="shell no-select">$ </span><span class="shellcmd">ssh pi@192.168.77.12</span><br/><br/><span class="comment"># change the  default password</span><br/><span class="shell no-select">$ </span><span class="shellcmd">passwd</span><br/><br/><span class="comment"># reconfigure Raspberry Pi setting</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo raspi-config</span><br/><br/><span class="comment"># change two settings:</span><br/><span class="comment"># 2 Network Options &gt; N1 Hostname: change to &quot;sortpi&quot;</span><br/><span class="comment"># 5 Interfacing Options &gt; P4 SPI: enable SPI</span><br/><span class="comment"># exit raspi-config</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo reboot # (or select reboot in raspi-config)</span><br/><br/><span class="comment"># after reboot, ssh again and update and install packages</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo apt update</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo apt upgrade</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo apt install git build-essential screen cmake cmake-curses-gui libsdl2-dev</span><br/><br/><span class="comment"># turn up volume to 90% (or use alsamixer)</span><br/><span class="shell no-select">$ </span><span class="shellcmd">amixer -c 0 sset PCM,0 90%</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo alsactl store</span><br/><br/><span class="comment"># enable secondary SPI interface:</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo sh -c &quot;echo 'dtoverlay=spi1-1cs' &gt;&gt; /boot/config.txt&quot;</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo reboot</span></pre></div><p>Download the BlinkenAlgorithms repository and compile and run BlinkenSort:</p><div class="codesnippet termframe" style="font-family: monospace"><pre><span class="comment"># get the BlinkenAlgorithms code repo</span><br/><span class="shell no-select">$ </span><span class="shellcmd">git clone --recursive https://github.com/bingmann/BlinkenAlgorithms.git</span><br/><br/><span class="comment"># build BlinkenSort with Sound for Raspberry Pi</span><br/><span class="shell no-select">$ </span><span class="shellcmd">cd BlinkenAlgorithms/blinken-sort-sound-pi</span><br/><span class="shell no-select">$ </span><span class="shellcmd">mkdir build</span><br/><span class="shell no-select">$ </span><span class="shellcmd">cd build</span><br/><span class="shell no-select">$ </span><span class="shellcmd">cmake ..</span><br/><span class="shell no-select">$ </span><span class="shellcmd">make</span><br/><span class="shell no-select">$ </span><span class="shellcmd">./blinken-sort</span></pre></div><p>Setup to automatically run on boot up:</p><div class="codesnippet termframe" style="font-family: monospace"><pre><span class="comment"># write systemd service file</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo nano /etc/systemd/system/blinken-sort-tty1.service</span><br/><br/><span class="comment"># and paste the following into the editor</span><br/>[Unit]<br/>Description=BlinkenSort tty1-service<br/>After=getty.target<br/>Conflicts=getty@tty1.service<br/><br/>[Service]<br/>Type=simple<br/>ExecStart=/usr/bin/screen -S myTTY1 /home/pi/BlinkenAlgorithms/blinken-sort-sound-pi/build/blinken-sort<br/>StandardInput=tty-force<br/>StandardOutput=inherit<br/>StandardError=inherit<br/>User=pi<br/><br/>[Install]<br/>WantedBy=multi-user.target<br/><span class="comment"># end of file, ctrl+x to exit nano</span><br/><br/><span class="comment"># reload systemd files and enable and start the new service</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo systemctl daemon-reload</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo systemctl enable blinken-sort-tty1.service</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo systemctl start blinken-sort-tty1.service</span><br/><br/><span class="comment"># check that blinken-sort is running</span><br/><span class="shell no-select">$ </span><span class="shellcmd">ps x</span><br/><br/><span class="comment"># reboot the system and check again that blinken-sort is running</span><br/><span class="shell no-select">$ </span><span class="shellcmd">sudo reboot</span><br/><span class="shell no-select">$ </span><span class="shellcmd">ps x</span></pre></div><h2>Optionally: Printouts of Some of the Algorithms</h2><p>For one of the installations, I made full-page printouts of some the algorithm&apos;s code:</p><p><a title="Download SoLS-Algorithms-Printout.pdf (82.1 KiB)" href="SoLS-Algorithms-Printout.pdf">SoLS-Algorithms-Printout.pdf <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAARCAYAAAAG/yacAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALCQAACwkBEvpHPgAAAAd0SU1FB9wMCgcxLPKvBkUAAAHtSURBVCjPhZLNSiNBEMd/1TOZfCwaPAUE8bYnA543xLyCN08efQJPPoBvYMAn8OLVo0dhIeBBEBEkhyjLZP0AQ4Jmeqa79pCd3njaPzTV3dSvqquqZTAY6OrqKgIgglfFO4dzjvl8ztHR0Y/Ly8ufIkLQ/f29Bp2eqs8yVVW11urt7a2maao7OzsdVQ2MKSOo9/D2hhwe4p2jUqlQr9cxxnB2dnbV6/UCaAI+ncLNDdrphCsRwXtPkiScn59f7e7udlSVOHisrKAbG+j7O3JygrbbNKtVRo0G1lpGoxHdbvdKRJoB0qcn5OIC2dtD7+4wDw+sNZt8Oz7m9+MjjUaD2WwG8H0BpSnS78PWFrq/D/U6/vmZXITP11eq1SpJklCr1QA0RgT6fWQ0wvf7mFZrkXl9HclzYmuZz2YkSUIcL3LEAHpwgHx8YFot0jRlOBzinKMoCqy1bG9vs6wYVdjcZDwe8+v6GuccxhhUFWMMURRRFAXLc4oBBFBVoigKzqU1xoTf8WVO3ntUFRFBRDDGBGuMwVq7qLOEnHNYa/HeB2gZFBHyPCfP83/fyHv/BVp2Ls9lQ8pMcdmlWq1GFEU450LkoigCsPy8+OXlhel0irWWLMvIsow8z1HVUGu5JpMJZeMqQPvv/r+KoujzD0w6NaOXWgCIAAAAAElFTkSuQmCC" alt="SoLS-Algorithms-Printout.pdf" style="margin-bottom: -2px" width="13" height="17"/></a>, LaTeX source file <a title="Download SoLS-Algorithms-Printout.tex (10.6 KiB)" href="SoLS-Algorithms-Printout.tex">SoLS-Algorithms-Printout.tex</a>.</p><h2>Optionally: Set Up Both WiFi Station and an Access Point (AP)</h2><p>While it is easy to connect the Raspberry Pi to a local WiFi access point, such that one can log in and change the BlinkenAlgorithms code, I take the LED strips to many places to show people. There it is much harder to log in to the Pi due to the missing local WiFi config on it. Hence, the Pi opening an access point itself is a better solution. That is possible using <code>hostapd</code> and <code>dnsmasq</code>. However, configuring <b>both</b> station and access points modes with the same internal WiFi chip is surprisingly difficult.</p><p>I collected a <a href="wifi-ap-station.html">tutorial to set up both WiFi station and an access point</a> which worked on <code>2019-07-10-raspbian-buster-lite.zip</code>. Your mileage may vary in future versions.</p></div></article><br/><a id="notes"></a><div class="commentframe" style="display: none; border-color: red" id="newpost_div"> <div class="commentimage"> <a href="http://www.gravatar.com/" id="newpost_imgurl"> <img id="newpost_img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAAAAAA6fptVAAAAAXNSR0IArs4c6QAAAApJREFUCB1j+A8AAQEBADZfZ4AAAAAASUVORK5CYII=" width="80" height="80" alt="Gravatar" /> </a> </div> <div class="commenttitle">Comment by <b><span id="newpost_name">Name</span></b> at <span id="newpost_date">Date</span><span id="newpost_uri">- URI</span><a href="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/" rel="nofollow"></a></div> <div class="commentbody" id="newpost_body"></div> <div class="commentbody" style="text-align: right"><big>Preview (Not Saved!)</big></div></div><a id="postnote"></a><form id="noteform" method="post" action="/sendpost.php"><div class="commentform" style="text-align: center"><table class="center thinframe" style="text-align: left"> <tr> <td colspan="2" style="text-align: center">Post Comment<input type="hidden" name="previewok" value="0" /><input type="hidden" name="posturi" value="/2019/0802-BlinkenSort-The-Sound-of-LED-Sorting-Algorithms-with-RaspberryPi3-and-APA102-or-SK9822/" /></td> </tr> <tr> <td>Name:</td> <td><input type="text" name="postname" size="40" /></td> </tr> <tr> <td>E-Mail or Homepage:<br /><span style="font-size: 8pt">&nbsp;</span></td> <td><input type="text" name="postmail" size="40" /><br /> <span style="font-size: 8pt">URLs (http://...) are displayed, e-mails are hidden and used for Gravatar.</span></td> </tr> <tr> <td colspan="2" style="text-align: center"> <textarea name="postbody" cols="80" rows="8"></textarea><br /> <span style="font-size: 8pt">Many common HTML elements are allowed in the text, but no CSS style.</span> </td> </tr> <tr> <td colspan="2" style="text-align: center"> <input type="button" name="Preview" value="Preview" onclick="return noteform_submit()" /> <input type="submit" name="Submit" value="Submit" disabled="disabled" id="newpost_submit" /> </td> </tr></table></div></form></div><footer><div style="text-align: right; padding: 8pt; font-size: 13px"><a href="/xmlfeed/weblog-rss20.xml"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPAgMAAAAOp6AcAAAADFBMVEVmZmb/ZgD///+JjnlbTUWmAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABQAAAADwCexKkxAAAAWUlEQVQYlWNgwAa0VmGAFQyqoSCQ/x8J/CBFMCt0ZdTU/F/7/+1HEkydFpoKVPn+93sUlUujQvP/7UcRTAuNDJ2a//s/imDqtKVZofm/1qGYSZk7sfodGwAAiobBJtffoNAAAAAASUVORK5CYII=" alt="RSS 2.0 Weblog Feed" width="80" height="15"/></a> <a href="/xmlfeed/weblog-atom10.xml"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPAgMAAAAOp6AcAAAADFBMVEVmZmb/ZgD///+JjnlbTUWmAAAAaklEQVQYlWNgwAa0VmGAFQyqoSCQ/x8J/CBFMDV16rTQ/H/7V//69+//v/3/9oMEI6cuAwr+fv/+/b5d///v//0eJBgWOhMo+Gs9UPAdXDBy6lSYyn9wQZCZS0GCYDPXQcykzJ1Y/Y4NAABKvL80wyoMPgAAAABJRU5ErkJggg==" alt="Atom 1.0 Weblog Feed" width="80" height="15"/></a> <a href="http://validator.w3.org/check?uri=referer"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAB1FBMVEUHQIgIRY0MN4QNRYoSRYsXUpIYVJQeUpUhWpgjUJMjWpgmU5QnXJkuYZ0uYpwwV5YyZJ4zaKM3ZaA5aaI6aqM6a6E8ZqA8Z6BAbaRBbqdCbaVHd61KSkpKcaZQUFBUf69UgbBVVVVXfq9Yg7NZhbJZh7RagrNeXVxeh7RfjLdgYGBiiLZmZmZnZ2doirhpkbt0m8F3m8B3ncJ5lb55ocR+ocSDgX+Do8eEpMqGhoaHp8iIpMeJjnmJpseKqMeOqsqPsdCQrcyVlZWVsM2Zs9CZtNCfu9ahoaGhuNShudSivNSjtMWjvNSmpqWnpqSrw9qvxNqyxdmyxdyzsK6zs7Ozx9y0xt21yN22tra4y+K80eK/v7/AwMDExMTEy9DH2ejK2+jM2ujN3uvP0dLR0NDR3uvS3uvS3+zU4u3V1dXY2dnY4u7Y4+3b5e/d3d3d5u/d5/De3t7f39/h4uLj4uHj6/Ll7PXm7fTn7/Xo7/Tp7/bq7Ozr6unr8ffw8PDw9vvx9fny+P7z8/Pz9vnz9vv3+fv4+vz5+vz6+vr6+/36/P36///7+/77/Pz7/f37/f78/Pz8/f38/f79/f39/f79/f/9/v79///+/v7+/v////3///+tYR2LAAABKklEQVQ4y2PQoTJg0JlNVYDPQBsyAMTAqaFes8tdsmdPCtA3MDStr3GKKK6myMAprgJ9pcpWs/MlRExYJBvNZLR0sigycHYOV1S7mtjsQJ4gf+HIFPXoWMs6qIGzIRiKZs9GFoEaMRuZhhrYqqJXy8uZYauRxC/VHew7e3YTPAxnI5swG6JxNrKBNjB1EFmIgV0+HA6C8pqqzhXG7BbJJROQIwViMYQ7G2oDQQNn57JyG7kxiCfObrBmS5+BHMuYLkTzMnYDm5WY4lOZZRPKZocxes+aPbuwCFsYohiICLvZsKBAMrDTQ7K/StveU8icTzrOL8JdLpOyWJ49u8Bx9ozw8DY7UYW03hhdxZAOSg2c3jN79rSJs1vSKmfOnpFXNJmynELlvExlAADnaZpLFGEC2wAAAABJRU5ErkJggg==" alt="Valid XHTML 1.1" width="80" height="15"/></a> <a href="http://jigsaw.w3.org/css-validator/check/referer"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAB1FBMVEUHQIgIRY0MN4QNRYoSRYsXUpIYVJQeUpUhWpgjUJMjWpgmU5QnXJkuYZ0uYpwwV5YyZJ4zaKM3ZaA5aaI6aqM6a6E8ZqA8Z6BAbaRBbqdCbaVHd61KSkpKcaZQUFBUf69UgbBVVVVXfq9Yg7NZhbJZh7RagrNeXVxeh7RfjLdgYGBiiLZmZmZnZ2doirhpkbt0m8F3m8B3ncJ5lb55ocR+ocSDgX+Do8eEpMqGhoaHp8iIpMeJjnmJpseKqMeOqsqPsdCQrcyVlZWVsM2Zs9CZtNCfu9ahoaGhuNShudSivNSjtMWjvNSmpqWnpqSrw9qvxNqyxdmyxdyzsK6zs7Ozx9y0xt21yN22tra4y+K80eK/v7/AwMDExMTEy9DH2ejK2+jM2ujN3uvP0dLR0NDR3uvS3uvS3+zU4u3V1dXY2dnY4u7Y4+3b5e/d3d3d5u/d5/De3t7f39/h4uLj4uHj6/Ll7PXm7fTn7/Xo7/Tp7/bq7Ozr6unr8ffw8PDw9vvx9fny+P7z8/Pz9vnz9vv3+fv4+vz5+vz6+vr6+/36/P36///7+/77/Pz7/f37/f78/Pz8/f38/f79/f39/f79/f/9/v79///+/v7+/v////3///+tYR2LAAABEUlEQVQ4y2PQoTJg0JlNVYDPQBsyAMTAqaFes8tdsmdPCtA3MDStr3GKKK6myMAprgJ9pcpWs/MlRExYJBvNZLR0sigycHYOV1S7mtjsQJ4gf+HIFPXoWMs6mIEQCsIjwhKoga0qerW8nBm2Gkn8Ut3BvrNnN8HCcDYM2cBIogzs8uFwEJTXVHWuMGa3SC6ZgIgUqCEwdxJr4OxcVm4jNwbxxNkN1mzpM2ajGIjsPGK9PLtZiSk+lVk2oWx2GKP3rNmzC4tQwpDoIIQb2Okh2V+lbe8pZM4nHecX4S6XSVksz55d4Dh7Rnh4m52oQlpvjK5iSAelBk7vmT172sTZLWmVM2fPyCuaTFlOoXJepjIAANlljDGY/l5pAAAAAElFTkSuQmCC" alt="Valid CSS (2.1)" width="80" height="15"/></a><br/>Copyright 2005-2022 <a href="/about/">Timo Bingmann</a>. All rights reserved.</div></footer></body></html>