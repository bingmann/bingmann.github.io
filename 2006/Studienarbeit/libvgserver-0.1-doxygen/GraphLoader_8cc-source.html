<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>VGServer: GraphLoader.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>GraphLoader.cc</h1><a href="GraphLoader_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// $Id: GraphLoader.cc 244 2006-07-07 09:11:51Z schultes $</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#include "<a class="code" href="GraphLoader_8h.html">GraphLoader.h</a>"</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "<a class="code" href="GraphData_8h.html">GraphData.h</a>"</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="AttributeBlob__impl_8h.html">AttributeBlob_impl.h</a>"</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="keyword">namespace </span>VGServer {
<a name="l00011"></a>00011 
<a name="l00012"></a><a class="code" href="classVGServer_1_1GraphLoader.html#3edeb7b2a1cf57e7e709cb37027b418a">00012</a> <a class="code" href="classVGServer_1_1GraphLoader.html#3edeb7b2a1cf57e7e709cb37027b418a">GraphLoader::GraphLoader</a>(<span class="keyword">const</span> <span class="keyword">class</span> <a class="code" href="classVGServer_1_1GraphProperties.html">GraphProperties</a> &amp;gp)
<a name="l00013"></a>00013     : <a class="code" href="classVGServer_1_1GraphData.html">GraphData</a>(gp)
<a name="l00014"></a>00014 {
<a name="l00015"></a>00015     vertex_minnum = 0;
<a name="l00016"></a>00016     vertex_aidx = vertex_aidxnext = 0;
<a name="l00017"></a>00017 
<a name="l00018"></a>00018     edge_minsrc = edge_mintgt = 0;
<a name="l00019"></a>00019     edge_eidx = 0;
<a name="l00020"></a>00020     edge_aidx = edge_aidxnext = 0;
<a name="l00021"></a>00021 
<a name="l00022"></a>00022     <span class="comment">// clears the termination nodes, which are added by GraphData's constructor.</span>
<a name="l00023"></a>00023     <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.clear();
<a name="l00024"></a>00024     <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.clear();
<a name="l00025"></a>00025 }
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="classVGServer_1_1GraphLoader.html#a8e9f617f0289c906c6e7be6eea14e23">00027</a> <span class="keywordtype">void</span> <a class="code" href="classVGServer_1_1GraphLoader.html#a8e9f617f0289c906c6e7be6eea14e23">GraphLoader::reserve</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vertexnum, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> edgenum,
<a name="l00028"></a>00028                           <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vertexattrsize, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> edgeattrsize)
<a name="l00029"></a>00029 {
<a name="l00030"></a>00030     <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.reserve(vertexnum);
<a name="l00031"></a>00031     <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.reserve(edgenum);
<a name="l00032"></a>00032 
<a name="l00033"></a>00033     <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#c85c4d7ef155699201265f6f414b56c6">alloc</a>(vertexattrsize);
<a name="l00034"></a>00034     <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#c85c4d7ef155699201265f6f414b56c6">alloc</a>(edgeattrsize);
<a name="l00035"></a>00035 }
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="classVGServer_1_1GraphLoader.html#e279372324e14e96eb8515602595c8cc">00037</a> <span class="keyword">class </span><a class="code" href="classVGServer_1_1GraphData.html">GraphData</a>&amp; <a class="code" href="classVGServer_1_1GraphLoader.html#e279372324e14e96eb8515602595c8cc">GraphLoader::finish</a>()
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039     <span class="keywordflow">if</span> (vertex_minnum != <a class="code" href="namespaceVGServer.html#5499528b550612dfc08604c246cad9d1">VERTEX_INVALID</a>) <a class="code" href="classVGServer_1_1GraphLoader.html#bcac2b716745d46c7bdd375dd07bb526">terminate</a>();
<a name="l00040"></a>00040 
<a name="l00041"></a>00041     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00042"></a>00042 }
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="classVGServer_1_1GraphLoader.html#bcac2b716745d46c7bdd375dd07bb526">00044</a> <span class="keywordtype">void</span> <a class="code" href="classVGServer_1_1GraphLoader.html#bcac2b716745d46c7bdd375dd07bb526">GraphLoader::terminate</a>()
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046     <span class="keywordflow">if</span> (vertex_minnum &gt; 0)
<a name="l00047"></a>00047         finishVertexAttrSequence();
<a name="l00048"></a>00048     
<a name="l00049"></a>00049     <span class="comment">// adds termination vertex of the vertices[].attridx ascending sequence and</span>
<a name="l00050"></a>00050     <span class="comment">// fill in edgeidx for vertices without edges.</span>
<a name="l00051"></a>00051     {
<a name="l00052"></a>00052         <a class="code" href="structVGServer_1_1GraphData_1_1Vertex.html">GraphData::Vertex</a>&amp; vend = <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.new_back();
<a name="l00053"></a>00053         vend.<a class="code" href="structVGServer_1_1GraphData_1_1Vertex.html#7095ab391297d19a801555776661129d">attridx</a> = vertex_aidxnext;
<a name="l00054"></a>00054 
<a name="l00055"></a>00055         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = edge_minsrc; v &lt; <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.size(); v++)
<a name="l00056"></a>00056         {
<a name="l00057"></a>00057             <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>[v].edgeidx = edge_eidx;
<a name="l00058"></a>00058         }
<a name="l00059"></a>00059     }
<a name="l00060"></a>00060 
<a name="l00061"></a>00061     <span class="keywordflow">if</span> (<a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.size() &gt; 0)
<a name="l00062"></a>00062         finishEdgeAttrSequence();
<a name="l00063"></a>00063     
<a name="l00064"></a>00064     <span class="comment">// add termination edge object for edgeidx and attridx</span>
<a name="l00065"></a>00065     {
<a name="l00066"></a>00066         <a class="code" href="structVGServer_1_1GraphData_1_1Edge.html">GraphData::Edge</a>&amp; eend = <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.new_back();
<a name="l00067"></a>00067         eend.<a class="code" href="structVGServer_1_1GraphData_1_1Edge.html#405eeec93b4f0f2846c4e8a539813273">attridx</a> = edge_aidxnext;
<a name="l00068"></a>00068     }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070     vertex_minnum = <a class="code" href="namespaceVGServer.html#5499528b550612dfc08604c246cad9d1">VERTEX_INVALID</a>;
<a name="l00071"></a>00071     edge_minsrc = edge_mintgt = <a class="code" href="namespaceVGServer.html#5499528b550612dfc08604c246cad9d1">VERTEX_INVALID</a>;
<a name="l00072"></a>00072 }
<a name="l00073"></a>00073 
<a name="l00074"></a><a class="code" href="classVGServer_1_1GraphLoader.html#a8ab251b7cf14f0039abbf8f581c4c2d">00074</a> <span class="keywordtype">void</span> <a class="code" href="classVGServer_1_1GraphLoader.html#a8ab251b7cf14f0039abbf8f581c4c2d">GraphLoader::addVertex</a>(<a class="code" href="namespaceVGServer.html#2d00573e5fef69198e2709f5c46c4526">vertexid_t</a> vid)
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076     <span class="keywordflow">if</span> (vid &lt; vertex_minnum) <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1OrderException.html">OrderException</a>();
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="keywordflow">if</span> (vertex_minnum &gt; 0)
<a name="l00079"></a>00079         finishVertexAttrSequence();
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="comment">// grow vertex buffer, this code will be deleted as the TpArray auto-grows.</span>
<a name="l00082"></a>00082 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> oldcap = <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.capacity();
<a name="l00084"></a>00084     <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.reserve(vid+2);
<a name="l00085"></a>00085     <span class="keywordflow">if</span> (oldcap != <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.capacity()) 
<a name="l00086"></a>00086         fprintf(stderr,<span class="stringliteral">"New vertex capacity: %d\n"</span>, <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.capacity());
<a name="l00087"></a>00087 <span class="preprocessor">#endif</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span>
<a name="l00089"></a>00089     <span class="comment">// create nodes with filled in attridx:</span>
<a name="l00090"></a>00090     <span class="comment">// set all vertex.attridx from the last added+1 vertex up to this to the</span>
<a name="l00091"></a>00091     <span class="comment">// current pointer</span>
<a name="l00092"></a>00092     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = vertex_minnum; v &lt;= vid; v++)
<a name="l00093"></a>00093     {
<a name="l00094"></a>00094         <span class="comment">// figure out if we have to add space for varying attributes?</span>
<a name="l00095"></a>00095         <span class="comment">// no we dont: varying attribute space may not exist</span>
<a name="l00096"></a>00096         <a class="code" href="structVGServer_1_1GraphData_1_1Vertex.html">GraphData::Vertex</a> &amp;vnew = <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.new_back();
<a name="l00097"></a>00097         assert(<a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.size() == v+1);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         vnew.attridx = vertex_aidxnext;
<a name="l00100"></a>00100     }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102     <a class="code" href="classVGServer_1_1GraphData.html#394d2068d59a3ad0fa5ccc41e518a89c">vertexcount</a>++;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     vertex_minnum = vid+1;
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     <span class="comment">// position of the default bitfield</span>
<a name="l00107"></a>00107     vertex_aidx = vertex_aidxnext;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     <span class="comment">// clear default bits</span>
<a name="l00110"></a>00110     <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#0bb73accc06987d9714615981d56d80c">zero</a>(vertex_aidx, <a class="code" href="classVGServer_1_1GraphData.html#2108ec5a869e33d07cbbeb2694f0e10e">properties</a>.<a class="code" href="classVGServer_1_1GraphProperties.html#566754d60620faf8028645a6fc6a57bb">vertexattr</a>.<a class="code" href="classVGServer_1_1AttributePropertiesList.html#8f0041794d0381debe51f98fc8f258e3">defbytes</a>);
<a name="l00111"></a>00111 
<a name="l00112"></a>00112     <span class="comment">// advance the attribute write pointer the number of default bits.</span>
<a name="l00113"></a>00113     vertex_aidxnext = vertex_aidx + <a class="code" href="classVGServer_1_1GraphData.html#2108ec5a869e33d07cbbeb2694f0e10e">properties</a>.<a class="code" href="classVGServer_1_1GraphProperties.html#566754d60620faf8028645a6fc6a57bb">vertexattr</a>.<a class="code" href="classVGServer_1_1AttributePropertiesList.html#8f0041794d0381debe51f98fc8f258e3">defbytes</a>;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <span class="comment">// reset attribute loading sequence</span>
<a name="l00116"></a>00116     vertex_lastid = 0;
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="classVGServer_1_1GraphLoader.html#5720e03c78ef593c88e25ee040f4cb08">00119</a> <span class="keywordtype">void</span> <a class="code" href="classVGServer_1_1GraphLoader.html#5720e03c78ef593c88e25ee040f4cb08">GraphLoader::setVertexAttr</a>(<a class="code" href="namespaceVGServer.html#2d00573e5fef69198e2709f5c46c4526">vertexid_t</a> vid, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> attrid, <span class="keyword">const</span> <span class="keyword">class</span> <a class="code" href="classVGServer_1_1AnyType.html">AnyType</a> &amp;value)
<a name="l00120"></a>00120 {
<a name="l00121"></a>00121     <span class="keywordflow">if</span> (vid+1 &lt; vertex_minnum) <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1OrderException.html">OrderException</a>();
<a name="l00122"></a>00122     <span class="keywordflow">if</span> (attrid &lt; vertex_lastid) <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1OrderException.html">OrderException</a>();
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="keyword">const</span> <a class="code" href="classVGServer_1_1AttributePropertiesList.html">AttributePropertiesList</a> &amp;attrlist = <a class="code" href="classVGServer_1_1GraphData.html#2108ec5a869e33d07cbbeb2694f0e10e">properties</a>.<a class="code" href="classVGServer_1_1GraphProperties.html#566754d60620faf8028645a6fc6a57bb">vertexattr</a>;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <span class="keywordflow">if</span> (attrid &gt;= attrlist.size()) <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1AttributeIdException.html">AttributeIdException</a>();
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="keywordflow">if</span> (vertex_minnum &lt; vid+1)
<a name="l00129"></a>00129         <a class="code" href="classVGServer_1_1GraphLoader.html#a8ab251b7cf14f0039abbf8f581c4c2d">addVertex</a>(vid); <span class="comment">// add missing vertex entries</span>
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <span class="comment">// now vertex_aidx is the right pointer</span>
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="comment">// fill in skipped varying attributes</span>
<a name="l00134"></a>00134     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ai = vertex_lastid; ai &lt; attrid; ai++)
<a name="l00135"></a>00135     {
<a name="l00136"></a>00136         <span class="keywordflow">if</span> (attrlist[ai].getType() == <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00137"></a>00137         {
<a name="l00138"></a>00138             <span class="comment">// put the default value of the bool attribute into the default bitfield</span>
<a name="l00139"></a>00139             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(vertex_aidx, attrlist[ai].defbitnum, attrlist[ai].getInteger() != 0);
<a name="l00140"></a>00140         }
<a name="l00141"></a>00141         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (attrlist[ai].varying)
<a name="l00142"></a>00142         {
<a name="l00143"></a>00143             <span class="comment">// incase we skip over a varying attribute, we have to leave</span>
<a name="l00144"></a>00144             <span class="comment">// space in the attribute value array</span>
<a name="l00145"></a>00145 
<a name="l00146"></a>00146             <span class="comment">// zeros the value of a varying attribute. writes the default value</span>
<a name="l00147"></a>00147             <span class="comment">// of a varying attribute.</span>
<a name="l00148"></a>00148             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#4137b5e240f7c9adab6db0528a5fa8ac">putAnyType</a>(vertex_aidxnext, attrlist[ai]);
<a name="l00149"></a>00149 
<a name="l00150"></a>00150             vertex_aidxnext += attrlist[ai].getValueLength();
<a name="l00151"></a>00151         }
<a name="l00152"></a>00152         <span class="keywordflow">else</span>
<a name="l00153"></a>00153         {
<a name="l00154"></a>00154             <span class="comment">// for attributes with default values, set the default bit.</span>
<a name="l00155"></a>00155             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(vertex_aidx, attrlist[ai].defbitnum, <span class="keyword">true</span>);
<a name="l00156"></a>00156         }
<a name="l00157"></a>00157     }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <span class="comment">// now vertex_aidxnext points to the place to insert this value</span>
<a name="l00160"></a>00160     <span class="keywordflow">if</span> (value.getType() == attrlist[attrid].getType())
<a name="l00161"></a>00161     {
<a name="l00162"></a>00162         <span class="keywordflow">if</span> (attrlist[attrid].getType() == <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00163"></a>00163         {
<a name="l00164"></a>00164             <span class="comment">// put the value in the default bitfield</span>
<a name="l00165"></a>00165             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(vertex_aidx, attrlist[attrid].defbitnum, value.getInteger() != 0);
<a name="l00166"></a>00166         }
<a name="l00167"></a>00167         <span class="keywordflow">else</span>
<a name="l00168"></a>00168         {
<a name="l00169"></a>00169             <span class="comment">// save directly as the value parameter has the right type</span>
<a name="l00170"></a>00170             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#4137b5e240f7c9adab6db0528a5fa8ac">putAnyType</a>(vertex_aidxnext, value);
<a name="l00171"></a>00171             vertex_aidxnext += value.getValueLength();
<a name="l00172"></a>00172         }
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174     <span class="keywordflow">else</span>
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176         <a class="code" href="classVGServer_1_1AnyType.html">AnyType</a> tv = value; <span class="comment">// convert value</span>
<a name="l00177"></a>00177         tv.<a class="code" href="classVGServer_1_1AnyType.html#04de9820129ae5411bc2599c7e82696a">convertType</a>(attrlist[attrid].getType());
<a name="l00178"></a>00178 
<a name="l00179"></a>00179         <span class="keywordflow">if</span> (attrlist[attrid].getType() == <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00180"></a>00180         {
<a name="l00181"></a>00181             <span class="comment">// put the value in the default bitfield</span>
<a name="l00182"></a>00182             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(vertex_aidx, attrlist[attrid].defbitnum, tv.<a class="code" href="classVGServer_1_1AnyType.html#127db23317b6d038fd617a8d103c8833">getInteger</a>() != 0);
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184         <span class="keywordflow">else</span>
<a name="l00185"></a>00185         {
<a name="l00186"></a>00186             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#4137b5e240f7c9adab6db0528a5fa8ac">putAnyType</a>(vertex_aidxnext, tv);
<a name="l00187"></a>00187             vertex_aidxnext += tv.<a class="code" href="classVGServer_1_1AnyType.html#05364d974595b1175bce4db582fca933">getValueLength</a>();
<a name="l00188"></a>00188         }
<a name="l00189"></a>00189     }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191     <span class="keywordflow">if</span> (not attrlist[attrid].varying &amp;&amp; attrlist[attrid].getType() != <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00192"></a>00192     {
<a name="l00193"></a>00193         <span class="comment">// clear the default bit.</span>
<a name="l00194"></a>00194         <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(vertex_aidx, attrlist[attrid].defbitnum, <span class="keyword">false</span>);
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     vertex_lastid = attrid+1;
<a name="l00198"></a>00198 }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <span class="keywordtype">void</span> GraphLoader::finishVertexAttrSequence()
<a name="l00201"></a>00201 {
<a name="l00202"></a>00202     <span class="keyword">const</span> <a class="code" href="classVGServer_1_1AttributePropertiesList.html">AttributePropertiesList</a> &amp;attrlist = <a class="code" href="classVGServer_1_1GraphData.html#2108ec5a869e33d07cbbeb2694f0e10e">properties</a>.<a class="code" href="classVGServer_1_1GraphProperties.html#566754d60620faf8028645a6fc6a57bb">vertexattr</a>;
<a name="l00203"></a>00203     
<a name="l00204"></a>00204     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ai = vertex_lastid; ai &lt; attrlist.size(); ai++)
<a name="l00205"></a>00205     {
<a name="l00206"></a>00206         <span class="keywordflow">if</span> (attrlist[ai].getType() == <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00207"></a>00207         {
<a name="l00208"></a>00208             <span class="comment">// put the default value of the bool attribute into the default bitfield</span>
<a name="l00209"></a>00209             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(vertex_aidx, attrlist[ai].defbitnum, attrlist[ai].getInteger() != 0);
<a name="l00210"></a>00210         }
<a name="l00211"></a>00211         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (attrlist[ai].varying)
<a name="l00212"></a>00212         {
<a name="l00213"></a>00213             <span class="comment">// incase we skip over a varying attribute, we have to leave</span>
<a name="l00214"></a>00214             <span class="comment">// space in the attribute value array</span>
<a name="l00215"></a>00215 
<a name="l00216"></a>00216             <span class="comment">// zeros the value of a varying attribute. writes the default value</span>
<a name="l00217"></a>00217             <span class="comment">// of a varying attribute.</span>
<a name="l00218"></a>00218             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.putAnyType(vertex_aidxnext, attrlist[ai]);
<a name="l00219"></a>00219 
<a name="l00220"></a>00220             vertex_aidxnext += attrlist[ai].getValueLength();
<a name="l00221"></a>00221         }
<a name="l00222"></a>00222         <span class="keywordflow">else</span>
<a name="l00223"></a>00223         {
<a name="l00224"></a>00224             <span class="comment">// for attributes with default values, set the default bit.</span>
<a name="l00225"></a>00225             <a class="code" href="classVGServer_1_1GraphData.html#d22fa9435472db8d6621332adbf059f3">vertexattr</a>.putBool(vertex_aidx, attrlist[ai].defbitnum, <span class="keyword">true</span>);
<a name="l00226"></a>00226         }
<a name="l00227"></a>00227     }
<a name="l00228"></a>00228    
<a name="l00229"></a>00229     vertex_lastid = attrlist.size()+1;
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="classVGServer_1_1GraphLoader.html#7942b8ff880ed4af84e3a821e516b91a">00232</a> <span class="keywordtype">void</span> <a class="code" href="classVGServer_1_1GraphLoader.html#7942b8ff880ed4af84e3a821e516b91a">GraphLoader::addEdge</a>(<a class="code" href="namespaceVGServer.html#2d00573e5fef69198e2709f5c46c4526">vertexid_t</a> src, <a class="code" href="namespaceVGServer.html#2d00573e5fef69198e2709f5c46c4526">vertexid_t</a> tgt)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234     <span class="keywordflow">if</span> ( not ( (src == edge_minsrc-1 and tgt &gt;= edge_mintgt) or (src &gt;= edge_minsrc) ) )
<a name="l00235"></a>00235         <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1OrderException.html">OrderException</a>();
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     <span class="comment">// check vertex buffer size: cannot add edges to unloaded vertex ids</span>
<a name="l00238"></a>00238     <span class="comment">// (target id doesnt matter, it can be larger)</span>
<a name="l00239"></a>00239     <span class="keywordflow">if</span> (src &gt;= <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>.size())
<a name="l00240"></a>00240         <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1DataLoadedException.html">DataLoadedException</a>();
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     <span class="comment">// this code should also be delete.</span>
<a name="l00243"></a>00243 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l00244"></a>00244 <span class="preprocessor"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> oldcap = <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.capacity();
<a name="l00245"></a>00245     <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.reserve(<a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.size()+1);
<a name="l00246"></a>00246     <span class="keywordflow">if</span> (oldcap != <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.capacity()) 
<a name="l00247"></a>00247         fprintf(stderr,<span class="stringliteral">"New edge capacity: %d\n"</span>, <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.capacity());
<a name="l00248"></a>00248 <span class="preprocessor">#endif</span>
<a name="l00249"></a>00249 <span class="preprocessor"></span>
<a name="l00250"></a>00250     <span class="comment">// fill in remaining varying/default attribute values of last edge</span>
<a name="l00251"></a>00251     <span class="keywordflow">if</span> (<a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.size() &gt; 0) finishEdgeAttrSequence();
<a name="l00252"></a>00252     
<a name="l00253"></a>00253     <span class="comment">// allocate the edge object in the edge adjacency array</span>
<a name="l00254"></a>00254     <a class="code" href="structVGServer_1_1GraphData_1_1Edge.html">GraphData::Edge</a> &amp;enew = <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.new_back();
<a name="l00255"></a>00255     enew.<a class="code" href="structVGServer_1_1GraphData_1_1Edge.html#e75a2d68bef85f3445e82c3ab6197096">target</a> = tgt;
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="comment">// the added object is right at the end.</span>
<a name="l00258"></a>00258     assert( edge_eidx+1 == <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>.size() );
<a name="l00259"></a>00259     <span class="comment">// see assertion. edge_eidx = edges.size()-1;</span>
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="comment">// fill in edgeidx for skipped and this source vertices:</span>
<a name="l00262"></a>00262     <span class="comment">// set all vertex.edgeidx from the last source vertex+1 up to this to the</span>
<a name="l00263"></a>00263     <span class="comment">// current pointer</span>
<a name="l00264"></a>00264     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = edge_minsrc; v &lt;= src; v++)
<a name="l00265"></a>00265     {
<a name="l00266"></a>00266         <a class="code" href="classVGServer_1_1GraphData.html#ee73ceb4743e571fc85a774bfde9a33e">vertices</a>[v].edgeidx = edge_eidx;
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     edge_minsrc = src+1;
<a name="l00270"></a>00270     edge_mintgt = tgt+1;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <span class="comment">// position of the default bitfield</span>
<a name="l00273"></a>00273     edge_aidx = edge_aidxnext;
<a name="l00274"></a>00274     <a class="code" href="classVGServer_1_1GraphData.html#ca2fc8ad2adf2c38d28db45829f07893">edges</a>[edge_eidx].attridx = edge_aidx;
<a name="l00275"></a>00275 
<a name="l00276"></a>00276     edge_eidx++; <span class="comment">// eidx points to the next index to be used.</span>
<a name="l00277"></a>00277 
<a name="l00278"></a>00278     <span class="comment">// clear default bits</span>
<a name="l00279"></a>00279     <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#0bb73accc06987d9714615981d56d80c">zero</a>(edge_aidx, <a class="code" href="classVGServer_1_1GraphData.html#2108ec5a869e33d07cbbeb2694f0e10e">properties</a>.<a class="code" href="classVGServer_1_1GraphProperties.html#6d26ec6845ed6aba4836413f3a9d9cd9">edgeattr</a>.<a class="code" href="classVGServer_1_1AttributePropertiesList.html#8f0041794d0381debe51f98fc8f258e3">defbytes</a>);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     <span class="comment">// advance the attribute write pointer the number of default bits.</span>
<a name="l00282"></a>00282     edge_aidxnext = edge_aidx + <a class="code" href="classVGServer_1_1GraphData.html#2108ec5a869e33d07cbbeb2694f0e10e">properties</a>.<a class="code" href="classVGServer_1_1GraphProperties.html#6d26ec6845ed6aba4836413f3a9d9cd9">edgeattr</a>.<a class="code" href="classVGServer_1_1AttributePropertiesList.html#8f0041794d0381debe51f98fc8f258e3">defbytes</a>;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284     <span class="comment">// reset attribute loading sequence</span>
<a name="l00285"></a>00285     edge_lastid = 0;
<a name="l00286"></a>00286 }
<a name="l00287"></a>00287 
<a name="l00288"></a><a class="code" href="classVGServer_1_1GraphLoader.html#fde844976666467cd1c0cf4b0e6eb619">00288</a> <span class="keywordtype">void</span> <a class="code" href="classVGServer_1_1GraphLoader.html#fde844976666467cd1c0cf4b0e6eb619">GraphLoader::setEdgeAttr</a>(<a class="code" href="namespaceVGServer.html#2d00573e5fef69198e2709f5c46c4526">vertexid_t</a> src, <a class="code" href="namespaceVGServer.html#2d00573e5fef69198e2709f5c46c4526">vertexid_t</a> tgt,
<a name="l00289"></a>00289                               <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> attrid, <span class="keyword">const</span> <span class="keyword">class</span> <a class="code" href="classVGServer_1_1AnyType.html">AnyType</a> &amp;value)
<a name="l00290"></a>00290 {
<a name="l00291"></a>00291     <span class="keywordflow">if</span> ( not ( (src == edge_minsrc-1 and tgt+1 &gt;= edge_mintgt) or (src &gt;= edge_minsrc) ) )
<a name="l00292"></a>00292         <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1OrderException.html">OrderException</a>();
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     <span class="keywordflow">if</span> (attrid &lt; edge_lastid) <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1OrderException.html">OrderException</a>();
<a name="l00295"></a>00295 
<a name="l00296"></a>00296     <span class="keyword">const</span> <a class="code" href="classVGServer_1_1AttributePropertiesList.html">AttributePropertiesList</a> &amp;attrlist = <a class="code" href="classVGServer_1_1GraphData.html#2108ec5a869e33d07cbbeb2694f0e10e">properties</a>.<a class="code" href="classVGServer_1_1GraphProperties.html#6d26ec6845ed6aba4836413f3a9d9cd9">edgeattr</a>;
<a name="l00297"></a>00297 
<a name="l00298"></a>00298     <span class="keywordflow">if</span> (attrid &gt;= attrlist.size()) <span class="keywordflow">throw</span> <a class="code" href="classVGServer_1_1AttributeIdException.html">AttributeIdException</a>();
<a name="l00299"></a>00299 
<a name="l00300"></a>00300     <span class="keywordflow">if</span> (edge_minsrc != src+1 or edge_mintgt != tgt+1)
<a name="l00301"></a>00301         <a class="code" href="classVGServer_1_1GraphLoader.html#7942b8ff880ed4af84e3a821e516b91a">addEdge</a>(src,tgt); <span class="comment">// advance to the right edge</span>
<a name="l00302"></a>00302 
<a name="l00303"></a>00303     <span class="comment">// now edge_aidx is the right pointer</span>
<a name="l00304"></a>00304 
<a name="l00305"></a>00305     <span class="comment">// fill in skipped varying attributes</span>
<a name="l00306"></a>00306     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ai = edge_lastid; ai &lt; attrid; ai++)
<a name="l00307"></a>00307     {
<a name="l00308"></a>00308         <span class="keywordflow">if</span> (attrlist[ai].getType() == <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00309"></a>00309         {
<a name="l00310"></a>00310             <span class="comment">// put the default value of the bool attribute into the default bitfield</span>
<a name="l00311"></a>00311             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(edge_aidx, attrlist[ai].defbitnum, attrlist[ai].getInteger() != 0);
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (attrlist[ai].varying)
<a name="l00314"></a>00314         {
<a name="l00315"></a>00315             <span class="comment">// incase we skip over a varying attribute, we have to leave</span>
<a name="l00316"></a>00316             <span class="comment">// space in the attribute value array</span>
<a name="l00317"></a>00317 
<a name="l00318"></a>00318             <span class="comment">// write "default" zero of the varying attribute.</span>
<a name="l00319"></a>00319             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#4137b5e240f7c9adab6db0528a5fa8ac">putAnyType</a>(edge_aidxnext, attrlist[ai]);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321             edge_aidxnext += attrlist[ai].getValueLength();
<a name="l00322"></a>00322         }
<a name="l00323"></a>00323         <span class="keywordflow">else</span>
<a name="l00324"></a>00324         {
<a name="l00325"></a>00325             <span class="comment">// for attributes with default values, set the default bit.</span>
<a name="l00326"></a>00326             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(edge_aidx, attrlist[ai].defbitnum, <span class="keyword">true</span>);
<a name="l00327"></a>00327         }
<a name="l00328"></a>00328     }
<a name="l00329"></a>00329 
<a name="l00330"></a>00330     <span class="comment">// now edge_aidxnext points to the place to insert this value</span>
<a name="l00331"></a>00331     <span class="keywordflow">if</span> (value.getType() == attrlist[attrid].getType())
<a name="l00332"></a>00332     {
<a name="l00333"></a>00333         <span class="keywordflow">if</span> (attrlist[attrid].getType() == <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00334"></a>00334         {
<a name="l00335"></a>00335             <span class="comment">// put the value in the default bitfield</span>
<a name="l00336"></a>00336             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(edge_aidx, attrlist[attrid].defbitnum, value.getInteger() != 0);
<a name="l00337"></a>00337         }
<a name="l00338"></a>00338         <span class="keywordflow">else</span>
<a name="l00339"></a>00339         {
<a name="l00340"></a>00340             <span class="comment">// save directly as the value parameter has the right type</span>
<a name="l00341"></a>00341             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#4137b5e240f7c9adab6db0528a5fa8ac">putAnyType</a>(edge_aidxnext, value);
<a name="l00342"></a>00342             edge_aidxnext += value.getValueLength();
<a name="l00343"></a>00343         }
<a name="l00344"></a>00344     }
<a name="l00345"></a>00345     <span class="keywordflow">else</span>
<a name="l00346"></a>00346     {
<a name="l00347"></a>00347         <a class="code" href="classVGServer_1_1AnyType.html">AnyType</a> tv = value; <span class="comment">// convert value</span>
<a name="l00348"></a>00348         tv.<a class="code" href="classVGServer_1_1AnyType.html#04de9820129ae5411bc2599c7e82696a">convertType</a>(attrlist[attrid].getType());
<a name="l00349"></a>00349 
<a name="l00350"></a>00350         <span class="keywordflow">if</span> (attrlist[attrid].getType() == <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00351"></a>00351         {
<a name="l00352"></a>00352             <span class="comment">// put the value in the default bitfield</span>
<a name="l00353"></a>00353             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(edge_aidx, attrlist[attrid].defbitnum, tv.<a class="code" href="classVGServer_1_1AnyType.html#127db23317b6d038fd617a8d103c8833">getInteger</a>() != 0);
<a name="l00354"></a>00354         }
<a name="l00355"></a>00355         <span class="keywordflow">else</span>
<a name="l00356"></a>00356         {
<a name="l00357"></a>00357             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#4137b5e240f7c9adab6db0528a5fa8ac">putAnyType</a>(edge_aidxnext, tv);
<a name="l00358"></a>00358             edge_aidxnext += tv.<a class="code" href="classVGServer_1_1AnyType.html#05364d974595b1175bce4db582fca933">getValueLength</a>();
<a name="l00359"></a>00359         }
<a name="l00360"></a>00360     }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     <span class="keywordflow">if</span> (not attrlist[attrid].varying &amp;&amp; attrlist[attrid].getType() != <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00363"></a>00363     {
<a name="l00364"></a>00364         <span class="comment">// clear the default bit.</span>
<a name="l00365"></a>00365         <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(edge_aidx, attrlist[attrid].defbitnum, <span class="keyword">false</span>);
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     edge_lastid = attrid+1;
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 <span class="keywordtype">void</span> GraphLoader::finishEdgeAttrSequence()
<a name="l00372"></a>00372 {
<a name="l00373"></a>00373     <span class="keyword">const</span> <a class="code" href="classVGServer_1_1AttributePropertiesList.html">AttributePropertiesList</a> &amp;attrlist = <a class="code" href="classVGServer_1_1GraphData.html#2108ec5a869e33d07cbbeb2694f0e10e">properties</a>.<a class="code" href="classVGServer_1_1GraphProperties.html#6d26ec6845ed6aba4836413f3a9d9cd9">edgeattr</a>;
<a name="l00374"></a>00374     
<a name="l00375"></a>00375     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ai = edge_lastid; ai &lt; attrlist.size(); ai++)
<a name="l00376"></a>00376     {
<a name="l00377"></a>00377         <span class="keywordflow">if</span> (attrlist[ai].getType() == <a class="code" href="namespaceVGServer.html#681969e73da7c3cefa4884abe11efb5d814eeffd8fb6ed6d29df3bf12e69a278">ATTRTYPE_BOOL</a>)
<a name="l00378"></a>00378         {
<a name="l00379"></a>00379             <span class="comment">// put the default value of the bool attribute into the default bitfield</span>
<a name="l00380"></a>00380             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.<a class="code" href="classVGServer_1_1TpAttributeBlob.html#ffbc31bb389e5c07c8da2c23d33af09c">putBool</a>(edge_aidx, attrlist[ai].defbitnum, attrlist[ai].getInteger() != 0);
<a name="l00381"></a>00381         }
<a name="l00382"></a>00382         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (attrlist[ai].varying)
<a name="l00383"></a>00383         {
<a name="l00384"></a>00384             <span class="comment">// incase we skip over a varying attribute, we have to leave</span>
<a name="l00385"></a>00385             <span class="comment">// space in the attribute value array</span>
<a name="l00386"></a>00386 
<a name="l00387"></a>00387             <span class="comment">// write "default" zero of the varying attribute.</span>
<a name="l00388"></a>00388             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.putAnyType(edge_aidxnext, attrlist[ai]);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390             edge_aidxnext += attrlist[ai].getValueLength();
<a name="l00391"></a>00391         }
<a name="l00392"></a>00392         <span class="keywordflow">else</span>
<a name="l00393"></a>00393         {
<a name="l00394"></a>00394             <span class="comment">// for attributes with default values, set the default bit.</span>
<a name="l00395"></a>00395             <a class="code" href="classVGServer_1_1GraphData.html#5ebdd9ba39081367a53b5ee3701af98f">edgeattr</a>.putBool(edge_aidx, attrlist[ai].defbitnum, <span class="keyword">true</span>);
<a name="l00396"></a>00396         }
<a name="l00397"></a>00397     }
<a name="l00398"></a>00398     edge_lastid = attrlist.size()+1;
<a name="l00399"></a>00399 }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401 } <span class="comment">// namespace VGServer</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Sep 27 14:34:00 2006 for VGServer by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
