<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type" />
  <title>HelpPC 2.10 - 765</title>
  <link type="text/css" rel="stylesheet" href="nostalgic.css" title="nostalgic" />
</head>
<body>
<!-- Converted from the original text files by helppc21-convert.pl by Timo Bingmann - http://idlebox.net/ -->
<table class="bodytable" summary="">
  <tr class="top">
    <td class="unimono" style="text-align: left; width: 30%"><a class="menuplain" href="index.html">HelpPC 2.10</a></td>
    <td class="unimono" style="text-align: center; width: 30%"><a class="menuplain" href="index.html">Quick Reference Utility</a></td>
    <td class="unimono" style="text-align: right; width: 40%">Copyright 1991 David Jurgens</td>
  </tr>
  <tr>
    <td colspan="3">
      <table style="margin-left: auto; margin-right: auto" summary="">
        <tr>
          <td class="unimono">
            <br /><span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NEC &#956;PD765 &nbsp;- &nbsp;Floppy Disk Controller &nbsp;- &nbsp;8272A</span><br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;PS/2 FDC Diskette Status Register A at 3F0h</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;3F0h &nbsp;PS/2 Disk Status Register A (read-only)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; direction<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472; write protect<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; index<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; head 1 select<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; track 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; step<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; second drive installed<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; interrupt pending<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;PS/2 FDC Diskette Status Register B at 3F1h</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;3F1h &nbsp;PS/2 Disk Status Register B (read-only)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; motor enable 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; motor enable 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; write enable<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; read data (toggles w/positive transition in -RD DATA)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; write data (toggles w/positive transition in WR DATA)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; drive select<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472; reserved<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;FDC Digital Output Register at 3F2h &nbsp;(all systems)</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;port 3F2h &nbsp;(write only)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472; floppy drive select (0=A, 1=B, 2=floppy C, ...)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; 1 = FDC enable, 0 = hold FDC at reset<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; 1 = DMA &amp; I/O interface enabled &nbsp;(reserved PS/2)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; 1 = turn floppy drive A motor on<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; 1 = turn floppy drive B motor on<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; 1 = turn floppy drive C motor on; (reserved PS/2)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; 1 = turn floppy drive D motor on; (reserved PS/2)<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- used to control drive motors, drive selection, and feature enable<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- PS/2 only uses bit 0 for floppy drive select; bit 1 is reserved<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- PS/2 only uses bits 5 &amp; 4 for &nbsp;motor enable; bits 7&amp;6 are reserved<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- all DOR bits are cleared during controller reset<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;FDC Main Status Register at 3F4h &nbsp;(all systems)</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;port 3F4h &nbsp;(read only)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; floppy drive 0 in seek mode/busy<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472; floppy drive 1 in seek mode/busy<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; floppy drive 2 in seek mode/busy (reserved PS/2)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; floppy drive 3 in seek mode/busy (reserved PS/2)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDC read or write command in progress<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDC is in non-DMA mode<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; I/O direction; &nbsp;1 = FDC to CPU; 0 = CPU to FDC<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; data reg ready for I/O to/from CPU (request for master)<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;FDC Command Status Register 0 at 3F5h &nbsp;(all systems)</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;Command Status Register 0 at port 3F5h<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472; unit selected at interrupt (0=A, 1=B, 2=...)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; head number at interrupt (head 0 or 1)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; not ready on read/write or SS access to head 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; equipment check (see note)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; set to 1 when FDD completes a seek command<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; last command status (see below)<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Bits</span><br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp; 76 &nbsp;Last Command Status</span><br />
 &nbsp; &nbsp; &nbsp; &nbsp; 00 &nbsp;command terminated successfully<br />
 &nbsp; &nbsp; &nbsp; &nbsp; 01 &nbsp;command execution started but terminated abnormally<br />
 &nbsp; &nbsp; &nbsp; &nbsp; 10 &nbsp;invalid command issued<br />
 &nbsp; &nbsp; &nbsp; &nbsp; 11 &nbsp;command terminated abnormally due to a change in state of<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the Ready Signal from the FDC &nbsp;(reserved on PS/2)<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- equipment check can occur if FDD signals a fault or track zero is<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;not found after 77 steps on a recalibrate command<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- PS/2 only uses bits 1-0 for drive (values are 01b and 10b)<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;FDC Command Status Register 1 at 3F5h &nbsp;(all systems)</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;Command Status Register 1 at port 3F5h<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; FDC cannot find ID address mark (see reg 2)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472; write protect detected during write<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDC cannot find sector ID<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; unused (always zero)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; over-run; &nbsp;FDC not serviced in reasonable time<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; data error (CRC) in ID field or data field<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; unused (always zero)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; end of cylinder; sector# greater than sectors/track<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- bit 0 of Status Register 1 and bit 4 of Status Register 2 are<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;related and mimic each other<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;FDC Command Status Register 2 at 3F5h &nbsp;(all systems)</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;Command Status Register 2 at port 3F5h<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472; missing address mark in data field<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472; bad cylinder, ID not found and Cyl Id=FFh<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; scan command failed, sector not found in cylinder<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; scan command equal condition satisfied<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; wrong cylinder detected<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; CRC error detected in sector data<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; sector with deleted data address mark detected<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; unused (always zero)<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- bit 0 of Status Register 1 and bit 4 of Status Register 2 are<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;related and mimic each other<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;FDC Command Status Register 3 at 3F5h (FDD status, all systems)</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;Floppy Disk Drive Status at port 3F5h<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472; FDD unit selected status (0=A, 1=B, 2=...)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDD side head select status (0=head 0, 1=head 1)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDD two sided status signal<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDD track zero status signal<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDD ready status signal<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDD write protect status signal<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; FDD fault status signal<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;PS/2 FDC Digital Input Register at 3F7h</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;3F7h &nbsp;PS/2 Digital Input Register (read only)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9472;&#9472; high density select<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9492;&#9472;&#9524;&#9472;&#9524;&#9472;&#9524;&#9472;&#9524;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472; reserved<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; diskette change<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;PS/2 FDC Configuration Control Register at 3F7h</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;&#9474;7&#9474;6&#9474;5&#9474;4&#9474;3&#9474;2&#9474;1&#9474;0&#9474; &nbsp;3F7h &nbsp;PS/2 Config. Control Register (write only)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9474; &#9474; &#9474; &#9474; &#9474; &#9474; &#9492;&#9472;&#9524;&#9472;&#9472; DRC1, DRC0 &nbsp;(see below)<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &#9492;&#9472;&#9524;&#9472;&#9524;&#9472;&#9524;&#9472;&#9524;&#9472;&#9524;&#9472;&#9472;&#9472;&#9472;&#9472; reserved<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;DRC1 DRC0<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; 0 &nbsp; &nbsp;500000 bit per second mode<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 &nbsp; 1 &nbsp; &nbsp;reserved<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; 0 &nbsp; &nbsp;250000 bit per second mode<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 &nbsp; 1 &nbsp; &nbsp;reserved<br />
<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- Digital Input Register is used to sense the state of the<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(-diskette change) and the (-high density select) signals<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- Configuration Control Register is used to set the transfer rate<br />
<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FDC Programming Considerations</span><br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Three phases of command execution:</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;1. &nbsp;Command phase; commands are sent from the CPU to the FDC via<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;port 3F5h; &nbsp;bit 6 of the Status Register at 3F4h must be zero<br />
 &nbsp; &nbsp; &nbsp; &nbsp;2. &nbsp;Execution phase; FDC executes instruction &amp; generates INT 6<br />
 &nbsp; &nbsp; &nbsp; &nbsp;3. &nbsp;Result phase; status and other information is available to CPU;<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;INT 6 sets bit 7 of BIOS Data Area location 40:3E which can<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be polled for completion status<br />
<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Example of a read operation:</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;1. turn disk motor on and set delay time for drive spin up<br />
 &nbsp; &nbsp; &nbsp; &nbsp;2. perform seek operation; &nbsp;wait for disk interrupt<br />
 &nbsp; &nbsp; &nbsp; &nbsp;3. prepare DMA chip to move data to memory<br />
 &nbsp; &nbsp; &nbsp; &nbsp;4. send read command and wait for transfer complete interrupt<br />
 &nbsp; &nbsp; &nbsp; &nbsp;5. read status information<br />
 &nbsp; &nbsp; &nbsp; &nbsp;6. turn disk motor off<br />
<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Floppy Diskette Controller Operations (15 commands)</span><br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Read Data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp;MT &nbsp;MF &nbsp;SK &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 1 &nbsp; 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 6: &nbsp; &nbsp;end of track (last sector in track)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 7: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 8: &nbsp; &nbsp;data length (if cmd byte 5==0)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Read Deleted Data &nbsp;D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp;MT &nbsp;MF &nbsp;SK &nbsp; 0 &nbsp; 1 &nbsp; 1 &nbsp; 0 &nbsp; 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 6: &nbsp; &nbsp;end of track (last sector in track)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 7: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 8: &nbsp; &nbsp;data length (if cmd byte 5==0)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Write Data &nbsp; &nbsp; &nbsp; &nbsp; D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp;MT &nbsp;MF &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 0 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 6: &nbsp; &nbsp;end of track (last sector in track)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 7: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 8: &nbsp; &nbsp;data length (if cmd byte 5==0)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Write Deleted Data D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp;MT &nbsp;MF &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 0 &nbsp; 0 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 6: &nbsp; &nbsp;end of track (last sector in track)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 7: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 8: &nbsp; &nbsp;data length (if cmd byte 5==0)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Read a Track &nbsp; &nbsp; &nbsp; D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;(Diagnostic)</span><br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; 0 &nbsp;MF &nbsp;SK &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 6: &nbsp; &nbsp;end of track (last sector in track)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 7: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 8: &nbsp; &nbsp;data length (if cmd byte 5==0)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Read ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; 0 &nbsp;MF &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 0 &nbsp; 1 &nbsp; 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Format a Track &nbsp; &nbsp; D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;(Write Sector IDs)</span><br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; 0 &nbsp;MF &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 1 &nbsp; 0 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;sectors per track<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;filler pattern to write in each byte<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Scan Equal &nbsp; &nbsp; &nbsp; &nbsp; D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp;MT &nbsp;MF &nbsp;SK &nbsp; 1 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 6: &nbsp; &nbsp;end of track (last sector in track)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 7: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 8: &nbsp; &nbsp;scan test (1=scan contiguous, 2=scan alternate)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Scan Low or Equal &nbsp;D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp;MT &nbsp;MF &nbsp;SK &nbsp; 1 &nbsp; 1 &nbsp; 0 &nbsp; 0 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 6: &nbsp; &nbsp;end of track (last sector in track)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 7: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 8: &nbsp; &nbsp;scan test (1=scan contiguous, 2=scan alternate)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Scan High or Equal D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp;MT &nbsp;MF &nbsp;SK &nbsp; 1 &nbsp; 1 &nbsp; 1 &nbsp; 0 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 3: &nbsp; &nbsp;head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 4: &nbsp; &nbsp;sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 5: &nbsp; &nbsp;bytes per sector<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 6: &nbsp; &nbsp;end of track (last sector in track)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 7: &nbsp; &nbsp;gap 3 length<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 8: &nbsp; &nbsp;scan test (1=scan contiguous, 2=scan alternate)<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; status register 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 2: &nbsp; &nbsp; status register 2<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 3: &nbsp; &nbsp; cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 4: &nbsp; &nbsp; head number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 5: &nbsp; &nbsp; sector number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 6: &nbsp; &nbsp; bytes per sector<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Recalibrate &nbsp; &nbsp; &nbsp; &nbsp;D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 1 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; 0 &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;returns nothing<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Sense Interrupt &nbsp; &nbsp;D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Status</span><br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 0 &nbsp; 0 &nbsp; 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 1: &nbsp; &nbsp; present cylinder number<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Specify Step &amp; &nbsp; &nbsp; D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Head Load</span><br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp;step rate time &#9474; head unload time<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;head load time&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; &nbsp; ND<br />
 &nbsp; &nbsp; &nbsp; &nbsp;returns nothing<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Sense Drive &nbsp; &nbsp; &nbsp; &nbsp;D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Status</span><br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 0 &nbsp; 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 3<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Seek &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 1 &nbsp; 1 &nbsp; 1 &nbsp; 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 1: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; ? &nbsp;HD &nbsp;US1 US0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 2: &nbsp; &nbsp;new cylinder number<br />
 &nbsp; &nbsp; &nbsp; &nbsp;returns nothing<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;&#956;PD765 Version &nbsp; &nbsp; D7 &nbsp;D6 &nbsp;D5 &nbsp;D4 &nbsp;D3 &nbsp;D2 &nbsp;D1 &nbsp;D0</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;command byte 0: &nbsp; &nbsp; ? &nbsp; ? &nbsp; ? &nbsp; 1 &nbsp; 0 &nbsp; 0 &nbsp; 0 &nbsp; 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 90h = &#956;PD765B; &nbsp;80h = &#956;PD765A or &#956;PD765A-2<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Invalid Command</span><br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;result byte 0: &nbsp; &nbsp; status register 0 (value of 80h)<br />
<br />
<br />
<span class="highlight"> &nbsp; &nbsp; &nbsp; &nbsp;Key to Abbreviations</span><br />
 &nbsp; &nbsp; &nbsp; &nbsp;HD = Head Number Selected &nbsp; &nbsp; &nbsp; SK = SKip Deleted-data address mark<br />
 &nbsp; &nbsp; &nbsp; &nbsp;MT = Multi-Track &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;US0 = drive select bit 0<br />
 &nbsp; &nbsp; &nbsp; &nbsp;MF = MFM mode &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; US1 = drive select bit 1<br />
 &nbsp; &nbsp; &nbsp; &nbsp;ND = Non-DMA mode<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;Head Load Time = 2 to 254ms in 2ms increments<br />
 &nbsp; &nbsp; &nbsp; &nbsp;Head Unload Time = 16 to 240ms in 16ms increments<br />
 &nbsp; &nbsp; &nbsp; &nbsp;Step Rate Time = 1 to 16ms in 1ms increments<br />
<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- PS/2 systems use the 8272A diskette controller which is software<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and port compatible with the NEC &#956;PD765<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- accessed through ports 3F0h-3F7h; &nbsp;NEC &#956;PD765 is accessed through<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ports 3F2h, 3F4h and 3F5h; &nbsp; the 8272A uses ports 3F0h, 3F1h,<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3F2h, 3F4h, 3F5h and 3F7h<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- data, command and status registers are all accessed through<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;port 3F5h a register stack with one address presented to the bus<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- bit 7 of BIOS Data Area byte 40:3E can be polled to determine<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if a disk operation has completed; &nbsp;this bit is set by the<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;interrupt handler when the operation has completed; &nbsp;it should<br />
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;be reset before continuing on with the next FDC operation<br />
<br />
 &nbsp; &nbsp; &nbsp; &nbsp;- see &nbsp;<a href="table-BIOS_Data_Area.html">BIOS Data Area</a> &nbsp; <a href="int-int_table.html">INT TABLE</a>&nbsp; &nbsp;<a href="int-int_13.html">INT 13</a><br />
<br />
          </td>
        </tr>
      </table>
    </td>
  </tr>

  <tr class="bottom">
    <td class="unimono" style="text-align: left; width: 30%">Esc or Alt-X to exit</td>
    <td class="unimono" style="text-align: center; width: 40%">765</td>
    <td class="unimono" style="text-align: right; width: 30%">Home/PgUp/PgDn/End &#8592;&#8593;&#8595;&#8594;</td>
  </tr>
</table>
<div class="converter"><a href="http://idlebox.net/2006/helppc21/">Converted to HTML in 2006 by Timo Bingmann</a></div>
</body>
</html>