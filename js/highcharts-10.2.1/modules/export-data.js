(function(b){"object"===typeof module&&module.exports?(b["default"]=b,module.exports=b):"function"===typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(a){b(a);b.Highcharts=a;return b}):b("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(b){function c(d,g,h,f){d.hasOwnProperty(g)||(d[g]=f.apply(null,h),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:g,module:d[g]}})))}b=b?b._modules:{};c(b,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}});c(b,"Extensions/DownloadURL.js",[b["Core/Globals.js"]],function(d){var g=d.isSafari,j=d.win,f=j.document,i=j.URL||j.webkitURL||j,h=d.dataURLtoBlob=function(e){if((e=e.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<e.length&&j.atob&&j.ArrayBuffer&&j.Uint8Array&&j.Blob&&i.createObjectURL){var n=j.atob(e[3]),m=new j.ArrayBuffer(n.length);m=new j.Uint8Array(m);for(var l=0;l<m.length;++l){m[l]=n.charCodeAt(l)}e=new j.Blob([m],{type:e[1]});return i.createObjectURL(e)}};d=d.downloadURL=function(e,s){var m=j.navigator,l=f.createElement("a");if("string"===typeof e||e instanceof String||!m.msSaveOrOpenBlob){e="".concat(e);m=/Edge\/\d+/.test(m.userAgent);if(g&&"string"===typeof e&&0===e.indexOf("data:application/pdf")||m||2000000<e.length){if(e=h(e)||"",!e){throw Error("Failed to convert to blob")}}if("undefined"!==typeof l.download){l.href=e,l.download=s,f.body.appendChild(l),l.click(),f.body.removeChild(l)}else{try{var o=j.open(e,"chart");if("undefined"===typeof o||null===o){throw Error("Failed to open window")}}catch(r){j.location.href=e}}}else{m.msSaveOrOpenBlob(e,s)}};return{dataURLtoBlob:h,downloadURL:d}});c(b,"Extensions/ExportData/ExportData.js",[b["Core/Renderer/HTML/AST.js"],b["Extensions/ExportData/ExportDataDefaults.js"],b["Core/Globals.js"],b["Core/DefaultOptions.js"],b["Extensions/DownloadURL.js"],b["Core/Series/SeriesRegistry.js"],b["Core/Utilities.js"]],function(at,an,ar,ak,m,z,am){function aq(){var a=this.getCSV(!0);u(t(a,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(a),this.getFilename()+".csv")}function al(){var a='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";u(t(a,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+aj.btoa(unescape(encodeURIComponent(a))),this.getFilename()+".xls")}function ap(k){var l="",q=this.getDataRows(),p=this.options.exporting.csv,e=ai(p.decimalPoint,","!==p.itemDelimiter&&k?(1.1).toLocaleString()[1]:"."),n=ai(p.itemDelimiter,","===e?";":","),v=p.lineDelimiter;q.forEach(function(a,C){for(var w,x=a.length;x--;){w=a[x],"string"===typeof w&&(w='"'+w+'"'),"number"===typeof w&&"."!==e&&(w=w.toString().replace(".",e)),a[x]=w}a.length=q.length?q[0].length:0;l+=a.join(n);C<q.length-1&&(l+=v)});return l}function ac(W){var Y=this.hasParallelCoordinates,U=this.time,S=this.options.exporting&&this.options.exporting.csv||{},V=this.xAxis,R={},F=[],M=[],E=[],P=this.options.lang.exportData,N=P.categoryHeader,L=P.categoryDatetimeHeader,K=function(k,n,l){if(S.columnHeaderFormatter){var e=S.columnHeaderFormatter(k,n,l);if(!1!==e){return e}}return k?k instanceof j?W?{columnTitle:1<l?n:k.name,topLevelColumnTitle:k.name}:k.name+(1<l?" ("+n+")":""):k.options.title&&k.options.title.text||(k.dateTime?L:N):N},w=function(l,k,p){var e={},n={};k.forEach(function(a){var q=(l.keyToAxis&&l.keyToAxis[a]||a)+"Axis";q=i(p)?l.chart[q][p]:l[q];e[a]=q&&q.categories||[];n[a]=q&&q.dateTime});return{categoryMap:e,dateTimeValueAxisMap:n}},v=function(k,e){return k.data.filter(function(l){return"undefined"!==typeof l.y&&l.name}).length&&e&&!e.categories&&!k.keyToAxis?k.pointArrayMap&&k.pointArrayMap.filter(function(l){return"x"===l}).length?(k.pointArrayMap.unshift("x"),k.pointArrayMap):["x","y"]:k.pointArrayMap||["y"]},O=[],G,D=0;this.series.forEach(function(q){var a=q.xAxis,aa=q.options.keys||v(q,a),n=aa.length,aw=!q.requireSorting&&{},ax=V.indexOf(a),Z=w(q,aa),av;if(!1!==q.options.includeInDataExport&&!q.options.isInternal&&!1!==q.visible){h(O,function(e){return e[0]===ax})||O.push([ax,D]);for(av=0;av<n;){G=K(q,aa[av],aa.length),E.push(G.columnTitle||G),W&&M.push(G.topLevelColumnTitle||G),av++}var k={chart:q.chart,autoIncrement:q.autoIncrement,options:q.options,pointArrayMap:q.pointArrayMap};q.options.data.forEach(function(e,ay){var p={series:k};Y&&(Z=w(q,aa,ay));q.pointClass.prototype.applyOptions.apply(p,[e]);e=p.x;var l=q.data[ay]&&q.data[ay].name;av=0;if(!a||"name"===q.exportKey||!Y&&a&&a.hasNames&&l){e=l}aw&&(aw[e]&&(e+="|"+ay),aw[e]=!0);R[e]||(R[e]=[],R[e].xValues=[]);R[e].x=p.x;R[e].name=l;for(R[e].xValues[ax]=p.x;av<n;){ay=aa[av],l=p[ay],R[e][D+av]=ai(Z.categoryMap[ay][l],Z.dateTimeValueAxisMap[ay]?U.dateFormat(S.dateFormat,l):null,l),av++}});D+=av}});for(T in R){Object.hasOwnProperty.call(R,T)&&F.push(R[T])}P=W?[M,E]:[E];for(D=O.length;D--;){var x=O[D][0];var C=O[D][1];var H=V[x];F.sort(function(k,e){return k.xValues[x]-e.xValues[x]});var T=K(H);P[0].splice(C,0,T);W&&P[1]&&P[1].splice(C,0,T);F.forEach(function(k){var e=k.name;H&&!g(e)&&(H.dateTime?(k.x instanceof Date&&(k.x=k.x.getTime()),e=U.dateFormat(S.dateFormat,k.x)):e=H.categories?ai(H.names[k.x],H.categories[k.x],k.x):k.x);k.splice(C,0,e)})}P=P.concat(F);B(this,"exportData",{dataRows:P});return P}function y(k){var e=function(l){if(!l.tagName||"#text"===l.tagName){return l.textContent||""}var n=l.attributes,p="<".concat(l.tagName);n&&Object.keys(n).forEach(function(v){var q=n[v];p+=" ".concat(v,'="').concat(q,'"')});p+=">";p+=l.textContent||"";(l.children||[]).forEach(function(q){p+=e(q)});return p+="</".concat(l.tagName,">")};k=this.getTableAST(k);return e(k)}function ad(M){var L=0,K=[],G=this.options,H=M?(1.1).toLocaleString()[1]:".",F=ai(G.exporting.useMultiLevelHeaders,!0);M=this.getDataRows(F);var D=F?M.shift():null,C=M.shift(),x=function(k,e,p,n){var l=ai(n,"");e="highcharts-text"+(e?" "+e:"");"number"===typeof l?(l=l.toString(),","===H&&(l=l.replace(".",H)),e="highcharts-number"):n||(e="highcharts-empty");p=s({"class":e},p);return{tagName:k,attributes:p,textContent:l}};!1!==G.exporting.tableCaption&&K.push({tagName:"caption",attributes:{"class":"highcharts-table-caption"},textContent:ai(G.exporting.tableCaption,G.title.text?G.title.text:"Chart")});for(var E=0,w=M.length;E<w;++E){M[E].length>L&&(L=M[E].length)}K.push(function(T,S,R){var N=[],O=0;R=R||S&&S.length;var q=0,P;if(P=F&&T&&S){T:if(P=T.length,S.length===P){for(;P--;){if(T[P]!==S[P]){P=!1;break T}}P=!0}else{P=!1}P=!P}if(P){for(P=[];O<R;++O){var n=T[O];var p=T[O+1];n===p?++q:q?(P.push(x("th","highcharts-table-topheading",{scope:"col",colspan:q+1},n)),q=0):(n===S[O]?G.exporting.useRowspanHeaders?(p=2,delete S[O]):(p=1,S[O]=""):p=1,n=x("th","highcharts-table-topheading",{scope:"col"},n),1<p&&n.attributes&&(n.attributes.valign="top",n.attributes.rowspan=p),P.push(n))}N.push({tagName:"tr",children:P})}if(S){P=[];O=0;for(R=S.length;O<R;++O){"undefined"!==typeof S[O]&&P.push(x("th",null,{scope:"col"},S[O]))}N.push({tagName:"tr",children:P})}return{tagName:"thead",children:N}}(D,C,Math.max(L,C.length)));var v=[];M.forEach(function(e){for(var l=[],k=0;k<L;k++){l.push(x(k?"td":"th",null,k?{}:{scope:"row"},e[k]))}v.push({tagName:"tr",children:l})});K.push({tagName:"tbody",children:v});K={tree:{tagName:"table",id:"highcharts-data-table-".concat(this.index),children:K}};B(this,"aftergetTableAST",K);return K.tree}function au(){this.toggleDataTable(!1)}function af(a){(a=ai(a,!this.isDataTableVisible))&&!this.dataTableDiv&&(this.dataTableDiv=ae.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling));this.dataTableDiv&&(this.dataTableDiv.style.display=a?"block":"none",a&&(this.dataTableDiv.innerHTML=at.emptyHTML,(new at([this.getTableAST()])).addToDOM(this.dataTableDiv),B(this,"afterViewData",this.dataTableDiv)));this.isDataTableVisible=a;var l=this.exportDivElements,k=this.options.exporting,e=k&&k.buttons&&k.buttons.contextButton.menuItems;a=this.options.lang;k&&k.menuItemDefinitions&&a&&a.viewData&&a.hideData&&e&&l&&(l=l[e.indexOf("viewData")])&&at.setElementHTML(l,this.isDataTableVisible?a.hideData:a.viewData)}function d(){this.toggleDataTable(!0)}function t(l,w){var k=aj.navigator,q=-1<k.userAgent.indexOf("WebKit")&&0>k.userAgent.indexOf("Chrome"),v=aj.URL||aj.webkitURL||aj;try{if(k.msSaveOrOpenBlob&&aj.MSBlobBuilder){var p=new aj.MSBlobBuilder;p.append(l);return p.getBlob("image/svg+xml")}if(!q){return v.createObjectURL(new aj.Blob(["\ufeff"+l],{type:w}))}}catch(n){}}function ag(){var e=this,n=e.dataTableDiv,l=document.querySelectorAll("thead")[0].querySelectorAll("tr")[0],k=function(q,p){return function(w,v){var a=(p?w:v).children[q].textContent;w=(p?v:w).children[q].textContent;return""===a||""===w||isNaN(a)||isNaN(w)?a.toString().localeCompare(w):a-w}};n&&l.childNodes.forEach(function(a){var p=a.closest("table");a.addEventListener("click",function(){var v=r([],n.querySelectorAll("tr:not(thead tr)"),!0),q=r([],a.parentNode.children,!0);v.sort(k(q.indexOf(a),e.ascendingOrderInTable=!e.ascendingOrderInTable)).forEach(function(w){p.appendChild(w)});q.forEach(function(w){["highcharts-sort-ascending","highcharts-sort-descending"].forEach(function(x){w.classList.contains(x)&&w.classList.remove(x)})});a.classList.add(e.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}function f(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}var r=this&&this.__spreadArray||function(l,v,q){if(q||2===arguments.length){for(var k=0,p=v.length,n;k<p;k++){!n&&k in v||(n||(n=Array.prototype.slice.call(v,0,k)),n[k]=v[k])}}return l.concat(n||Array.prototype.slice.call(v))},ae=ar.doc,aj=ar.win,ah=ak.getOptions,A=ak.setOptions,u=m.downloadURL,j=z.series;ar=z.seriesTypes;var ab=ar.arearange,X=ar.gantt,Q=ar.map,J=ar.mapbubble,I=ar.treemap,o=am.addEvent,g=am.defined,s=am.extend,h=am.find,B=am.fireEvent,i=am.isNumber,ai=am.pick,ao=[];"";return{compose:function(e){-1===ao.indexOf(e)&&(ao.push(e),o(e,"afterViewData",ag),o(e,"render",f),e=e.prototype,e.downloadCSV=aq,e.downloadXLS=al,e.getCSV=ap,e.getDataRows=ac,e.getTable=y,e.getTableAST=ad,e.hideData=au,e.toggleDataTable=af,e.viewData=d);if(-1===ao.indexOf(A)){ao.push(A);if(e=ah().exporting){s(e.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),e.buttons&&e.buttons.contextButton.menuItems&&e.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")}A(an)}ab&&-1===ao.indexOf(ab)&&(ao.push(ab),ab.prototype.keyToAxis={low:"y",high:"y"});X&&-1===ao.indexOf(X)&&(ao.push(X),X.prototype.keyToAxis={start:"x",end:"x"});Q&&-1===ao.indexOf(Q)&&(ao.push(Q),Q.prototype.exportKey="name");J&&-1===ao.indexOf(J)&&(ao.push(J),J.prototype.exportKey="name");I&&-1===ao.indexOf(I)&&(ao.push(I),I.prototype.exportKey="name")}}});c(b,"masters/modules/export-data.src.js",[b["Core/Globals.js"],b["Extensions/ExportData/ExportData.js"]],function(d,f){f.compose(d.Chart)})});