(function(b){var a=b.each,c=function(d){this.init(d)};b.extend(c.prototype,{init:function(d){this.options=d;this.columns=d.columns||this.rowsToColumns(d.rows)||[];this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},dataFound:function(){this.parseTypes();this.findHeaderRow();this.parsed();this.complete()},parseCSV:function(){var r=this,p=this.options,o=p.csv,n=this.columns,m=p.startRow||0,k=p.endRow||Number.MAX_VALUE,j=p.startColumn||0,i=p.endColumn||Number.MAX_VALUE,f=0;o&&(o=o.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(p.lineDelimiter||"\n"),a(o,function(h,d){var g=r.trim(h),e=g.indexOf("#")===0;d>=m&&d<=k&&!e&&g!==""&&(g=h.split(p.itemDelimiter||","),a(g,function(l,q){q>=j&&q<=i&&(n[q-j]||(n[q-j]=[]),n[q-j][f]=l)}),f+=1)}),this.dataFound())},parseTable:function(){var j=this.options,f=j.table,p=this.columns,o=j.startRow||0,n=j.endRow||Number.MAX_VALUE,m=j.startColumn||0,k=j.endColumn||Number.MAX_VALUE,i;f&&(typeof f==="string"&&(f=document.getElementById(f)),a(f.getElementsByTagName("tr"),function(e,d){i=0;d>=o&&d<=n&&a(e.childNodes,function(g){if((g.tagName==="TD"||g.tagName==="TH")&&i>=m&&i<=k){p[i]||(p[i]=[]),p[i][d-o]=g.innerHTML,i+=1}})}),this.dataFound())},parseGoogleSpreadsheet:function(){var t=this,s=this.options,r=s.googleSpreadsheetKey,q=this.columns,p=s.startRow||0,n=s.endRow||Number.MAX_VALUE,m=s.startColumn||0,i=s.endColumn||Number.MAX_VALUE,o,k;r&&jQuery.getJSON("https://spreadsheets.google.com/feeds/cells/"+r+"/"+(s.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",function(d){var d=d.feed.entry,j,e=d.length,h=0,g=0,f;for(f=0;f<e;f++){j=d[f],h=Math.max(h,j.gs$cell.col),g=Math.max(g,j.gs$cell.row)}for(f=0;f<h;f++){if(f>=m&&f<=i){q[f-m]=[],q[f-m].length=Math.min(g,n-p)}}for(f=0;f<e;f++){if(j=d[f],o=j.gs$cell.row-1,k=j.gs$cell.col-1,k>=m&&k<=i&&o>=p&&o<=n){q[k-m][o-p]=j.content.$t}}t.dataFound()})},findHeaderRow:function(){a(this.columns,function(){});this.headerRow=0},trim:function(d){return typeof d==="string"?d.replace(/^\s+|\s+$/g,""):d},parseTypes:function(){for(var h=this.columns,f=h.length,l,k,j,i;f--;){for(l=h[f].length;l--;){k=h[f][l],j=parseFloat(k),i=this.trim(k),i==j?(h[f][l]=j,j>31536000000?h[f].isDatetime=!0:h[f].isNumeric=!0):(k=this.parseDate(k),f===0&&typeof k==="number"&&!isNaN(k)?(h[f][l]=k,h[f].isDatetime=!0):h[f][l]=i===""?null:i)}}},dateFormats:{"YYYY-mm-dd":{regex:"^([0-9]{4})-([0-9]{2})-([0-9]{2})$",parser:function(d){return Date.UTC(+d[1],d[2]-1,+d[3])}}},parseDate:function(g){var f=this.options.parseDate,j,i,h;f&&(j=f(g));if(typeof g==="string"){for(i in this.dateFormats){f=this.dateFormats[i],(h=g.match(f.regex))&&(j=f.parser(h))}}return j},rowsToColumns:function(h){var f,l,k,j,i;if(h){i=[];l=h.length;for(f=0;f<l;f++){j=h[f].length;for(k=0;k<j;k++){i[k]||(i[k]=[]),i[k][f]=h[f][k]}}}return i},parsed:function(){this.options.parsed&&this.options.parsed.call(this,this.columns)},complete:function(){var v=this.columns,u,t,s,r,p=this.options,o,q,l,n,i;if(p.complete){v.length>1&&(s=v.shift(),this.headerRow===0&&s.shift(),(u=s.isNumeric||s.isDatetime)||(t=s),s.isDatetime&&(r="datetime"));o=[];for(n=0;n<v.length;n++){this.headerRow===0&&(l=v[n].shift());q=[];for(i=0;i<v[n].length;i++){q[i]=v[n][i]!==void 0?u?[s[i],v[n][i]]:v[n][i]:null}o[n]={name:l,data:q}}p.complete({xAxis:{categories:t,type:r},series:o})}}});b.Data=c;b.data=function(d){return new c(d)};b.wrap(b.Chart.prototype,"init",function(f,e,h){var g=this;e&&e.data?b.data(b.extend(e.data,{complete:function(d){e.series&&a(e.series,function(i,j){e.series[j]=b.merge(i,d.series[j])});e=b.merge(d,e);f.call(g,e,h)}})):f.call(g,e,h)})})(Highcharts);