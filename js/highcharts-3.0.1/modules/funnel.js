(function(a){var f=a.getOptions().plotOptions,b=a.seriesTypes,c=a.merge,e=function(){},d=a.each;f.funnel=c(f.pie,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:!0,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}}});b.funnel=a.extendClass(b.pie,{type:"funnel",animate:e,translate:function(){var X=function(h,g){return/%$/.test(h)?g*parseInt(h,10)/100:parseInt(h,10)},S=0,U=this.chart,T=U.plotWidth,U=U.plotHeight,R=0,V=this.options,P=V.center,W=X(P[0],T),P=X(P[0],U),N=X(V.width,T),Q,G,M=X(V.height,U),F=X(V.neckWidth,T),D=X(V.neckHeight,U),C=M-D,X=this.data,B,z,H=V.dataLabels.position==="left"?1:0,i,L,J,K,O,E,I;this.getWidthAt=G=function(g){return g>M-D?F:F+(N-F)*((M-D-g)/(M-D))};this.getX=function(h,g){return W+(g?-1:1)*(G(h)/2+V.dataLabels.distance)};this.center=[W,P,M];this.centerX=W;d(X,function(g){S+=g.y});d(X,function(g){I=null;z=S?g.y/S:0;L=R*M;O=L+z*M;Q=G(L);i=W-Q/2;J=i+Q;Q=G(O);K=W-Q/2;E=K+Q;L>C?(i=K=W-F/2,J=E=W+F/2):O>C&&(I=O,Q=G(C),K=W-Q/2,E=K+Q,O=C);B=["M",i,L,"L",J,L,E,O];I&&B.push(E,I,K,I);B.push(K,O,"Z");g.shapeType="path";g.shapeArgs={d:B};g.percentage=z*100;g.plotX=W;g.plotY=(L+(I||O))/2;g.tooltipPos=[W,g.plotY];g.slice=e;g.half=H;R+=z});this.setTooltipPoints()},drawPoints:function(){var g=this,h=g.options,i=g.chart.renderer;d(g.data,function(k){var j=k.graphic,l=k.shapeArgs;j?j.animate(l):k.graphic=i.path(l).attr({fill:k.color,stroke:h.borderColor,"stroke-width":h.borderWidth}).add(g.group)})},drawDataLabels:function(){var i=this.data,m=this.options.dataLabels.distance,o,n,l,p=i.length,k,h;for(this.center[2]-=2*m;p--;){l=i[p],n=(o=l.half)?1:-1,h=l.plotY,k=this.getX(h,o),l.labelPos=[0,h,k+(m-5)*n,h,k+m*n,h,o?"right":"left",0]}b.pie.prototype.drawDataLabels.call(this)}})})(Highcharts);