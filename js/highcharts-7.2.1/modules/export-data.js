(function(a){"object"===typeof module&&module.exports?(a["default"]=a,module.exports=a):"function"===typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(b){a(b);a.Highcharts=b;return a}):a("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(b){function a(d,e,g,f){d.hasOwnProperty(e)||(d[e]=f.apply(null,g))}b=b?b._modules:{};a(b,"mixins/ajax.js",[b["parts/Globals.js"],b["parts/Utilities.js"]],function(d,e){var f=e.objectEach;d.ajax=function(c){var g=d.merge(!0,{url:!1,type:"get",dataType:"json",success:!1,error:!1,data:!1,headers:{}},c);c={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"};var i=new XMLHttpRequest;if(!g.url){return !1}i.open(g.type.toUpperCase(),g.url,!0);g.headers["Content-Type"]||i.setRequestHeader("Content-Type",c[g.dataType]||c.text);f(g.headers,function(k,h){i.setRequestHeader(h,k)});i.onreadystatechange=function(){if(4===i.readyState){if(200===i.status){var h=i.responseText;if("json"===g.dataType){try{h=JSON.parse(h)}catch(k){g.error&&g.error(i,k);return}}return g.success&&g.success(h)}g.error&&g.error(i,i.responseText)}};try{g.data=JSON.stringify(g.data)}catch(j){}i.send(g.data||!0)};d.getJSON=function(g,h){d.ajax({url:g,success:h,dataType:"json",headers:{"Content-Type":"text/plain"}})}});a(b,"mixins/download-url.js",[b["parts/Globals.js"]],function(d){var e=d.win,k=e.navigator,j=e.document,g=e.URL||e.webkitURL||e,i=/Edge\/\d+/.test(k.userAgent);d.dataURLtoBlob=function(f){if((f=f.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<f.length&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&e.Blob&&g.createObjectURL){var m=e.atob(f[3]),h=new e.ArrayBuffer(m.length);h=new e.Uint8Array(h);for(var l=0;l<h.length;++l){h[l]=m.charCodeAt(l)}f=new e.Blob([h],{type:f[1]});return g.createObjectURL(f)}};d.downloadURL=function(m,f){var l=j.createElement("a");if("string"===typeof m||m instanceof String||!k.msSaveOrOpenBlob){if(i||2000000<m.length){if(m=d.dataURLtoBlob(m),!m){throw Error("Failed to convert to blob")}}if(void 0!==l.download){l.href=m,l.download=f,j.body.appendChild(l),l.click(),j.body.removeChild(l)}else{try{var n=e.open(m,"chart");if(void 0===n||null===n){throw Error("Failed to open window")}}catch(c){e.location.href=m}}}else{k.msSaveOrOpenBlob(m,f)}}});a(b,"modules/export-data.src.js",[b["parts/Globals.js"],b["parts/Utilities.js"]],function(u,v){function t(d,n){var x=l.navigator,h=-1<x.userAgent.indexOf("WebKit")&&0>x.userAgent.indexOf("Chrome"),f=l.URL||l.webkitURL||l;try{if(x.msSaveOrOpenBlob&&l.MSBlobBuilder){var q=new l.MSBlobBuilder;q.append(d);return q.getBlob("image/svg+xml")}if(!h){return f.createObjectURL(new l.Blob(["\ufeff"+d],{type:n}))}}catch(p){}}var i=v.defined,m=v.extend,o=v.isObject,r=v.pick,l=u.win,j=l.document,s=u.seriesTypes,k=u.downloadURL,g=u.fireEvent;u.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",openInCloud:"Open in Highcharts Cloud",viewData:"View data table"}});u.addEvent(u.Chart,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()});u.Chart.prototype.setUpKeyToAxis=function(){s.arearange&&(s.arearange.prototype.keyToAxis={low:"y",high:"y"});s.gantt&&(s.gantt.prototype.keyToAxis={start:"x",end:"x"})};u.Chart.prototype.getDataRows=function(S){var R=this.hasParallelCoordinates,N=this.time,B=this.options.exporting&&this.options.exporting.csv||{},M=this.xAxis,Q={},P=[],K=[],L=[],q,e=function(f,p,h){if(B.columnHeaderFormatter){var n=B.columnHeaderFormatter(f,p,h);if(!1!==n){return n}}return f?f instanceof u.Axis?f.options.title&&f.options.title.text||(f.isDatetimeAxis?"DateTime":"Category"):S?{columnTitle:1<h?p:f.name,topLevelColumnTitle:f.name}:f.name+(1<h?" ("+p+")":""):"Category"},I=function(f,w,n){var h={},p={};w.forEach(function(x){var d=(f.keyToAxis&&f.keyToAxis[x]||x)+"Axis";d=u.isNumber(n)?f.chart[d][n]:f[d];h[x]=d&&d.categories||[];p[x]=d&&d.isDatetimeAxis});return{categoryMap:h,dateTimeValueAxisMap:p}},O=[];var F=0;this.setUpKeyToAxis();this.series.forEach(function(h){var n=h.options.keys||h.pointArrayMap||["y"],p=n.length,d=!h.requireSorting&&{},x=M.indexOf(h.xAxis),y=I(h,n),c;if(!1!==h.options.includeInDataExport&&!h.options.isInternal&&!1!==h.visible){u.find(O,function(f){return f[0]===x})||O.push([x,F]);for(c=0;c<p;){q=e(h,n[c],n.length),L.push(q.columnTitle||q),S&&K.push(q.topLevelColumnTitle||q),c++}var w={chart:h.chart,autoIncrement:h.autoIncrement,options:h.options,pointArrayMap:h.pointArrayMap};h.options.data.forEach(function(D,f){R&&(y=I(h,n,f));var E={series:w};h.pointClass.prototype.applyOptions.apply(E,[D]);D=E.x;var z=h.data[f]&&h.data[f].name;c=0;h.xAxis&&"name"!==h.exportKey||(D=z);d&&(d[D]&&(D+="|"+f),d[D]=!0);Q[D]||(Q[D]=[],Q[D].xValues=[]);Q[D].x=E.x;Q[D].name=z;for(Q[D].xValues[x]=E.x;c<p;){f=n[c],z=E[f],Q[D][F+c]=r(y.categoryMap[f][z],y.dateTimeValueAxisMap[f]?N.dateFormat(B.dateFormat,z):null,z),c++}});F+=c}});for(J in Q){Object.hasOwnProperty.call(Q,J)&&P.push(Q[J])}var J=S?[K,L]:[L];for(F=O.length;F--;){var H=O[F][0];var C=O[F][1];var A=M[H];P.sort(function(d,c){return d.xValues[H]-c.xValues[H]});var G=e(A);J[0].splice(C,0,G);S&&J[1]&&J[1].splice(C,0,G);P.forEach(function(d){var c=d.name;A&&!i(c)&&(A.isDatetimeAxis?(d.x instanceof Date&&(d.x=d.x.getTime()),c=N.dateFormat(B.dateFormat,d.x)):c=A.categories?r(A.names[d.x],A.categories[d.x],d.x):d.x);d.splice(C,0,c)})}J=J.concat(P);g(this,"exportData",{dataRows:J});return J};u.Chart.prototype.getCSV=function(p){var e="",y=this.getDataRows(),x=this.options.exporting.csv,n=r(x.decimalPoint,","!==x.itemDelimiter&&p?(1.1).toLocaleString()[1]:"."),q=r(x.itemDelimiter,","===n?";":","),w=x.lineDelimiter;y.forEach(function(f,z){for(var h,c=f.length;c--;){h=f[c],"string"===typeof h&&(h='"'+h+'"'),"number"===typeof h&&"."!==n&&(h=h.toString().replace(".",n)),f[c]=h}e+=f.join(q);z<y.length-1&&(e+=w)});return e};u.Chart.prototype.getTable=function(G){var F='<table id="highcharts-data-table-'+this.index+'">',E=this.options,C=G?(1.1).toLocaleString()[1]:".",A=r(E.exporting.useMultiLevelHeaders,!0);G=this.getDataRows(A);var B=0,y=A?G.shift():null,e=G.shift(),x=function(f,d,q,n){var p=r(n,"");d="text"+(d?" "+d:"");"number"===typeof p?(p=p.toString(),","===C&&(p=p.replace(".",C)),d="number"):n||(d="empty");return"<"+f+(q?" "+q:"")+' class="'+d+'">'+p+"</"+f+">"};!1!==E.exporting.tableCaption&&(F+='<caption class="highcharts-table-caption">'+r(E.exporting.tableCaption,E.title.text?E.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var w=0,D=G.length;w<D;++w){G[w].length>B&&(B=G[w].length)}F+=function(p,h,H){var I="<thead>",z=0;H=H||h&&h.length;var q,n=0;if(q=A&&p&&h){p:if(q=p.length,h.length===q){for(;q--;){if(p[q]!==h[q]){q=!1;break p}}q=!0}else{q=!1}q=!q}if(q){for(I+="<tr>";z<H;++z){q=p[z];var c=p[z+1];q===c?++n:n?(I+=x("th","highcharts-table-topheading",'scope="col" colspan="'+(n+1)+'"',q),n=0):(q===h[z]?E.exporting.useRowspanHeaders?(c=2,delete h[z]):(c=1,h[z]=""):c=1,I+=x("th","highcharts-table-topheading",'scope="col"'+(1<c?' valign="top" rowspan="'+c+'"':""),q))}I+="</tr>"}if(h){I+="<tr>";z=0;for(H=h.length;z<H;++z){void 0!==h[z]&&(I+=x("th",null,'scope="col"',h[z]))}I+="</tr>"}return I+"</thead>"}(y,e,Math.max(B,e.length));F+="<tbody>";G.forEach(function(d){F+="<tr>";for(var f=0;f<B;f++){F+=x(f?"td":"th",null,f?"":'scope="row"',d[f])}F+="</tr>"});F+="</tbody></table>";G={html:F};g(this,"afterGetTable",G);return G.html};u.Chart.prototype.downloadCSV=function(){var c=this.getCSV(!0);k(t(c,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(c),this.getFilename()+".csv")};u.Chart.prototype.downloadXLS=function(){var c='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";k(t(c,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+l.btoa(unescape(encodeURIComponent(c))),this.getFilename()+".xls")};u.Chart.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=j.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling));this.dataTableDiv.innerHTML=this.getTable();g(this,"afterViewData",this.dataTableDiv)};u.Chart.prototype.openInCloud=function(){function e(c){Object.keys(c).forEach(function(d){"function"===typeof c[d]&&delete c[d];o(c[d])&&e(c[d])})}var h=u.merge(this.userOptions);e(h);h={name:h.title&&h.title.text||"Chart title",options:h,settings:{constructor:"Chart",dataProvider:{csv:this.getCSV()}}};var f=JSON.stringify(h);(function(){var d=j.createElement("form");j.body.appendChild(d);d.method="post";d.action="https://cloud-api.highcharts.com/openincloud";d.target="_blank";var c=j.createElement("input");c.type="hidden";c.name="chart";c.value=f;d.appendChild(c);d.submit();j.body.removeChild(d)})()};if(v=u.getOptions().exporting){m(v.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}},openInCloud:{textKey:"openInCloud",onclick:function(){this.openInCloud()}}}),v.buttons&&v.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData","openInCloud")}s.map&&(s.map.prototype.exportKey="name");s.mapbubble&&(s.mapbubble.prototype.exportKey="name");s.treemap&&(s.treemap.prototype.exportKey="name")});a(b,"masters/modules/export-data.src.js",[],function(){})});