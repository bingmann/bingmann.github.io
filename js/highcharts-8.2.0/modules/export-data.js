(function(b){"object"===typeof module&&module.exports?(b["default"]=b,module.exports=b):"function"===typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(a){b(a);b.Highcharts=a;return b}):b("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(b){function c(f,h,g,i){f.hasOwnProperty(h)||(f[h]=i.apply(null,g))}b=b?b._modules:{};c(b,"Extensions/DownloadURL.js",[b["Core/Globals.js"]],function(f){var l=f.win,k=l.navigator,m=l.document,j=l.URL||l.webkitURL||l,i=/Edge\/\d+/.test(k.userAgent),h=f.dataURLtoBlob=function(g){if((g=g.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<g.length&&l.atob&&l.ArrayBuffer&&l.Uint8Array&&l.Blob&&j.createObjectURL){var d=l.atob(g[3]),o=new l.ArrayBuffer(d.length);o=new l.Uint8Array(o);for(var n=0;n<o.length;++n){o[n]=d.charCodeAt(n)}g=new l.Blob([o],{type:g[1]});return j.createObjectURL(g)}};f=f.downloadURL=function(d,q){var o=m.createElement("a");if("string"===typeof d||d instanceof String||!k.msSaveOrOpenBlob){d=""+d;if(i||2000000<d.length){if(d=h(d)||"",!d){throw Error("Failed to convert to blob")}}if("undefined"!==typeof o.download){o.href=d,o.download=q,m.body.appendChild(o),o.click(),m.body.removeChild(o)}else{try{var e=l.open(d,"chart");if("undefined"===typeof e||null===e){throw Error("Failed to open window")}}catch(n){l.location.href=d}}}else{k.msSaveOrOpenBlob(d,q)}};return{dataURLtoBlob:h,downloadURL:f}});c(b,"Extensions/ExportData.js",[b["Core/Axis/Axis.js"],b["Core/Chart/Chart.js"],b["Core/Globals.js"],b["Core/Utilities.js"],b["Extensions/DownloadURL.js"]],function(G,B,A,C,y){function q(g,u){var e=t.navigator,p=-1<e.userAgent.indexOf("WebKit")&&0>e.userAgent.indexOf("Chrome"),w=t.URL||t.webkitURL||t;try{if(e.msSaveOrOpenBlob&&t.MSBlobBuilder){var n=new t.MSBlobBuilder;n.append(g);return n.getBlob("image/svg+xml")}if(!p){return w.createObjectURL(new t.Blob(["\ufeff"+g],{type:u}))}}catch(v){}}var m=A.doc,z=A.seriesTypes,t=A.win;A=C.addEvent;var k=C.defined,j=C.extend,r=C.find,s=C.fireEvent,i=C.getOptions,h=C.isNumber,l=C.pick;C=C.setOptions;var o=y.downloadURL;C({exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}});A(B,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&!this.dataTableDiv&&this.viewData()});B.prototype.setUpKeyToAxis=function(){z.arearange&&(z.arearange.prototype.keyToAxis={low:"y",high:"y"});z.gantt&&(z.gantt.prototype.keyToAxis={start:"x",end:"x"})};B.prototype.getDataRows=function(Y){var W=this.hasParallelCoordinates,U=this.time,X=this.options.exporting&&this.options.exporting.csv||{},V=this.xAxis,N={},T=[],P=[],Q=[],L;var K=this.options.lang.exportData;var O=K.categoryHeader,D=K.categoryDatetimeHeader,I=function(e,p,n){if(X.columnHeaderFormatter){var g=X.columnHeaderFormatter(e,p,n);if(!1!==g){return g}}return e?e instanceof G?e.options.title&&e.options.title.text||(e.dateTime?D:O):Y?{columnTitle:1<n?p:e.name,topLevelColumnTitle:e.name}:e.name+(1<n?" ("+p+")":""):O},E=function(n,g,e){var u={},p={};g.forEach(function(d){var f=(n.keyToAxis&&n.keyToAxis[d]||d)+"Axis";f=h(e)?n.chart[f][e]:n[f];u[d]=f&&f.categories||[];p[d]=f&&f.dateTime});return{categoryMap:u,dateTimeValueAxisMap:p}},w=function(e,d){return e.data.filter(function(f){return"undefined"!==typeof f.y&&f.name}).length&&d&&!d.categories&&!e.keyToAxis?e.pointArrayMap&&e.pointArrayMap.filter(function(f){return"x"===f}).length?(e.pointArrayMap.unshift("x"),e.pointArrayMap):["x","y"]:e.pointArrayMap||["y"]},S=[];var a=0;this.setUpKeyToAxis();this.series.forEach(function(v){var H=v.xAxis,n=v.options.keys||w(v,H),u=n.length,f=!v.requireSorting&&{},d=V.indexOf(H),e=E(v,n),p;if(!1!==v.options.includeInDataExport&&!v.options.isInternal&&!1!==v.visible){r(S,function(g){return g[0]===d})||S.push([d,a]);for(p=0;p<u;){L=I(v,n[p],n.length),Q.push(L.columnTitle||L),Y&&P.push(L.topLevelColumnTitle||L),p++}var Z={chart:v.chart,autoIncrement:v.autoIncrement,options:v.options,pointArrayMap:v.pointArrayMap};v.options.data.forEach(function(g,aa){W&&(e=E(v,n,aa));var ac={series:Z};v.pointClass.prototype.applyOptions.apply(ac,[g]);g=ac.x;var ab=v.data[aa]&&v.data[aa].name;p=0;if(!H||"name"===v.exportKey||!W&&H&&H.hasNames&&ab){g=ab}f&&(f[g]&&(g+="|"+aa),f[g]=!0);N[g]||(N[g]=[],N[g].xValues=[]);N[g].x=ac.x;N[g].name=ab;for(N[g].xValues[d]=ac.x;p<u;){aa=n[p],ab=ac[aa],N[g][a+p]=l(e.categoryMap[aa][ab],e.dateTimeValueAxisMap[aa]?U.dateFormat(X.dateFormat,ab):null,ab),p++}});a+=p}});for(R in N){Object.hasOwnProperty.call(N,R)&&T.push(N[R])}var R=Y?[P,Q]:[Q];for(a=S.length;a--;){var J=S[a][0];var F=S[a][1];var M=V[J];T.sort(function(e,d){return e.xValues[J]-d.xValues[J]});K=I(M);R[0].splice(F,0,K);Y&&R[1]&&R[1].splice(F,0,K);T.forEach(function(e){var d=e.name;M&&!k(d)&&(M.dateTime?(e.x instanceof Date&&(e.x=e.x.getTime()),d=U.dateFormat(X.dateFormat,e.x)):d=M.categories?l(M.names[e.x],M.categories[e.x],e.x):e.x);e.splice(F,0,d)})}R=R.concat(T);s(this,"exportData",{dataRows:R});return R};B.prototype.getCSV=function(p){var n="",D=this.getDataRows(),E=this.options.exporting.csv,v=l(E.decimalPoint,","!==E.itemDelimiter&&p?(1.1).toLocaleString()[1]:"."),w=l(E.itemDelimiter,","===v?";":","),u=E.lineDelimiter;D.forEach(function(d,g){for(var e,f=d.length;f--;){e=d[f],"string"===typeof e&&(e='"'+e+'"'),"number"===typeof e&&"."!==v&&(e=e.toString().replace(".",v)),d[f]=e}n+=d.join(w);g<D.length-1&&(n+=u)});return n};B.prototype.getTable=function(K){var J='<table id="highcharts-data-table-'+this.index+'">',I=this.options,H=K?(1.1).toLocaleString()[1]:".",E=l(I.exporting.useMultiLevelHeaders,!0);K=this.getDataRows(E);var F=0,D=E?K.shift():null,v=K.shift(),w=function(g,d,M,n){var p=l(n,"");d="text"+(d?" "+d:"");"number"===typeof p?(p=p.toString(),","===H&&(p=p.replace(".",H)),d="number"):n||(d="empty");return"<"+g+(M?" "+M:"")+' class="'+d+'">'+p+"</"+g+">"};!1!==I.exporting.tableCaption&&(J+='<caption class="highcharts-table-caption">'+l(I.exporting.tableCaption,I.title.text?I.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var u=0,L=K.length;u<L;++u){K[u].length>F&&(F=K[u].length)}J+=function(p,n,Q){var P="<thead>",O=0;Q=Q||n&&n.length;var N,M=0;if(N=E&&p&&n){p:if(N=p.length,n.length===N){for(;N--;){if(p[N]!==n[N]){N=!1;break p}}N=!0}else{N=!1}N=!N}if(N){for(P+="<tr>";O<Q;++O){N=p[O];var f=p[O+1];N===f?++M:M?(P+=w("th","highcharts-table-topheading",'scope="col" colspan="'+(M+1)+'"',N),M=0):(N===n[O]?I.exporting.useRowspanHeaders?(f=2,delete n[O]):(f=1,n[O]=""):f=1,P+=w("th","highcharts-table-topheading",'scope="col"'+(1<f?' valign="top" rowspan="'+f+'"':""),N))}P+="</tr>"}if(n){P+="<tr>";O=0;for(Q=n.length;O<Q;++O){"undefined"!==typeof n[O]&&(P+=w("th",null,'scope="col"',n[O]))}P+="</tr>"}return P+"</thead>"}(D,v,Math.max(F,v.length));J+="<tbody>";K.forEach(function(d){J+="<tr>";for(var e=0;e<F;e++){J+=w(e?"td":"th",null,e?"":'scope="row"',d[e])}J+="</tr>"});J+="</tbody></table>";K={html:J};s(this,"afterGetTable",K);return K.html};B.prototype.downloadCSV=function(){var d=this.getCSV(!0);o(q(d,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(d),this.getFilename()+".csv")};B.prototype.downloadXLS=function(){var d='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";o(q(d,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+t.btoa(unescape(encodeURIComponent(d))),this.getFilename()+".xls")};B.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=m.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling),this.dataTableDiv.innerHTML=this.getTable());if(""===this.dataTableDiv.style.display||"none"===this.dataTableDiv.style.display){this.dataTableDiv.style.display="block"}this.isDataTableVisible=!0;s(this,"afterViewData",this.dataTableDiv)};B.prototype.hideData=function(){this.dataTableDiv&&"block"===this.dataTableDiv.style.display&&(this.dataTableDiv.style.display="none");this.isDataTableVisible=!1};B.prototype.toggleDataTable=function(){var e,g=this.exportDivElements,f=null===(e=null===x||void 0===x?void 0:x.buttons)||void 0===e?void 0:e.contextButton.menuItems;e=this.options.lang;this.isDataTableVisible?this.hideData():this.viewData();(null===x||void 0===x?0:x.menuItemDefinitions)&&(null===e||void 0===e?0:e.viewData)&&e.hideData&&f&&g&&g.length&&(g[f.indexOf("viewData")].innerHTML=this.isDataTableVisible?e.hideData:e.viewData)};var x=i().exporting;x&&(j(x.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),x.buttons&&x.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData"));z.map&&(z.map.prototype.exportKey="name");z.mapbubble&&(z.mapbubble.prototype.exportKey="name");z.treemap&&(z.treemap.prototype.exportKey="name")});c(b,"masters/modules/export-data.src.js",[],function(){})});