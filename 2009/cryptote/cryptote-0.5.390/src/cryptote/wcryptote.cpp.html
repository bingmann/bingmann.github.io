<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=iso-8859-1" http-equiv="content-type" /><meta name="viewport" content="initial-scale=1"><title>/2009/cryptote/cryptote-0.5.390/src/cryptote/wcryptote.cpp - panthema.net</title><link rel="stylesheet" type="text/css" href="/css/base.css" /><link rel="stylesheet" type="text/css" href="/css/fonts.css" /><link rel="alternate" type="application/rss+xml" title="panthema.net Weblog Feed RSS 2.0" href="http://panthema.net/xmlfeed/weblog-rss20.xml" /><link rel="alternate" type="application/atom+xml" title="panthema.net Weblog Feed Atom 1.0" href="http://panthema.net/xmlfeed/weblog-atom10.xml" /><script type="text/javascript" src="/js/base.js"></script><script type="text/javascript">/* <!-- */makeIEHover = function() {var lis = document.getElementById('ptnav').getElementsByTagName('li');for (var i = 0; i < lis.length; i++) {lis[i].onmouseover = function() {this.className += ' sfhover';};lis[i].onmouseout = function() {this.className = this.className.replace(new RegExp(' sfhover\b'), '');};}};if (window.attachEvent) window.attachEvent('onload', makeIEHover);/* --> */</script></head><body style="background-image: url(/img/bgfractal3.jpg)"><div class="pttopbar"><div style="float: right"><ul id="ptnav"><li class="top"><a class="ni" href="/"><i class="icon-book"></i> Weblog</a><ul style="margin-left: -6px; margin-top: 4px" class="nx"><li><a href="/2018/">2018</a></li><li><a href="/2017/">2017</a></li><li><a href="/2016/">2016</a></li><li><a href="/2015/">2015</a></li><li><a href="/2014/">2014</a></li><li><a href="/2013/">2013</a></li><li><a href="/2012/">2012</a></li><li><a href="/2011/">2011</a></li><li><a href="/2010/">2010</a></li><li><a href="/2009/">2009</a></li><li><a href="/2008/">2008</a></li><li><a href="/2007/">2007</a></li><li><a href="/2006/">2006</a></li><li class="nt"><a href="/2005/">2005</a></li><li class="ns"><a href="/xmlfeed/weblog-rss20.xml">RSS Feed</a></li><li class="nt"><a href="/xmlfeed/weblog-atom10.xml">XML Atom</a></li><li class="ns"><a href="/search.html">Search</a></li></ul></li><li class="top"><a class="ni" href="/tags/"><i class="icon-tags"></i> Tags</a><div style="width: 14em; margin-left: -9em; margin-top: 4px"><a style="font-size: 10pt" href="/tags/algebra.html">algebra</a> <a style="font-size: 16pt" href="/tags/c++.html">c++</a> <a style="font-size: 12pt" href="/tags/code-example.html">code-example</a> <a style="font-size: 14pt" href="/tags/code-snippet.html">code-snippet</a> <a style="font-size: 11pt" href="/tags/coding_tricks.html">coding tricks</a> <a style="font-size: 10pt" href="/tags/compsci.html">compsci</a> <a style="font-size: 10pt" href="/tags/compsci_study_thesis.html">compsci study thesis</a> <a style="font-size: 9pt" href="/tags/crypto-speedtest.html">crypto-speedtest</a> <a style="font-size: 10pt" href="/tags/cryptography.html">cryptography</a> <a style="font-size: 9pt" href="/tags/cryptote.html">cryptote</a> <a style="font-size: 10pt" href="/tags/dissertation.html">dissertation</a> <a style="font-size: 12pt" href="/tags/flex-bison-cpp-example.html">flex-bison-cpp-example</a> <a style="font-size: 16pt" href="/tags/frontpage.html">frontpage</a> <a style="font-size: 14pt" href="/tags/fun.html">fun</a> <a style="font-size: 10pt" href="/tags/graphviz.html">graphviz</a> <a style="font-size: 9pt" href="http://www.hmtg.de">hartmetall</a> <a style="font-size: 9pt" href="/tags/helppc.html">helppc</a> <a style="font-size: 9pt" href="/tags/hifi_selbstbau.html">hifi selbstbau</a> <a style="font-size: 10pt" href="/tags/latex.html">latex</a> <a style="font-size: 10pt" href="/tags/librivox.html">librivox</a> <a style="font-size: 10pt" href="/tags/linux.html">linux</a> <a style="font-size: 9pt" href="/tags/massive-sorting.html">massive-sorting</a> <a style="font-size: 11pt" href="/tags/maths.html">maths</a> <a style="font-size: 9pt" href="/tags/music.html">music</a> <a style="font-size: 10pt" href="/tags/netfundamentals.html">netfundamentals</a> <a style="font-size: 11pt" href="/tags/ns-3.html">ns-3</a> <a style="font-size: 10pt" href="/tags/parallel-string-sorting.html">parallel-string-sorting</a> <a style="font-size: 14pt" href="/tags/parsing.html">parsing</a> <a style="font-size: 9pt" href="/tags/qtsqlview.html">qtsqlview</a> <a style="font-size: 14pt" href="/tags/research.html">research</a> <a style="font-size: 11pt" href="/tags/sdios06.html">sdios06</a> <a style="font-size: 9pt" href="/tags/sdlfractal.html">sdlfractal</a> <a style="font-size: 14pt" href="/tags/sorting.html">sorting</a> <a style="font-size: 11pt" href="/tags/sound_of_sorting.html">sound of sorting</a> <a style="font-size: 10pt" href="/tags/stringology.html">stringology</a> <a style="font-size: 16pt" href="/tags/stx-btree.html">stx-btree</a> <a style="font-size: 15pt" href="/tags/stxxl.html">stxxl</a> <a style="font-size: 16pt" href="/tags/talk.html">talk</a> <a style="font-size: 14pt" href="/tags/thrill.html">thrill</a> <a style="font-size: 10pt" href="/tags/tutorium.html">tutorium</a> <a style="font-size: 16pt" href="/tags/university.html">university</a> <a style="font-size: 13pt" href="/tags/utilities.html">utilities</a> <a style="font-size: 10pt" href="/tags/vncrec.html">vncrec</a> <a style="font-size: 9pt" href="/tags/webdesign.html">webdesign</a> </div></li><li class="top"> <a class="ni" href="#"><i class="icon-cubes"></i> Projects</a> <ul style="margin-left: -8em; margin-top: 4px;" class="nx"> <li><a href="/2009/cryptote/">CryptoTE</a></li> <li><a href="/2009/digup/">digup</a></li> <li><a href="/2013/disk-filltest/">disk-filltest</a></li> <li><a href="/2012/1119-eSAIS-Inducing-Suffix-and-LCP-Arrays-in-External-Memory/">eSAIS-LCP</a></li> <li><a href="/2007/flex-bison-cpp-example/">Flex Bison C++ Example</a></li> <li><a href="/2013/malloc_count/">malloc_count</a></li> <li><a href="/2013/parallel-string-sorting/">parallel-string-sorting</a></li> <li><a href="/2013/pmbw/">Parallel Memory Bandwidth</a></li> <li><a href="/2014/sqlplot-tools/">SqlPlotTools</a></li> <li><a href="/2013/sound-of-sorting/">The Sound of Sorting</a></li> <li><a href="/2007/stx-btree/">STX B+ Tree</a></li> <li><a href="/2010/stx-cbtreedb/">STX Constant BTreeDB</a></li> <li><a href="/2010/stx-execpipe/">STX ExecPipe</a></li> <li><a href="/2007/stx-exparser/">STX Expression Parser</a></li> <li><a href="/tags/stxxl.html">STXXL 1.4</a></li> <li class="nt"><a href="/2014/vncrec-rgb/">VNCrec RGB 0.4</a></li> <li class="ns"><a href="/search.html">Search</a></li> </ul></li><li class="top"> <a class="ni" href="#"><i class="icon-graduation-cap"></i> Research</a> <ul style="margin-left: -16em; margin-top: 4px" class="nx"> <li><a href="/2012/1119-eSAIS-Inducing-Suffix-and-LCP-Arrays-in-External-Memory/">eSAIS-LCP - External Memory Suffix Sorting</a></li> <li><a href="/2016/0114-diploma-thesis/">On Bispanning Graphs</a></li> <li><a href="/2013/parallel-string-sorting/">Parallel String Sorting</a></li> <li><a href="/tags/massive-sorting.html">Practical Massively Parallel Sorting</a></li> <li><a href="/tags/stxxl.html">STXXL - External Memory Algorithms</a></li> <li><a href="/tags/thrill.html">Thrill - Distributed Batch Big Data Processing</a></li> <li class="ns"><a href="/search.html">Search</a></li> </ul></li><li class="top"> <a class="ni" href="/about/"><i class="icon-info-circled"></i> About</a> <ul style="margin-left: -6em; margin-top: 4px" class="nx"> <li><a href="/about/">Timo Bingmann</a></li> <li><a href="/about/impressum.html">Impressum</a></li> </ul></li><li class="top"> <a class="ni" href="/subscribe.html"><i class="icon-rss-squared"></i> Subscribe</a></li></ul></div><div style="padding: 6px"><a href="/">panthema</a>  / <a href="/2009/">2009</a> / <a href="/2009/cryptote/">cryptote</a> / <a href="/2009/cryptote/cryptote-0.5.390/">cryptote-0.5.390</a> / <a href="/2009/cryptote/cryptote-0.5.390/src/">src</a> / <a href="/2009/cryptote/cryptote-0.5.390/src/cryptote/">cryptote</a> / <a href="/2009/cryptote/cryptote-0.5.390/src/cryptote/wcryptote.cpp.html">wcryptote.cpp</a> (<a href="/2009/cryptote/cryptote-0.5.390/src/cryptote/wcryptote.cpp">Download File</a>)</div></div><div class="ptfullwidth"><pre class="codesnippet" style="font-family: monospace"><tt><span class="comment">// $Id: wcryptote.cpp 389 2009-08-03 20:46:08Z tb $</span>

<span class="comment">/*</span>
<span class="comment"> * CryptoTE v0.5.390</span>
<span class="comment"> * Copyright (C) 2008-2009 Timo Bingmann</span>
<span class="comment"> *</span>
<span class="comment"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="comment"> * under the terms of the GNU General Public License as published by the Free</span>
<span class="comment"> * Software Foundation; either version 2 of the License, or (at your option)</span>
<span class="comment"> * any later version.</span>
<span class="comment"> *</span>
<span class="comment"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for</span>
<span class="comment"> * more details.</span>
<span class="comment"> *</span>
<span class="comment"> * You should have received a copy of the GNU General Public License along</span>
<span class="comment"> * with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="comment"> * 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
<span class="comment"> */</span>

<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wcryptote.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"bmpcat.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wtextpage.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wfind.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wfilelist.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wfileprop.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wcntprop.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wmsgdlg.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wbinpage.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wpass.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"wprefs.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"hhelpfs.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"pwgen/wpassgen.h"</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">"common/myintl.h"</span>

<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;wx/config.h&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;wx/fileconf.h&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;wx/tokenzr.h&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;wx/url.h&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;wx/protocol/http.h&gt;</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;memory&gt;</span>

<span class="preproc">#include</span><span class="normal"> </span><span class="string">"common/tools.h"</span>

<span class="preproc">#if</span><span class="normal"> </span><span class="function">defined</span><span class="symbol">(</span><span class="normal">__WINDOWS__</span><span class="symbol">)</span>
<span class="preproc">#include</span><span class="normal"> </span><span class="string">&lt;share.h&gt;</span>
<span class="preproc">#endif</span>

<span class="normal">WCryptoTE</span><span class="symbol">::</span><span class="function">WCryptoTE</span><span class="symbol">(</span><span class="normal">wxWindow</span><span class="symbol">*</span><span class="normal"> parent</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">class</span><span class="normal"> </span><span class="classname">MyLocale</span><span class="symbol">*</span><span class="normal"> locale</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">:</span><span class="normal"> </span><span class="function">wxFrame</span><span class="symbol">(</span><span class="normal">parent</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxT</span><span class="symbol">(</span><span class="string">""</span><span class="symbol">),</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxSize</span><span class="symbol">(</span><span class="number">750</span><span class="symbol">,</span><span class="normal"> </span><span class="number">550</span><span class="symbol">),</span>
<span class="normal">	      wxDEFAULT_FRAME_STYLE </span><span class="symbol">|</span><span class="normal"> wxNO_FULL_REPAINT_ON_RESIZE</span><span class="symbol">),</span>
<span class="normal">      </span><span class="function">m_locale</span><span class="symbol">(</span><span class="normal">locale</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    cpage </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    cpageid </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">    container_filehandle </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    main_modified </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    lastuserevent </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">::</span><span class="function">wxGetLocalTime</span><span class="symbol">();</span>
<span class="normal">    wpassgen </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    copt_restoreview </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>
<span class="normal">    m_htmlhelp </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// General Initalizations</span>

<span class="normal">    </span><span class="function">LoadPreferences</span><span class="symbol">();</span>
<span class="normal">    BitmapCatalog</span><span class="symbol">::</span><span class="function">GetSingleton</span><span class="symbol">()-&gt;</span><span class="function">SetTheme</span><span class="symbol">(</span><span class="normal">prefs_bitmaptheme</span><span class="symbol">);</span>

<span class="normal">    Enctain</span><span class="symbol">::</span><span class="normal">Container</span><span class="symbol">::</span><span class="function">SetSignature</span><span class="symbol">(</span><span class="string">"CryptoTE"</span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// Program Icon</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">    </span>
<span class="preproc">        #include</span><span class="normal"> </span><span class="string">"art/cryptote-16.h"</span>
<span class="preproc">        #include</span><span class="normal"> </span><span class="string">"art/cryptote-32.h"</span>
<span class="preproc">        #include</span><span class="normal"> </span><span class="string">"art/cryptote-48.h"</span>

<span class="normal">	</span><span class="usertype">wxIconBundle</span><span class="normal"> progicon</span><span class="symbol">;</span>
<span class="normal">	progicon</span><span class="symbol">.</span><span class="function">AddIcon</span><span class="symbol">(</span><span class="normal"> </span><span class="function">wxIconFromMemory</span><span class="symbol">(</span><span class="normal">cryptote_16_png</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">	progicon</span><span class="symbol">.</span><span class="function">AddIcon</span><span class="symbol">(</span><span class="normal"> </span><span class="function">wxIconFromMemory</span><span class="symbol">(</span><span class="normal">cryptote_32_png</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">	progicon</span><span class="symbol">.</span><span class="function">AddIcon</span><span class="symbol">(</span><span class="normal"> </span><span class="function">wxIconFromMemory</span><span class="symbol">(</span><span class="normal">cryptote_48_png</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>

<span class="normal">	</span><span class="function">SetIcons</span><span class="symbol">(</span><span class="normal">progicon</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="function">SetTitle</span><span class="symbol">(</span><span class="normal">wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE %s"</span><span class="symbol">),</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="normal">VERSION</span><span class="symbol">)));</span>

<span class="normal">    menubar_plain </span><span class="symbol">=</span><span class="normal"> </span><span class="function">CreateMenuBar</span><span class="symbol">(</span><span class="normal">NULL</span><span class="symbol">);</span>
<span class="normal">    menubar_textpage </span><span class="symbol">=</span><span class="normal"> </span><span class="function">CreateMenuBar</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">));</span>
<span class="normal">    menubar_binarypage </span><span class="symbol">=</span><span class="normal"> </span><span class="function">CreateMenuBar</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WBinaryPage</span><span class="symbol">));</span>
<span class="normal">    menubar_active </span><span class="symbol">=</span><span class="normal"> menubar_plain</span><span class="symbol">;</span>
<span class="normal">    toolbar </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">SetMenuBar</span><span class="symbol">(</span><span class="normal">menubar_active</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">CreateToolBar</span><span class="symbol">();</span>

<span class="normal">    statusbar </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WStatusBar</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">SetStatusBar</span><span class="symbol">(</span><span class="normal">statusbar</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Welcome to CryptoTE..."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="cbracket">{</span><span class="normal"> </span><span class="comment">// Accelerator to handle ESC key</span>

<span class="normal">	</span><span class="usertype">wxAcceleratorEntry</span><span class="normal"> entries</span><span class="symbol">[</span><span class="number">1</span><span class="symbol">];</span>
<span class="normal">	entries</span><span class="symbol">[</span><span class="number">0</span><span class="symbol">].</span><span class="function">Set</span><span class="symbol">(</span><span class="normal">wxACCEL_NORMAL</span><span class="symbol">,</span><span class="normal"> WXK_ESCAPE</span><span class="symbol">,</span><span class="normal"> myID_ACCEL_ESCAPE</span><span class="symbol">);</span>
<span class="normal">	</span><span class="usertype">wxAcceleratorTable</span><span class="normal"> </span><span class="function">accel</span><span class="symbol">(</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> entries</span><span class="symbol">);</span>
<span class="normal">	</span><span class="function">SetAcceleratorTable</span><span class="symbol">(</span><span class="normal">accel</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// *** Set up Main Windows ***</span>

<span class="normal">    </span><span class="comment">// Create Controls</span>

<span class="normal">    auinotebook </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxAuiNotebook</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> myID_AUINOTEBOOK</span><span class="symbol">,</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> wxDefaultSize</span><span class="symbol">,</span>
<span class="normal">				    wxAUI_NB_DEFAULT_STYLE </span><span class="symbol">|</span><span class="normal"> wxNO_BORDER</span><span class="symbol">);</span>

<span class="normal">    filelistpane </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WFileList</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">    wpassgen </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WPassGen</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">UpdateMenuInsertPassword</span><span class="symbol">();</span>

<span class="normal">    </span><span class="comment">// *** wxAUI Layout ***</span>

<span class="normal">    </span><span class="comment">// tell wxAuiManager to manage this frame</span>
<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">SetManagedWindow</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// add panes to the manager</span>

<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">AddPane</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxAuiPaneInfo</span><span class="symbol">().</span>
<span class="normal">		   </span><span class="function">Name</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">"toolbar"</span><span class="symbol">)).</span><span class="function">Caption</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Toolbar"</span><span class="symbol">)).</span>
<span class="normal">		   </span><span class="function">ToolbarPane</span><span class="symbol">().</span><span class="function">Top</span><span class="symbol">().</span>
<span class="normal">		   </span><span class="function">LeftDockable</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">RightDockable</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">));</span>

<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">AddPane</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxAuiPaneInfo</span><span class="symbol">().</span>
<span class="normal">		   </span><span class="function">Name</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">"notebook"</span><span class="symbol">)).</span><span class="function">Caption</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Notebook"</span><span class="symbol">)).</span>
<span class="normal">		   </span><span class="function">CenterPane</span><span class="symbol">().</span><span class="function">PaneBorder</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">));</span>

<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">AddPane</span><span class="symbol">(</span><span class="normal">filelistpane</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxAuiPaneInfo</span><span class="symbol">().</span>
<span class="normal">		   </span><span class="function">Name</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">"filelist"</span><span class="symbol">)).</span><span class="function">Caption</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Container"</span><span class="symbol">)).</span>
<span class="normal">		   </span><span class="function">Bottom</span><span class="symbol">());</span>

<span class="normal">    </span><span class="comment">// "commit" all changes made to wxAuiManager</span>
<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">    quickfindbar </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    quickgotobar </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>

<span class="normal">    findreplacedlg </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>

<span class="normal">    quickfindbar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    quickgotobar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// Create and start idle-timer check function</span>
<span class="normal">    idlechecktimer</span><span class="symbol">.</span><span class="function">SetOwner</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> myID_TIMER_IDLECHECK</span><span class="symbol">);</span>
<span class="normal">    idlechecktimer</span><span class="symbol">.</span><span class="function">Start</span><span class="symbol">(</span><span class="number">1000</span><span class="symbol">,</span><span class="normal"> wxTIMER_CONTINUOUS</span><span class="symbol">);</span>

<span class="preproc">#ifdef</span><span class="normal"> __WXMSW__</span>
<span class="normal">    </span><span class="function">Centre</span><span class="symbol">();</span>
<span class="preproc">#endif</span>

<span class="normal">    </span><span class="function">ContainerNew</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="normal">WCryptoTE</span><span class="symbol">::~</span><span class="function">WCryptoTE</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">UnInit</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">m_htmlhelp</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        m_htmlhelp</span><span class="symbol">-&gt;</span><span class="function">WriteCustomization</span><span class="symbol">(</span><span class="normal">wxConfigBase</span><span class="symbol">::</span><span class="function">Get</span><span class="symbol">(),</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"htmlhelp"</span><span class="symbol">));</span>
<span class="normal">        wxConfigBase</span><span class="symbol">::</span><span class="function">Get</span><span class="symbol">()-&gt;</span><span class="function">Flush</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container_filehandle</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">delete</span><span class="normal"> container_filehandle</span><span class="symbol">;</span>
<span class="normal">	container_filehandle </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="keyword">const</span><span class="normal"> wxChar</span><span class="symbol">*</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">EnctainErrorString</span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="usertype">error_type</span><span class="normal"> e</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">using</span><span class="normal"> </span><span class="keyword">namespace</span><span class="normal"> Enctain</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">switch</span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_SUCCESS</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Success."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_TEXT</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Generic text message error."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_OUTPUT_ERROR</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in data output stream: error writing file."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_INPUT_ERROR</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in data input stream: error reading file."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_SAVE_NO_KEYSLOTS</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error saving container: no encryption key slots set!"</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER1</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read primary header."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER1_SIGNATURE</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read primary header, invalid signature."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER1_VERSION</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read primary header, invalid version."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER1_METADATA</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read primary header, invalid metadata."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER1_METADATA_PARSE</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read primary header, metadata parse failed."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER2</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read key slots header."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER2_NO_KEYSLOTS</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: file contains no key slots for decryption."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER2_KEYSLOTS</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read key slots header, error reading key slot material."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER2_INVALID_KEY</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: supplied key matches no key slot in header, check password."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER3</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read data header."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER3_ENCRYPTION</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read data header, check encryption key."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER3_METADATA</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read data header, invalid metadata."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER3_METADATA_CHECKSUM</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read data header, metadata CRC32 checksum mismatch."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_HEADER3_METADATA_PARSE</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read data header, metadata parse failed."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_SUBFILE</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read encrypted subfile data."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_LOAD_CHECKSUM</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: CRC32 checksum mismatch, file possibly corrupt."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_KEYSLOT_INVALID_INDEX</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Invalid encryption key slot index."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_SUBFILE_INVALID_INDEX</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Invalid subfile index."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_SUBFILE_CHECKSUM</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in subfile: CRC32 checksum mismatch, data possibly corrupt."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_SUBFILE_INVALID_COMPRESSION</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Unknown subfile compression algorithm."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_SUBFILE_INVALID_ENCRYPTION</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Unknown subfile encryption cipher."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_UNKNOWN</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: unknown error."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_OK</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: success."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_NEED_DICT</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: need dictionary."</span><span class="symbol">);</span>
<span class="normal">	</span>
<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_STREAM_END</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: stream end."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_ERRNO</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: file error."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_STREAM_ERROR</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: stream error."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_DATA_ERROR</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: data error."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_MEM_ERROR</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: insufficient memory."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_BUF_ERROR</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: buffer error."</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> ETE_Z_VERSION_ERROR</span><span class="symbol">:</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in zlib: incompatible version."</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Unknown error code."</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="usertype">wxString</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">EnctainExceptionString</span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">Exception</span><span class="symbol">&amp;</span><span class="normal"> e</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">.</span><span class="function">code</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">ETE_TEXT</span><span class="symbol">)</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">.</span><span class="function">str</span><span class="symbol">());</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="function">EnctainErrorString</span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">.</span><span class="function">code</span><span class="symbol">());</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> str</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    statusbar</span><span class="symbol">-&gt;</span><span class="function">SetStatusText</span><span class="symbol">(</span><span class="normal">str</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">HidePane</span><span class="symbol">(</span><span class="normal">wxWindow</span><span class="symbol">*</span><span class="normal"> child</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">child</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">bool</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">IsModified</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// check metadata</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">main_modified</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">for</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	WNotePage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">),</span><span class="normal"> WNotePage</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">-&gt;</span><span class="normal">page_modified</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Invalid notebook page found."</span><span class="symbol">));</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UpdateModified</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="type">bool</span><span class="normal"> modified </span><span class="symbol">=</span><span class="normal"> </span><span class="function">IsModified</span><span class="symbol">();</span>

<span class="normal">    menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">wxID_SAVE</span><span class="symbol">,</span><span class="normal"> modified</span><span class="symbol">);</span>
<span class="normal">    menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">wxID_REVERT</span><span class="symbol">,</span><span class="normal"> modified</span><span class="symbol">);</span>

<span class="normal">    toolbar</span><span class="symbol">-&gt;</span><span class="function">EnableTool</span><span class="symbol">(</span><span class="normal">wxID_SAVE</span><span class="symbol">,</span><span class="normal"> modified</span><span class="symbol">);</span>

<span class="normal">    statusbar</span><span class="symbol">-&gt;</span><span class="function">SetModified</span><span class="symbol">(</span><span class="normal">modified</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">SetModified</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    main_modified </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>
<span class="normal">    </span><span class="function">UpdateModified</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="normal">WNotePage</span><span class="symbol">*</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">FindSubFilePage</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> sfid</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">for</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	WNotePage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">),</span><span class="normal"> WNotePage</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">-&gt;</span><span class="normal">subfileid </span><span class="symbol">==</span><span class="normal"> </span><span class="symbol">(</span><span class="type">int</span><span class="symbol">)</span><span class="normal">sfid</span><span class="symbol">)</span>
<span class="normal">		</span><span class="keyword">return</span><span class="normal"> page</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Invalid notebook page found."</span><span class="symbol">));</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OpenSubFile</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> sfid</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    WNotePage</span><span class="symbol">*</span><span class="normal"> findpage </span><span class="symbol">=</span><span class="normal"> </span><span class="function">FindSubFilePage</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">findpage </span><span class="symbol">!=</span><span class="normal"> NULL</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// subfile with specified id is already open. change notebook tab to</span>
<span class="normal">	</span><span class="comment">// the selected subfile.</span>
<span class="normal">	auinotebook</span><span class="symbol">-&gt;</span><span class="function">SetSelection</span><span class="symbol">(</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageIndex</span><span class="symbol">(</span><span class="normal">findpage</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> filetype </span><span class="symbol">=</span><span class="normal"> container</span><span class="symbol">.</span><span class="function">GetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Filetype"</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">filetype </span><span class="symbol">==</span><span class="normal"> </span><span class="string">"text"</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	WTextPage</span><span class="symbol">*</span><span class="normal"> textpage </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WTextPage</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">textpage</span><span class="symbol">-&gt;</span><span class="function">LoadSubFile</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">))</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Error loading subfile into text page."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">delete</span><span class="normal"> textpage</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    auinotebook</span><span class="symbol">-&gt;</span><span class="function">AddPage</span><span class="symbol">(</span><span class="normal">textpage</span><span class="symbol">,</span><span class="normal"> textpage</span><span class="symbol">-&gt;</span><span class="function">GetCaption</span><span class="symbol">(),</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>

<span class="normal">	    </span><span class="function">UpdateNotebookPageChanged</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageIndex</span><span class="symbol">(</span><span class="normal">textpage</span><span class="symbol">),</span><span class="normal"> textpage</span><span class="symbol">);</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	WBinaryPage</span><span class="symbol">*</span><span class="normal"> binarypage </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WBinaryPage</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">binarypage</span><span class="symbol">-&gt;</span><span class="function">LoadSubFile</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">))</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Error loading subfile into binary page."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">delete</span><span class="normal"> binarypage</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    auinotebook</span><span class="symbol">-&gt;</span><span class="function">AddPage</span><span class="symbol">(</span><span class="normal">binarypage</span><span class="symbol">,</span><span class="normal"> binarypage</span><span class="symbol">-&gt;</span><span class="function">GetCaption</span><span class="symbol">(),</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>

<span class="normal">	    </span><span class="function">UpdateNotebookPageChanged</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageIndex</span><span class="symbol">(</span><span class="normal">binarypage</span><span class="symbol">),</span><span class="normal"> binarypage</span><span class="symbol">);</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UpdateSubFileCaption</span><span class="symbol">(</span><span class="type">int</span><span class="normal"> sfid</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    WNotePage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">FindSubFilePage</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageIndex</span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">pi </span><span class="symbol">==</span><span class="normal"> wxNOT_FOUND</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">  </span>
<span class="normal">    auinotebook</span><span class="symbol">-&gt;</span><span class="function">SetPageText</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">,</span><span class="normal"> page</span><span class="symbol">-&gt;</span><span class="function">GetCaption</span><span class="symbol">());</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UpdateSubFileModified</span><span class="symbol">(</span><span class="normal">WNotePage</span><span class="symbol">*</span><span class="normal"> page</span><span class="symbol">,</span><span class="normal"> </span><span class="type">bool</span><span class="normal"> modified</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="preproc">    #include</span><span class="normal"> </span><span class="string">"art/modified-12.h"</span>

<span class="normal">    </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageIndex</span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">pi </span><span class="symbol">==</span><span class="normal"> wxNOT_FOUND</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    auinotebook</span><span class="symbol">-&gt;</span><span class="function">SetPageBitmap</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">,</span><span class="normal"> modified </span><span class="symbol">?</span><span class="normal"> </span><span class="function">wxBitmapFromMemory</span><span class="symbol">(</span><span class="normal">modified_12_png</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> wxNullBitmap</span><span class="symbol">);</span>

<span class="normal">    </span><span class="function">UpdateModified</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="keyword">static</span><span class="normal"> </span><span class="keyword">inline</span><span class="normal"> </span><span class="type">bool</span><span class="normal"> </span><span class="function">CheckTextASCII</span><span class="symbol">(</span><span class="type">char</span><span class="normal"> c</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">static</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> </span><span class="type">unsigned</span><span class="normal"> </span><span class="type">char</span><span class="normal"> ok</span><span class="symbol">[</span><span class="number">256</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">=</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// 1, 2, 3, 4, 5, 6, 7, 8, 9, A, B, C, D, E, F</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 00-0F: NUL - SI</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 10-1F: DLE - US</span>
<span class="normal">	</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 20-2F: " !"#$%&amp;'()*+,-./"</span>
<span class="normal">	</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 30-3F: "0123456789:;&lt;=&gt;?"</span>
<span class="normal">	</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 40-4F: "@ABCDEFGHIJKLMNO"</span>
<span class="normal">	</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 50-5F: "PQRSTUVWXYZ[\]^_"</span>
<span class="normal">	</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 60-6F: "`abcdefghijklmno"</span>
<span class="normal">	</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 70-7F: "pqrstuvwxyz{|}~ "</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 80-8F: depends on codepage</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// 90-9F: depends on codepage</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// A0-AF: depends on codepage</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// B0-BF: depends on codepage</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// C0-CF: depends on codepage</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// D0-DF: depends on codepage</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="comment">// E0-EF: depends on codepage</span>
<span class="normal">	</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="normal">  </span><span class="comment">// F0-FF: depends on codepage</span>
<span class="normal">    </span><span class="cbracket">}</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">return</span><span class="normal"> ok</span><span class="symbol">[(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">char</span><span class="symbol">)(</span><span class="normal">c</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal"> </span><span class="number">0xFF</span><span class="symbol">];</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">ImportSubFiles</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> wxArrayString</span><span class="symbol">&amp;</span><span class="normal"> importlist</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> importtype</span><span class="symbol">,</span><span class="normal"> </span><span class="type">bool</span><span class="normal"> openpage</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">size_t</span><span class="normal"> importsize </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">size_t</span><span class="normal"> importnum </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> fi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> fi </span><span class="symbol">&lt;</span><span class="normal"> importlist</span><span class="symbol">.</span><span class="function">GetCount</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">fi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">wxFile</span><span class="normal"> </span><span class="function">filehandle</span><span class="symbol">(</span><span class="normal">importlist</span><span class="symbol">[</span><span class="normal">fi</span><span class="symbol">],</span><span class="normal"> wxFile</span><span class="symbol">::</span><span class="normal">read</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">filehandle</span><span class="symbol">.</span><span class="function">IsOpened</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">continue</span><span class="symbol">;</span>

<span class="normal">	</span><span class="comment">// Create new file in the container</span>
<span class="normal">	</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> sfnew </span><span class="symbol">=</span><span class="normal"> container</span><span class="symbol">.</span><span class="function">AppendSubFile</span><span class="symbol">();</span>
<span class="normal">    </span>
<span class="normal">	</span><span class="comment">// use defaults from global properties</span>
<span class="normal">	</span><span class="type">long</span><span class="normal"> defcomp </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"DefaultCompression"</span><span class="symbol">)).</span><span class="function">ToLong</span><span class="symbol">(&amp;</span><span class="normal">defcomp</span><span class="symbol">))</span>
<span class="normal">	    defcomp </span><span class="symbol">=</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">COMPRESSION_ZLIB</span><span class="symbol">;</span>

<span class="normal">	</span><span class="type">long</span><span class="normal"> defencr </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"DefaultEncryption"</span><span class="symbol">)).</span><span class="function">ToLong</span><span class="symbol">(&amp;</span><span class="normal">defencr</span><span class="symbol">))</span>
<span class="normal">	    defencr </span><span class="symbol">=</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">ENCRYPTION_SERPENT256</span><span class="symbol">;</span>

<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetSubFileCompression</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">compression_type</span><span class="symbol">)</span><span class="normal">defcomp</span><span class="symbol">);</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetSubFileEncryption</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">encryption_type</span><span class="symbol">)</span><span class="normal">defencr</span><span class="symbol">);</span>

<span class="normal">	</span><span class="usertype">wxFileName</span><span class="normal"> </span><span class="function">fname</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">importlist</span><span class="symbol">[</span><span class="normal">fi</span><span class="symbol">]);</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Name"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="normal">fname</span><span class="symbol">.</span><span class="function">GetFullName</span><span class="symbol">()));</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Author"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="function">wxGetUserId</span><span class="symbol">()));</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"CTime"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strTimeStampNow</span><span class="symbol">());</span>

<span class="normal">	std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal"> filetype </span><span class="symbol">=</span><span class="normal"> importtype</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">filetype</span><span class="symbol">.</span><span class="function">empty</span><span class="symbol">())</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// try to detect file type</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">fname</span><span class="symbol">.</span><span class="function">GetExt</span><span class="symbol">().</span><span class="function">Lower</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"txt"</span><span class="symbol">))</span>
<span class="normal">		filetype </span><span class="symbol">=</span><span class="normal"> </span><span class="string">"text"</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="keyword">else</span>
<span class="normal">		filetype </span><span class="symbol">=</span><span class="normal"> </span><span class="string">""</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Filetype"</span><span class="symbol">,</span><span class="normal"> filetype</span><span class="symbol">);</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">openpage</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// Open empty subfileid in text editor or binary viewer page and</span>
<span class="normal">	    </span><span class="comment">// load the file via the page's method</span>

<span class="normal">	    </span><span class="function">OpenSubFile</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">);</span>
<span class="normal">	    </span>
<span class="normal">	    WNotePage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">FindSubFilePage</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">);</span>

<span class="normal">	    importnum</span><span class="symbol">++;</span>
<span class="normal">	    importsize </span><span class="symbol">+=</span><span class="normal"> page</span><span class="symbol">-&gt;</span><span class="function">ImportFile</span><span class="symbol">(</span><span class="normal">filehandle</span><span class="symbol">);</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// Load complete file into wxMemoryBuffer and save data via SetSubFileData()</span>
<span class="normal">	    </span><span class="usertype">wxMemoryBuffer</span><span class="normal"> filedata</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="type">bool</span><span class="normal"> istextfile </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">importtype</span><span class="symbol">.</span><span class="function">empty</span><span class="symbol">())</span><span class="normal"> istextfile </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>

<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="usertype">wxFileOffset</span><span class="normal"> filesize </span><span class="symbol">=</span><span class="normal"> filehandle</span><span class="symbol">.</span><span class="function">Length</span><span class="symbol">();</span>
<span class="normal">		statusbar</span><span class="symbol">-&gt;</span><span class="function">ProgressStart</span><span class="symbol">(</span><span class="function">wxString</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Importing"</span><span class="symbol">)).</span><span class="function">mb_str</span><span class="symbol">(),</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">PI_GENERIC</span><span class="symbol">,</span>
<span class="normal">					 </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> filesize</span><span class="symbol">);</span>

<span class="normal">		filedata</span><span class="symbol">.</span><span class="function">SetBufSize</span><span class="symbol">(</span><span class="normal">filesize</span><span class="symbol">);</span>
<span class="normal">		</span><span class="usertype">size_t</span><span class="normal"> offset </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>

<span class="normal">		</span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="type">int</span><span class="normal"> i </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">filehandle</span><span class="symbol">.</span><span class="function">Eof</span><span class="symbol">();</span><span class="normal"> i</span><span class="symbol">++)</span>
<span class="normal">		</span><span class="cbracket">{</span>
<span class="normal">		    filedata</span><span class="symbol">.</span><span class="function">SetBufSize</span><span class="symbol">(</span><span class="normal">offset </span><span class="symbol">+</span><span class="normal"> </span><span class="number">65536</span><span class="symbol">);</span>
<span class="normal">		</span>
<span class="normal">		    </span><span class="usertype">size_t</span><span class="normal"> readmax </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxMin</span><span class="symbol">(</span><span class="number">65536</span><span class="symbol">,</span><span class="normal"> filedata</span><span class="symbol">.</span><span class="function">GetBufSize</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">-</span><span class="normal"> offset</span><span class="symbol">);</span>
<span class="normal">		    </span><span class="usertype">size_t</span><span class="normal"> rb </span><span class="symbol">=</span><span class="normal"> filehandle</span><span class="symbol">.</span><span class="function">Read</span><span class="symbol">((</span><span class="type">char</span><span class="symbol">*)</span><span class="normal">filedata</span><span class="symbol">.</span><span class="function">GetData</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> offset</span><span class="symbol">,</span><span class="normal"> readmax</span><span class="symbol">);</span>
<span class="normal">		    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">rb </span><span class="symbol">&lt;=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">break</span><span class="symbol">;</span>

<span class="normal">		    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">istextfile</span><span class="symbol">)</span><span class="normal"> </span><span class="comment">// check if any non-printable ascii character is found</span>
<span class="normal">		    </span><span class="cbracket">{</span>
<span class="normal">			</span><span class="type">char</span><span class="symbol">*</span><span class="normal"> cdata </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="type">char</span><span class="symbol">*)</span><span class="normal">filedata</span><span class="symbol">.</span><span class="function">GetData</span><span class="symbol">();</span>
<span class="normal">			</span><span class="keyword">for</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> bo </span><span class="symbol">=</span><span class="normal"> offset</span><span class="symbol">;</span><span class="normal"> bo </span><span class="symbol">&lt;</span><span class="normal"> offset </span><span class="symbol">+</span><span class="normal"> rb</span><span class="symbol">;</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">bo</span><span class="symbol">)</span>
<span class="normal">			</span><span class="cbracket">{</span>
<span class="normal">			    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">CheckTextASCII</span><span class="symbol">(</span><span class="normal">cdata</span><span class="symbol">[</span><span class="normal">bo</span><span class="symbol">]))</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">				istextfile </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">				</span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">			    </span><span class="cbracket">}</span>
<span class="normal">			</span><span class="cbracket">}</span>
<span class="normal">		    </span><span class="cbracket">}</span>

<span class="normal">		    offset </span><span class="symbol">+=</span><span class="normal"> rb</span><span class="symbol">;</span>

<span class="normal">		    statusbar</span><span class="symbol">-&gt;</span><span class="function">ProgressUpdate</span><span class="symbol">(</span><span class="normal">offset</span><span class="symbol">);</span>
<span class="normal">		</span><span class="cbracket">}</span>

<span class="normal">		filehandle</span><span class="symbol">.</span><span class="function">Close</span><span class="symbol">();</span>
<span class="normal">		filedata</span><span class="symbol">.</span><span class="function">SetDataLen</span><span class="symbol">(</span><span class="normal">offset</span><span class="symbol">);</span>

<span class="normal">		statusbar</span><span class="symbol">-&gt;</span><span class="function">ProgressStop</span><span class="symbol">();</span>
<span class="normal">	    </span><span class="cbracket">}</span>

<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">istextfile </span><span class="symbol">&amp;&amp;</span><span class="normal"> importtype</span><span class="symbol">.</span><span class="function">empty</span><span class="symbol">())</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Filetype"</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"text"</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="cbracket">}</span>

<span class="normal">	    </span><span class="keyword">try</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">		container</span><span class="symbol">.</span><span class="function">SetSubFileData</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> filedata</span><span class="symbol">.</span><span class="function">GetData</span><span class="symbol">(),</span><span class="normal"> filedata</span><span class="symbol">.</span><span class="function">GetDataLen</span><span class="symbol">());</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	    </span><span class="keyword">catch</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">Exception</span><span class="symbol">&amp;</span><span class="normal"> e</span><span class="symbol">)</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="function">wxMessageDialogErrorOK</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> </span><span class="function">EnctainExceptionString</span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">));</span>
<span class="normal">		</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="cbracket">}</span>

<span class="normal">	    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"MTime"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strTimeStampNow</span><span class="symbol">());</span>

<span class="normal">	    importnum</span><span class="symbol">++;</span>
<span class="normal">	    importsize </span><span class="symbol">+=</span><span class="normal"> filedata</span><span class="symbol">.</span><span class="function">GetDataLen</span><span class="symbol">();</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// update window</span>
<span class="normal">    filelistpane</span><span class="symbol">-&gt;</span><span class="function">ResetItems</span><span class="symbol">();</span>

<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="normal">wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Imported %u bytes into %u new subfiles in container."</span><span class="symbol">),</span>
<span class="normal">				     importsize</span><span class="symbol">,</span><span class="normal"> importnum</span><span class="symbol">));</span>
<span class="normal">    </span><span class="function">SetModified</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">openpage</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">ExportSubFile</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> sfid</span><span class="symbol">,</span><span class="normal"> wxOutputStream</span><span class="symbol">&amp;</span><span class="normal"> outstream</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    WNotePage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">FindSubFilePage</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// write currently opened buffer to output stream</span>

<span class="normal">	page</span><span class="symbol">-&gt;</span><span class="function">ExportBuffer</span><span class="symbol">(</span><span class="normal">outstream</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// export directly from the container storage</span>
<span class="normal">	</span><span class="keyword">try</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="usertype">DataOutputStream</span><span class="normal"> </span><span class="function">dataout</span><span class="symbol">(</span><span class="normal">outstream</span><span class="symbol">);</span>
<span class="normal">	    container</span><span class="symbol">.</span><span class="function">GetSubFileData</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">,</span><span class="normal"> dataout</span><span class="symbol">);</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">catch</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">Exception</span><span class="symbol">&amp;</span><span class="normal"> e</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxMessageDialogErrorOK</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> </span><span class="function">EnctainExceptionString</span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">DeleteSubFile</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> sfid</span><span class="symbol">,</span><span class="normal"> </span><span class="type">bool</span><span class="normal"> resetfilelist</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    WNotePage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">FindSubFilePage</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageIndex</span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">pi </span><span class="symbol">==</span><span class="normal"> wxNOT_FOUND</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">	</span><span class="comment">// PageClose event is not generated by wxAuiNotebook</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">1</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// will be empty after the last page is closed</span>
<span class="normal">	    </span><span class="function">UpdateNotebookPageChanged</span><span class="symbol">(-</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> NULL</span><span class="symbol">);</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	auinotebook</span><span class="symbol">-&gt;</span><span class="function">DeletePage</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    container</span><span class="symbol">.</span><span class="function">DeleteSubFile</span><span class="symbol">(</span><span class="normal">sfid</span><span class="symbol">);</span>

<span class="normal">    </span><span class="comment">// fix-up subfileid's of all notepages</span>

<span class="normal">    </span><span class="keyword">for</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	WNotePage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">),</span><span class="normal"> WNotePage</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">-&gt;</span><span class="normal">subfileid </span><span class="symbol">&gt;=</span><span class="normal"> </span><span class="symbol">(</span><span class="type">int</span><span class="symbol">)</span><span class="normal">sfid</span><span class="symbol">)</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		page</span><span class="symbol">-&gt;</span><span class="normal">subfileid</span><span class="symbol">--;</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Invalid notebook page found."</span><span class="symbol">));</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">resetfilelist</span><span class="symbol">)</span>
<span class="normal">	filelistpane</span><span class="symbol">-&gt;</span><span class="function">ResetItems</span><span class="symbol">();</span>

<span class="normal">    </span><span class="function">SetModified</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="usertype">wxString</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">GetSavedFilename</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container_filename</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> container_filename</span><span class="symbol">.</span><span class="function">GetFullName</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="function">wxString</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Untitled.ect"</span><span class="symbol">));</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">ShowFilelistPane</span><span class="symbol">(</span><span class="type">bool</span><span class="normal"> on</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">on</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">filelistpane</span><span class="symbol">).</span><span class="function">Show</span><span class="symbol">();</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	toolbar</span><span class="symbol">-&gt;</span><span class="function">ToggleTool</span><span class="symbol">(</span><span class="normal">myID_MENU_CONTAINER_SHOWLIST</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">filelistpane</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	toolbar</span><span class="symbol">-&gt;</span><span class="function">ToggleTool</span><span class="symbol">(</span><span class="normal">myID_MENU_CONTAINER_SHOWLIST</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">HideQuickBars</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// Hide Quick-Find Bar</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickfindbar_visible </span><span class="symbol">&amp;&amp;</span><span class="normal"> quickfindbar</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">        </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">StopQuickFind</span><span class="symbol">();</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	quickfindbar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// Hide Quick-Goto Bar</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickgotobar_visible </span><span class="symbol">&amp;&amp;</span><span class="normal"> quickgotobar</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	quickgotobar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UpdateTitle</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> title</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container_filename</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	title </span><span class="symbol">+=</span><span class="normal"> container_filename</span><span class="symbol">.</span><span class="function">GetFullName</span><span class="symbol">();</span>
<span class="normal">	title </span><span class="symbol">+=</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">" - "</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    title </span><span class="symbol">+=</span><span class="normal"> wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE %s"</span><span class="symbol">),</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="normal">VERSION</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">SetTitle</span><span class="symbol">(</span><span class="normal">title</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">ContainerNew</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">Clear</span><span class="symbol">();</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetProgressIndicator</span><span class="symbol">(</span><span class="normal">statusbar</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container_filehandle</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">delete</span><span class="normal"> container_filehandle</span><span class="symbol">;</span>
<span class="normal">	container_filehandle </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    container_filename</span><span class="symbol">.</span><span class="function">Clear</span><span class="symbol">();</span>

<span class="normal">    main_modified </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">HideQuickBars</span><span class="symbol">();</span>

<span class="normal">    </span><span class="comment">// close all notebook pages</span>
<span class="normal">    </span><span class="keyword">while</span><span class="symbol">(</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&gt;</span><span class="normal"> </span><span class="number">0</span><span class="normal"> </span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	wxWindow</span><span class="symbol">*</span><span class="normal"> w </span><span class="symbol">=</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">	auinotebook</span><span class="symbol">-&gt;</span><span class="function">RemovePage</span><span class="symbol">(</span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">	w</span><span class="symbol">-&gt;</span><span class="function">Destroy</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    cpage </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    cpageid </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// Set up new container properties</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetGlobalUnencryptedProperty</span><span class="symbol">(</span><span class="string">"Author"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="function">wxGetUserId</span><span class="symbol">()));</span>

<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"CTime"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strTimeStampNow</span><span class="symbol">());</span>

<span class="normal">    </span><span class="comment">// Set up default config settings in container</span>

<span class="normal">    wpassgen</span><span class="symbol">-&gt;</span><span class="function">LoadDefaultSettings</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">UpdateMenuInsertPassword</span><span class="symbol">();</span>

<span class="normal">    </span><span class="comment">// Set up one empty text file in the container</span>
<span class="normal">    </span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> sf1 </span><span class="symbol">=</span><span class="normal"> container</span><span class="symbol">.</span><span class="function">AppendSubFile</span><span class="symbol">();</span>

<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sf1</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Name"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Untitled.txt"</span><span class="symbol">)));</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sf1</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Filetype"</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"text"</span><span class="symbol">);</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sf1</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Author"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="function">wxGetUserId</span><span class="symbol">()));</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sf1</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"CTime"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strTimeStampNow</span><span class="symbol">());</span>

<span class="normal">    </span><span class="comment">// use defaults from global properties</span>
<span class="normal">    </span><span class="type">long</span><span class="normal"> defcomp </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"DefaultCompression"</span><span class="symbol">)).</span><span class="function">ToLong</span><span class="symbol">(&amp;</span><span class="normal">defcomp</span><span class="symbol">))</span>
<span class="normal">	defcomp </span><span class="symbol">=</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">COMPRESSION_ZLIB</span><span class="symbol">;</span>

<span class="normal">    </span><span class="type">long</span><span class="normal"> defencr </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"DefaultEncryption"</span><span class="symbol">)).</span><span class="function">ToLong</span><span class="symbol">(&amp;</span><span class="normal">defencr</span><span class="symbol">))</span>
<span class="normal">	defencr </span><span class="symbol">=</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">ENCRYPTION_SERPENT256</span><span class="symbol">;</span>

<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileCompression</span><span class="symbol">(</span><span class="normal">sf1</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">compression_type</span><span class="symbol">)</span><span class="normal">defcomp</span><span class="symbol">);</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileEncryption</span><span class="symbol">(</span><span class="normal">sf1</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">encryption_type</span><span class="symbol">)</span><span class="normal">defencr</span><span class="symbol">);</span>

<span class="normal">    copt_restoreview </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>

<span class="normal">    filelistpane</span><span class="symbol">-&gt;</span><span class="function">ResetItems</span><span class="symbol">();</span>

<span class="normal">    </span><span class="function">OpenSubFile</span><span class="symbol">(</span><span class="normal">sf1</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">ShowFilelistPane</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">);</span>

<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"New container initialized."</span><span class="symbol">));</span>
<span class="normal">    </span><span class="function">UpdateTitle</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">UpdateModified</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">bool</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">ContainerOpen</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> filename</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> defpass</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">auto_ptr&lt;wxFile&gt;</span><span class="normal"> </span><span class="function">fh</span><span class="normal"> </span><span class="symbol">(</span><span class="keyword">new</span><span class="normal"> wxFile</span><span class="symbol">);</span>

<span class="preproc">#if</span><span class="normal"> </span><span class="function">defined</span><span class="symbol">(</span><span class="normal">__WINDOWS__</span><span class="symbol">)</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_sharelock</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="preproc">#if</span><span class="normal"> wxUSE_UNICODE</span>
<span class="normal">	</span><span class="type">int</span><span class="normal"> fd </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_wsopen</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> _O_RDONLY </span><span class="symbol">|</span><span class="normal"> _O_BINARY </span><span class="symbol">|</span><span class="normal"> _O_SEQUENTIAL</span><span class="symbol">,</span><span class="normal"> _SH_DENYRW</span><span class="symbol">);</span>
<span class="preproc">#else</span>
<span class="normal">	</span><span class="type">int</span><span class="normal"> fd </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_sopen</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> _O_RDONLY </span><span class="symbol">|</span><span class="normal"> _O_BINARY </span><span class="symbol">|</span><span class="normal"> _O_SEQUENTIAL</span><span class="symbol">,</span><span class="normal"> _SH_DENYRW</span><span class="symbol">);</span>
<span class="preproc">#endif</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">fd </span><span class="symbol">&lt;</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogSysError</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Cannot open file '%s'"</span><span class="symbol">),</span><span class="normal"> filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">());</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	fh</span><span class="symbol">-&gt;</span><span class="function">Attach</span><span class="symbol">(</span><span class="normal">fd</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">Open</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> wxFile</span><span class="symbol">::</span><span class="normal">read</span><span class="symbol">))</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="preproc">#elif</span><span class="normal"> </span><span class="function">defined</span><span class="symbol">(</span><span class="normal">__UNIX__</span><span class="symbol">)</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_sharelock</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// read_write is required to make a write-lock</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">Open</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> wxFile</span><span class="symbol">::</span><span class="normal">read_write</span><span class="symbol">))</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">	</span><span class="type">int</span><span class="normal"> lf </span><span class="symbol">=</span><span class="normal"> </span><span class="function">lockf</span><span class="symbol">(</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">fd</span><span class="symbol">(),</span><span class="normal"> F_TLOCK</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">lf </span><span class="symbol">!=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogSysError</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Cannot open file '%s'"</span><span class="symbol">),</span><span class="normal"> filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">());</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">Open</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> wxFile</span><span class="symbol">::</span><span class="normal">read</span><span class="symbol">))</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="preproc">#else</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">Open</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> wxFile</span><span class="symbol">::</span><span class="normal">read</span><span class="symbol">))</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="preproc">#endif</span>

<span class="normal">    Enctain</span><span class="symbol">::</span><span class="usertype">Container</span><span class="normal"> newcontainer</span><span class="symbol">;</span>
<span class="normal">    newcontainer</span><span class="symbol">.</span><span class="function">SetProgressIndicator</span><span class="symbol">(</span><span class="normal">statusbar</span><span class="symbol">);</span>
<span class="normal">    </span>
<span class="normal">    </span><span class="type">bool</span><span class="normal"> defpass_tried </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">while</span><span class="symbol">(</span><span class="number">1</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">wxString</span><span class="normal"> passstr</span><span class="symbol">;</span>

<span class="normal">	</span><span class="comment">// Only try defpass given on commandline once</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">defpass</span><span class="symbol">.</span><span class="function">IsEmpty</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">defpass_tried</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    passstr </span><span class="symbol">=</span><span class="normal"> defpass</span><span class="symbol">;</span>
<span class="normal">	    defpass_tried </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="usertype">WGetPassword</span><span class="normal"> </span><span class="function">passdlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> filename</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">passdlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">!=</span><span class="normal"> wxID_OK</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	    passstr </span><span class="symbol">=</span><span class="normal"> passdlg</span><span class="symbol">.</span><span class="function">GetPass</span><span class="symbol">();</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="keyword">try</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	    fh</span><span class="symbol">-&gt;</span><span class="function">Seek</span><span class="symbol">(</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxFromStart</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="usertype">wxFileInputStream</span><span class="normal"> </span><span class="function">stream</span><span class="symbol">(*</span><span class="normal">fh</span><span class="symbol">.</span><span class="function">get</span><span class="symbol">());</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">stream</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">	    </span><span class="usertype">DataInputStream</span><span class="normal"> </span><span class="function">datain</span><span class="symbol">(</span><span class="normal">stream</span><span class="symbol">);</span>
<span class="normal">	    newcontainer</span><span class="symbol">.</span><span class="function">Load</span><span class="symbol">(</span><span class="normal">datain</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="normal">passstr</span><span class="symbol">));</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">catch</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">Exception</span><span class="symbol">&amp;</span><span class="normal"> e</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">.</span><span class="function">code</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">ETE_LOAD_HEADER2_INVALID_KEY</span><span class="symbol">)</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="usertype">WMessageDialog</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span>
<span class="normal">				   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error loading container: could not read encrypted header.</span><span class="specialchar">\n</span><span class="string">Encryption key probably invalid. Retry?"</span><span class="symbol">),</span>
<span class="normal">				   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE"</span><span class="symbol">),</span>
<span class="normal">				   wxICON_ERROR</span><span class="symbol">,</span>
<span class="normal">				   wxID_YES</span><span class="symbol">,</span><span class="normal"> wxID_CANCEL</span><span class="symbol">);</span>

<span class="normal">		</span><span class="type">int</span><span class="normal"> id </span><span class="symbol">=</span><span class="normal"> dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">();</span>

<span class="normal">		</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">!=</span><span class="normal"> wxID_YES</span><span class="symbol">)</span>
<span class="normal">		    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">		</span><span class="keyword">continue</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	    </span><span class="keyword">else</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="function">wxMessageDialogErrorOK</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> </span><span class="function">EnctainExceptionString</span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">));</span>
<span class="normal">		</span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// Loading was successful</span>

<span class="normal">    container </span><span class="symbol">=</span><span class="normal"> newcontainer</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container_filehandle</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">delete</span><span class="normal"> container_filehandle</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    container_filehandle </span><span class="symbol">=</span><span class="normal"> fh</span><span class="symbol">.</span><span class="function">release</span><span class="symbol">();</span>

<span class="normal">    container_filename</span><span class="symbol">.</span><span class="function">Assign</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">);</span>
<span class="normal">    main_modified </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">HideQuickBars</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetUsedKeySlot</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&gt;=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"KeySlot-"</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> </span><span class="function">toSTLString</span><span class="symbol">(</span><span class="normal"> container</span><span class="symbol">.</span><span class="function">GetUsedKeySlot</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> </span><span class="string">"-ATime"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strTimeStampNow</span><span class="symbol">());</span>

<span class="normal">    </span><span class="comment">// load settings from global metadata</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// get settings into a wxMemoryInputStream</span>
<span class="normal">	</span><span class="keyword">const</span><span class="normal"> std</span><span class="symbol">::</span><span class="normal">string</span><span class="symbol">&amp;</span><span class="normal"> cfgstr </span><span class="symbol">=</span><span class="normal"> container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"Settings"</span><span class="symbol">);</span>

<span class="normal">	</span><span class="usertype">wxMemoryInputStream</span><span class="normal"> </span><span class="function">meminput</span><span class="symbol">(</span><span class="normal">cfgstr</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> cfgstr</span><span class="symbol">.</span><span class="function">size</span><span class="symbol">());</span>
<span class="normal">	</span><span class="usertype">wxFileConfig</span><span class="normal"> </span><span class="function">memcfg</span><span class="symbol">(</span><span class="normal">meminput</span><span class="symbol">);</span>

<span class="normal">	</span><span class="comment">// load all settings from the memory object</span>
<span class="normal">	wpassgen</span><span class="symbol">-&gt;</span><span class="function">LoadSettings</span><span class="symbol">(&amp;</span><span class="normal">memcfg</span><span class="symbol">);</span>
<span class="normal">	</span><span class="function">UpdateMenuInsertPassword</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// close all notebook pages</span>
<span class="normal">    </span><span class="keyword">while</span><span class="symbol">(</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&gt;</span><span class="normal"> </span><span class="number">0</span><span class="normal"> </span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	wxWindow</span><span class="symbol">*</span><span class="normal"> w </span><span class="symbol">=</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">	auinotebook</span><span class="symbol">-&gt;</span><span class="function">RemovePage</span><span class="symbol">(</span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">	w</span><span class="symbol">-&gt;</span><span class="function">Destroy</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    cpage </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    cpageid </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="symbol">;</span>

<span class="normal">    filelistpane</span><span class="symbol">-&gt;</span><span class="function">LoadProperties</span><span class="symbol">();</span>
<span class="normal">    filelistpane</span><span class="symbol">-&gt;</span><span class="function">ResetItems</span><span class="symbol">();</span>

<span class="normal">    </span><span class="function">RestoreOpenSubFilelist</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">CountSubFile</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">1</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">ShowFilelistPane</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">ShowFilelistPane</span><span class="symbol">(</span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="normal">wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Loaded container with %u subfiles from %s"</span><span class="symbol">),</span>
<span class="normal">				     container</span><span class="symbol">.</span><span class="function">CountSubFile</span><span class="symbol">(),</span><span class="normal"> container_filename</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">().</span><span class="function">c_str</span><span class="symbol">()));</span>
<span class="normal">    </span><span class="function">UpdateTitle</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">UpdateModified</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="type">bool</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">ContainerSaveAs</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> filename</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// save all notebook pages</span>
<span class="normal">    </span><span class="keyword">for</span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	WNotePage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">),</span><span class="normal"> WNotePage</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page</span><span class="symbol">)</span>
<span class="normal">	    page</span><span class="symbol">-&gt;</span><span class="function">PageSaveData</span><span class="symbol">();</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	    </span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Invalid notebook page found."</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// check that an encryption key is set</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">CountKeySlots</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">WSetPassword</span><span class="normal"> </span><span class="function">passdlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> filename</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">passdlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">!=</span><span class="normal"> wxID_OK</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">	</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> newslot </span><span class="symbol">=</span><span class="normal"> container</span><span class="symbol">.</span><span class="function">AddKeySlot</span><span class="symbol">(</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="normal">passdlg</span><span class="symbol">.</span><span class="function">GetPass</span><span class="symbol">())</span><span class="normal"> </span><span class="symbol">);</span>

<span class="normal">	</span><span class="comment">// Add key slot metadata.</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"KeySlot-"</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> </span><span class="function">toSTLString</span><span class="symbol">(</span><span class="normal">newslot</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> </span><span class="string">"-CTime"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strTimeStampNow</span><span class="symbol">());</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"KeySlot-"</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> </span><span class="function">toSTLString</span><span class="symbol">(</span><span class="normal">newslot</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> </span><span class="string">"-Description"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="normal">passdlg</span><span class="symbol">.</span><span class="function">GetDescription</span><span class="symbol">()));</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">   </span>
<span class="normal">    </span><span class="comment">// save settings to global metadata</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// create wxFileConfig object in memory</span>
<span class="normal">	</span><span class="usertype">wxMemoryInputStream</span><span class="normal"> </span><span class="function">memzero</span><span class="symbol">(</span><span class="normal">NULL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">	</span><span class="usertype">wxFileConfig</span><span class="normal"> </span><span class="function">memcfg</span><span class="symbol">(</span><span class="normal">memzero</span><span class="symbol">);</span>

<span class="normal">	</span><span class="comment">// save all settings to the memory object</span>
<span class="normal">	wpassgen</span><span class="symbol">-&gt;</span><span class="function">SaveSettings</span><span class="symbol">(&amp;</span><span class="normal">memcfg</span><span class="symbol">);</span>

<span class="normal">	</span><span class="comment">// save config memory output to global properties</span>
<span class="normal">	</span><span class="usertype">wxMemoryOutputStream</span><span class="normal"> memout</span><span class="symbol">;</span>
<span class="normal">	memcfg</span><span class="symbol">.</span><span class="function">Save</span><span class="symbol">(</span><span class="normal">memout</span><span class="symbol">);</span>

<span class="normal">	</span><span class="usertype">wxStreamBuffer</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">outstream </span><span class="symbol">=</span><span class="normal"> memout</span><span class="symbol">.</span><span class="function">GetOutputStreamBuffer</span><span class="symbol">();</span>
<span class="normal">	std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal"> </span><span class="function">cfgstr</span><span class="symbol">((</span><span class="type">char</span><span class="symbol">*)</span><span class="normal">outstream</span><span class="symbol">-&gt;</span><span class="function">GetBufferStart</span><span class="symbol">(),</span><span class="normal"> outstream</span><span class="symbol">-&gt;</span><span class="function">Tell</span><span class="symbol">());</span>

<span class="normal">	container</span><span class="symbol">.</span><span class="function">SetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"Settings"</span><span class="symbol">,</span><span class="normal"> cfgstr</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// release share lock</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container_filehandle</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">delete</span><span class="normal"> container_filehandle</span><span class="symbol">;</span>
<span class="normal">	container_filehandle </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_makebackups</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="type">int</span><span class="normal"> havebacks </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>

<span class="normal">	</span><span class="comment">// Look how many backup files are in the directory. backup = 0 is the</span>
<span class="normal">	</span><span class="comment">// current file in the directory.</span>
<span class="normal">	</span><span class="keyword">for</span><span class="symbol">(</span><span class="normal">havebacks </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> </span><span class="symbol">;</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">havebacks</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="usertype">wxFileName</span><span class="normal"> </span><span class="function">backname</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">havebacks </span><span class="symbol">!=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">		backname</span><span class="symbol">.</span><span class="function">SetName</span><span class="symbol">(</span><span class="normal">backname</span><span class="symbol">.</span><span class="function">GetName</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"-backup%d"</span><span class="symbol">),</span><span class="normal"> havebacks</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="cbracket">}</span>

<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">backname</span><span class="symbol">.</span><span class="function">FileExists</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	havebacks</span><span class="symbol">--;</span>
<span class="normal">	</span><span class="comment">// havebacks == last available backup or real file.</span>

<span class="normal">	</span><span class="comment">// Move backups one slot forwards</span>
<span class="normal">	</span><span class="keyword">while</span><span class="symbol">(</span><span class="normal">havebacks </span><span class="symbol">&gt;=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="usertype">wxFileName</span><span class="normal"> </span><span class="function">backname</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">havebacks </span><span class="symbol">!=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">		backname</span><span class="symbol">.</span><span class="function">SetName</span><span class="symbol">(</span><span class="normal">backname</span><span class="symbol">.</span><span class="function">GetName</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"-backup%d"</span><span class="symbol">),</span><span class="normal"> havebacks</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="cbracket">}</span>

<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">havebacks </span><span class="symbol">&gt;=</span><span class="normal"> prefs_backupnum </span><span class="symbol">&amp;&amp;</span><span class="normal"> havebacks </span><span class="symbol">!=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="comment">// superfluous backup file. delete it.</span>
<span class="normal">		</span><span class="function">wxRemoveFile</span><span class="symbol">(</span><span class="normal">backname</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">());</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	    </span><span class="keyword">else</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="comment">// move current backup file one slot forwards</span>
<span class="normal">		</span><span class="usertype">wxFileName</span><span class="normal"> </span><span class="function">nextbackname</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">);</span>
<span class="normal">		nextbackname</span><span class="symbol">.</span><span class="function">SetName</span><span class="symbol">(</span><span class="normal">nextbackname</span><span class="symbol">.</span><span class="function">GetName</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"-backup%d"</span><span class="symbol">),</span><span class="normal"> havebacks</span><span class="symbol">+</span><span class="number">1</span><span class="symbol">));</span>
<span class="normal">		</span>
<span class="normal">		</span><span class="function">wxRenameFile</span><span class="symbol">(</span><span class="normal">backname</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">(),</span><span class="normal"> nextbackname</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">(),</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="cbracket">}</span>

<span class="normal">	    havebacks</span><span class="symbol">--;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">auto_ptr&lt;wxFile&gt;</span><span class="normal"> </span><span class="function">fh</span><span class="normal"> </span><span class="symbol">(</span><span class="keyword">new</span><span class="normal"> wxFile</span><span class="symbol">);</span>
<span class="preproc">#if</span><span class="normal"> </span><span class="function">defined</span><span class="symbol">(</span><span class="normal">__WINDOWS__</span><span class="symbol">)</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_sharelock</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="preproc">#if</span><span class="normal"> wxUSE_UNICODE</span>
<span class="normal">	</span><span class="type">int</span><span class="normal"> fd </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_wsopen</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> _O_WRONLY </span><span class="symbol">|</span><span class="normal"> _O_CREAT </span><span class="symbol">|</span><span class="normal"> _O_BINARY </span><span class="symbol">|</span><span class="normal"> _O_SEQUENTIAL</span><span class="symbol">,</span><span class="normal"> _SH_DENYRW</span><span class="symbol">,</span><span class="normal"> _S_IREAD </span><span class="symbol">|</span><span class="normal"> _S_IWRITE</span><span class="symbol">);</span>
<span class="preproc">#else</span>
<span class="normal">	</span><span class="type">int</span><span class="normal"> fd </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_sopen</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> _O_WRONLY </span><span class="symbol">|</span><span class="normal"> _O_CREAT </span><span class="symbol">|</span><span class="normal"> _O_BINARY </span><span class="symbol">|</span><span class="normal"> _O_SEQUENTIAL</span><span class="symbol">,</span><span class="normal"> _SH_DENYRW</span><span class="symbol">,</span><span class="normal"> _S_IREAD </span><span class="symbol">|</span><span class="normal"> _S_IWRITE</span><span class="symbol">);</span>
<span class="preproc">#endif</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">fd </span><span class="symbol">&lt;</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogSysError</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Cannot create file '%s'"</span><span class="symbol">),</span><span class="normal"> filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">());</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	fh</span><span class="symbol">-&gt;</span><span class="function">Attach</span><span class="symbol">(</span><span class="normal">fd</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">Create</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">,</span><span class="normal"> wxS_DEFAULT</span><span class="symbol">))</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="preproc">#elif</span><span class="normal"> </span><span class="function">defined</span><span class="symbol">(</span><span class="normal">__UNIX__</span><span class="symbol">)</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_sharelock</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">Create</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">,</span><span class="normal"> </span><span class="number">02640</span><span class="symbol">))</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">	</span><span class="function">lockf</span><span class="symbol">(</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">fd</span><span class="symbol">(),</span><span class="normal"> F_LOCK</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">Create</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">,</span><span class="normal"> wxS_DEFAULT</span><span class="symbol">))</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="preproc">#else</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">fh</span><span class="symbol">-&gt;</span><span class="function">Create</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">,</span><span class="normal"> wxS_DEFAULT</span><span class="symbol">))</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="preproc">#endif</span>

<span class="normal">    </span><span class="usertype">wxFileOutputStream</span><span class="normal"> </span><span class="function">stream</span><span class="symbol">(*</span><span class="normal">fh</span><span class="symbol">.</span><span class="function">get</span><span class="symbol">());</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">stream</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"MTime"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strTimeStampNow</span><span class="symbol">());</span>
<span class="normal">    filelistpane</span><span class="symbol">-&gt;</span><span class="function">SaveProperties</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">SaveOpenSubFilelist</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">try</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">DataOutputStream</span><span class="normal"> </span><span class="function">dataout</span><span class="symbol">(</span><span class="normal">stream</span><span class="symbol">);</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">Save</span><span class="symbol">(</span><span class="normal">dataout</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">catch</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">Exception</span><span class="symbol">&amp;</span><span class="normal"> e</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">EnctainExceptionString</span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">));</span>
<span class="normal">	</span><span class="function">wxMessageDialogErrorOK</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> </span><span class="function">EnctainExceptionString</span><span class="symbol">(</span><span class="normal">e</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    container_filehandle </span><span class="symbol">=</span><span class="normal"> fh</span><span class="symbol">.</span><span class="function">release</span><span class="symbol">();</span>
<span class="normal">    container_filename</span><span class="symbol">.</span><span class="function">Assign</span><span class="symbol">(</span><span class="normal">filename</span><span class="symbol">);</span>
<span class="normal">    main_modified </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="normal">wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Saved container with %u subfiles to %s"</span><span class="symbol">),</span>
<span class="normal">				     container</span><span class="symbol">.</span><span class="function">CountSubFile</span><span class="symbol">(),</span><span class="normal"> container_filename</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">().</span><span class="function">c_str</span><span class="symbol">()));</span>
<span class="normal">    </span><span class="function">UpdateTitle</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">UpdateModified</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">SaveOpenSubFilelist</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">copt_restoreview</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	container</span><span class="symbol">.</span><span class="function">DeleteGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"SubFilesOpened"</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">const</span><span class="normal"> </span><span class="usertype">size_t</span><span class="normal"> pagenum </span><span class="symbol">=</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">();</span>

<span class="normal">    </span><span class="type">int</span><span class="normal"> sflist</span><span class="symbol">[</span><span class="normal">pagenum</span><span class="symbol">];</span>

<span class="normal">    </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> pagenum</span><span class="symbol">;</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	WNotePage</span><span class="symbol">*</span><span class="normal"> sel </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">),</span><span class="normal"> WNotePage</span><span class="symbol">);</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">sel</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    sflist</span><span class="symbol">[</span><span class="normal">pi</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">=</span><span class="normal"> sel</span><span class="symbol">-&gt;</span><span class="normal">subfileid</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Invalid notebook page found."</span><span class="symbol">));</span>
<span class="normal">	    sflist</span><span class="symbol">[</span><span class="normal">pi</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"SubFilesOpened"</span><span class="symbol">,</span><span class="normal"> std</span><span class="symbol">::</span><span class="function">string</span><span class="symbol">((</span><span class="type">char</span><span class="symbol">*)&amp;</span><span class="normal">sflist</span><span class="symbol">,</span><span class="normal"> pagenum </span><span class="symbol">*</span><span class="normal"> </span><span class="keyword">sizeof</span><span class="symbol">(</span><span class="type">int</span><span class="symbol">)));</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">RestoreOpenSubFilelist</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// retrieve value of restore view option</span>
<span class="normal">    </span><span class="type">unsigned</span><span class="normal"> </span><span class="type">long</span><span class="normal"> restoreview</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal"> </span><span class="symbol">!</span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"RestoreView"</span><span class="symbol">)).</span><span class="function">ToULong</span><span class="symbol">(&amp;</span><span class="normal">restoreview</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	restoreview </span><span class="symbol">=</span><span class="normal"> </span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    copt_restoreview </span><span class="symbol">=</span><span class="normal"> restoreview</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">copt_restoreview</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal"> str </span><span class="symbol">=</span><span class="normal"> container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"SubFilesOpened"</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">str</span><span class="symbol">.</span><span class="function">size</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">%</span><span class="normal"> </span><span class="number">4</span><span class="normal"> </span><span class="symbol">!=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Invalid list of open subfiles."</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">const</span><span class="normal"> </span><span class="type">int</span><span class="symbol">*</span><span class="normal"> sflist </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">reinterpret_cast</span><span class="symbol">&lt;</span><span class="keyword">const</span><span class="normal"> </span><span class="type">int</span><span class="symbol">*&gt;(</span><span class="normal">str</span><span class="symbol">.</span><span class="function">data</span><span class="symbol">());</span>
<span class="normal">    </span>
<span class="normal">    </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> str</span><span class="symbol">.</span><span class="function">size</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">/</span><span class="normal"> </span><span class="number">4</span><span class="symbol">;</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">OpenSubFile</span><span class="symbol">(</span><span class="normal">sflist</span><span class="symbol">[</span><span class="normal">pi</span><span class="symbol">]);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="keyword">static</span><span class="normal"> </span><span class="type">int</span><span class="normal"> </span><span class="function">CompareVersionStrings</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> a</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> b</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> ai </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> bi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">while</span><span class="symbol">(</span><span class="normal">ai </span><span class="symbol">&lt;</span><span class="normal"> a</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> bi </span><span class="symbol">&lt;</span><span class="normal"> b</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">())</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// find next non-number letter in both strings</span>
<span class="normal">	</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> aj </span><span class="symbol">=</span><span class="normal"> ai</span><span class="symbol">,</span><span class="normal"> bj </span><span class="symbol">=</span><span class="normal"> bi</span><span class="symbol">;</span>

<span class="normal">	</span><span class="keyword">while</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">aj </span><span class="symbol">&lt;</span><span class="normal"> a</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> </span><span class="function">wxIsdigit</span><span class="symbol">(</span><span class="normal">a</span><span class="symbol">[</span><span class="normal">aj</span><span class="symbol">]))</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">aj</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">while</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">bj </span><span class="symbol">&lt;</span><span class="normal"> b</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> </span><span class="function">wxIsdigit</span><span class="symbol">(</span><span class="normal">b</span><span class="symbol">[</span><span class="normal">bj</span><span class="symbol">]))</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">bj</span><span class="symbol">;</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">aj </span><span class="symbol">!=</span><span class="normal"> ai </span><span class="symbol">&amp;&amp;</span><span class="normal"> bj </span><span class="symbol">!=</span><span class="normal"> bi</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// compare two numbers</span>
<span class="normal">	    </span><span class="type">long</span><span class="normal"> av </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> bv </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">	    a</span><span class="symbol">.</span><span class="function">Mid</span><span class="symbol">(</span><span class="normal">ai</span><span class="symbol">,</span><span class="normal"> aj </span><span class="symbol">-</span><span class="normal"> ai</span><span class="symbol">).</span><span class="function">ToLong</span><span class="symbol">(&amp;</span><span class="normal">av</span><span class="symbol">);</span>
<span class="normal">	    b</span><span class="symbol">.</span><span class="function">Mid</span><span class="symbol">(</span><span class="normal">bi</span><span class="symbol">,</span><span class="normal"> bj </span><span class="symbol">-</span><span class="normal"> bi</span><span class="symbol">).</span><span class="function">ToLong</span><span class="symbol">(&amp;</span><span class="normal">bv</span><span class="symbol">);</span>

<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">av </span><span class="symbol">&gt;</span><span class="normal"> bv</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">av </span><span class="symbol">&lt;</span><span class="normal"> bv</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">+</span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span><span class="normal"> </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">aj </span><span class="symbol">==</span><span class="normal"> ai</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// first string has no number but second one does.</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">+</span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span><span class="normal"> </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">bj </span><span class="symbol">==</span><span class="normal"> bi</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// second string has no number but first one does.</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="comment">// check all non-number letters match in both strings</span>
<span class="normal">	</span><span class="keyword">while</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">aj </span><span class="symbol">&lt;</span><span class="normal"> a</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> bj </span><span class="symbol">&lt;</span><span class="normal"> b</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> </span>
<span class="normal">	       </span><span class="symbol">!</span><span class="function">wxIsdigit</span><span class="symbol">(</span><span class="normal">a</span><span class="symbol">[</span><span class="normal">aj</span><span class="symbol">])</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> </span><span class="symbol">!</span><span class="function">wxIsdigit</span><span class="symbol">(</span><span class="normal">b</span><span class="symbol">[</span><span class="normal">bj</span><span class="symbol">]))</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">a</span><span class="symbol">[</span><span class="normal">aj</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&gt;</span><span class="normal"> b</span><span class="symbol">[</span><span class="normal">bj</span><span class="symbol">])</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">a</span><span class="symbol">[</span><span class="normal">aj</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">&lt;</span><span class="normal"> b</span><span class="symbol">[</span><span class="normal">bj</span><span class="symbol">])</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">+</span><span class="number">1</span><span class="symbol">;</span>

<span class="normal">	    </span><span class="symbol">++</span><span class="normal">aj</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">bj</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	ai </span><span class="symbol">=</span><span class="normal"> aj</span><span class="symbol">,</span><span class="normal"> bi </span><span class="symbol">=</span><span class="normal"> bj</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// longer string wins</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">a</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&gt;</span><span class="normal"> b</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">a</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&lt;</span><span class="normal"> b</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="symbol">+</span><span class="number">1</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">WebUpdateCheck</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">webupdatecheck_running</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Opening HTTP connection to idlebox.net..."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="usertype">wxURL</span><span class="normal"> </span><span class="function">url</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"http://idlebox.net/2009/cryptote/updatecheck"</span><span class="symbol">));</span>

<span class="normal">    wxHTTP</span><span class="symbol">*</span><span class="normal"> httpconn </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(&amp;</span><span class="normal">url</span><span class="symbol">.</span><span class="function">GetProtocol</span><span class="symbol">(),</span><span class="normal"> wxHTTP</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">httpconn</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: could not create HTTP connection."</span><span class="symbol">));</span>
<span class="normal">	webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    httpconn</span><span class="symbol">-&gt;</span><span class="function">SetHeader</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"User-Agent"</span><span class="symbol">),</span>
<span class="normal">			wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"CryptoTE/%s WebUpdateCheck/0.1"</span><span class="symbol">),</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="normal">VERSION</span><span class="symbol">)));</span>
<span class="normal">    httpconn</span><span class="symbol">-&gt;</span><span class="function">SetTimeout</span><span class="symbol">(</span><span class="number">60</span><span class="symbol">);</span>

<span class="normal">    wxInputStream</span><span class="symbol">*</span><span class="normal"> is </span><span class="symbol">=</span><span class="normal"> url</span><span class="symbol">.</span><span class="function">GetInputStream</span><span class="symbol">();</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">is</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">switch</span><span class="symbol">(</span><span class="normal">url</span><span class="symbol">.</span><span class="function">GetProtocol</span><span class="symbol">().</span><span class="function">GetError</span><span class="symbol">())</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="label">	default:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: unknown error while opening connection."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_NOERR</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: no error while opening connection."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_NETERR</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: a generic network error occurred while opening connection."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_PROTERR</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: an error occurred during connection negotiation."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_CONNERR</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: failed to connect the server."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_INVVAL</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: invalid value while opening connection."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_NOHNDLR</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: no protocol handler found while opening connection."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_NOFILE</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: remote file not found."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_ABRT</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: action aborted."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> wxPROTO_RCNCT</span><span class="symbol">:</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: an error occurred during reconnection."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> filedata</span><span class="symbol">;</span>
<span class="normal">    </span><span class="type">char</span><span class="normal"> input</span><span class="symbol">[</span><span class="number">1024</span><span class="symbol">];</span>

<span class="normal">    </span><span class="keyword">while</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">is</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="normal">input</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">sizeof</span><span class="symbol">(</span><span class="normal">input</span><span class="symbol">)).</span><span class="function">LastRead</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&gt;</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	filedata</span><span class="symbol">.</span><span class="function">Append</span><span class="symbol">(</span><span class="normal"> </span><span class="function">wxString</span><span class="symbol">(</span><span class="normal">input</span><span class="symbol">,</span><span class="normal"> wxConvISO8859_1</span><span class="symbol">,</span><span class="normal"> is</span><span class="symbol">-&gt;</span><span class="function">LastRead</span><span class="symbol">())</span><span class="normal"> </span><span class="symbol">);</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">filedata</span><span class="symbol">.</span><span class="function">Len</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&gt;</span><span class="normal"> </span><span class="number">1048576</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: file is too large."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="keyword">delete</span><span class="normal"> is</span><span class="symbol">;</span>
<span class="normal">	    webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">delete</span><span class="normal"> is</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// Extract first line from data</span>
<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> firstline </span><span class="symbol">=</span><span class="normal"> filedata</span><span class="symbol">.</span><span class="function">BeforeFirst</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\n</span><span class="string">'</span><span class="symbol">));</span>
<span class="normal">    filedata </span><span class="symbol">=</span><span class="normal"> filedata</span><span class="symbol">.</span><span class="function">AfterFirst</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">'</span><span class="specialchar">\n</span><span class="string">'</span><span class="symbol">));</span>

<span class="normal">    </span><span class="comment">// Tokenize the first line</span>
<span class="normal">    </span><span class="usertype">wxStringTokenizer</span><span class="normal"> </span><span class="function">firstwords</span><span class="symbol">(</span><span class="normal">firstline</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">" "</span><span class="symbol">));</span>

<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> progname </span><span class="symbol">=</span><span class="normal"> firstwords</span><span class="symbol">.</span><span class="function">GetNextToken</span><span class="symbol">();</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">progname </span><span class="symbol">!=</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"CryptoTE"</span><span class="symbol">))</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Error in WebUpdateCheck: invalid version file."</span><span class="symbol">));</span>
<span class="normal">	webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> prognewversion </span><span class="symbol">=</span><span class="normal"> firstwords</span><span class="symbol">.</span><span class="function">GetNextToken</span><span class="symbol">();</span>

<span class="normal">    </span><span class="comment">// Newest version is checked against the last one confirmed by the user or</span>
<span class="normal">    </span><span class="comment">// by the current one itself.</span>
<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> progoldversion </span><span class="symbol">=</span><span class="normal"> prefs_webupdatecheck_version</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">progoldversion</span><span class="symbol">.</span><span class="function">IsEmpty</span><span class="symbol">())</span><span class="normal"> progoldversion </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="normal">VERSION</span><span class="symbol">);</span>

<span class="normal">    </span><span class="type">int</span><span class="normal"> cmp </span><span class="symbol">=</span><span class="normal"> </span><span class="function">CompareVersionStrings</span><span class="symbol">(</span><span class="normal">progoldversion</span><span class="symbol">,</span><span class="normal"> prognewversion</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cmp </span><span class="symbol">==</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"WebUpdateCheck: No new version available."</span><span class="symbol">));</span>
<span class="normal">	webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span><span class="normal"> </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cmp </span><span class="symbol">&lt;</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"WebUpdateCheck: Your version is newer than the publicly available one."</span><span class="symbol">));</span>
<span class="normal">	webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="comment">// else (cmp &gt; 0)</span>

<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"WebUpdateCheck: OK. New version is available!"</span><span class="symbol">));</span>

<span class="normal">    </span><span class="usertype">WWebUpdateCheck</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> firstline</span><span class="symbol">,</span><span class="normal"> filedata</span><span class="symbol">);</span>
<span class="normal">    </span><span class="type">int</span><span class="normal"> id </span><span class="symbol">=</span><span class="normal"> dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">();</span>

<span class="normal">    wxConfigBase</span><span class="symbol">*</span><span class="normal"> cfg </span><span class="symbol">=</span><span class="normal"> wxConfigBase</span><span class="symbol">::</span><span class="function">Get</span><span class="symbol">();</span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">SetPath</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"/cryptote"</span><span class="symbol">));</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">==</span><span class="normal"> wxID_OK</span><span class="symbol">)</span><span class="normal"> </span><span class="comment">// "OK"</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// Write newly seen version into config.</span>
<span class="normal">	prefs_webupdatecheck_version </span><span class="symbol">=</span><span class="normal"> prognewversion</span><span class="symbol">;</span>

<span class="normal">	cfg</span><span class="symbol">-&gt;</span><span class="function">Write</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"webupdatecheck_version"</span><span class="symbol">),</span><span class="normal"> prognewversion</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span><span class="normal"> </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">==</span><span class="normal"> wxID_NO</span><span class="symbol">)</span><span class="normal"> </span><span class="comment">// "Disable WebUpdateCheck"</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// Disable automatic check and confirm the new version.</span>
<span class="normal">	prefs_webupdatecheck </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	prefs_webupdatecheck_version </span><span class="symbol">=</span><span class="normal"> prognewversion</span><span class="symbol">;</span>

<span class="normal">	cfg</span><span class="symbol">-&gt;</span><span class="function">Write</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"webupdatecheck"</span><span class="symbol">),</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">	cfg</span><span class="symbol">-&gt;</span><span class="function">Write</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"webupdatecheck_version"</span><span class="symbol">),</span><span class="normal"> prognewversion</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span><span class="normal"> </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">==</span><span class="normal"> wxID_CANCEL</span><span class="symbol">)</span><span class="normal"> </span><span class="comment">// "Remind me again"</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// Do nothing.</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Flush</span><span class="symbol">();</span>

<span class="normal">    webupdatecheck_running </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="keyword">static</span><span class="normal"> </span><span class="keyword">inline</span><span class="normal"> wxMenuItem</span><span class="symbol">*</span><span class="normal"> </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="keyword">class</span><span class="normal"> </span><span class="classname">wxMenu</span><span class="symbol">*</span><span class="normal"> parentMenu</span><span class="symbol">,</span><span class="normal"> </span><span class="type">int</span><span class="normal"> id</span><span class="symbol">,</span>
<span class="normal">					 </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> text</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> helpString</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    wxMenuItem</span><span class="symbol">*</span><span class="normal"> mi </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxMenuItem</span><span class="symbol">(</span><span class="normal">parentMenu</span><span class="symbol">,</span><span class="normal"> id</span><span class="symbol">,</span><span class="normal"> text</span><span class="symbol">,</span><span class="normal"> helpString</span><span class="symbol">);</span>
<span class="normal">    mi</span><span class="symbol">-&gt;</span><span class="function">SetBitmap</span><span class="symbol">(</span><span class="normal"> BitmapCatalog</span><span class="symbol">::</span><span class="function">GetMenuBitmap</span><span class="symbol">(</span><span class="normal">id</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">    parentMenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">mi</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">return</span><span class="normal"> mi</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="normal">wxMenuBar</span><span class="symbol">*</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">CreateMenuBar</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> wxClassInfo</span><span class="symbol">*</span><span class="normal"> page</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// Construct MenuBar</span>

<span class="normal">    wxMenuBar</span><span class="symbol">*</span><span class="normal"> menubar </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenuBar</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// *** Container</span>

<span class="normal">    </span><span class="usertype">wxMenu</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">menuContainer </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> wxID_OPEN</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Open ...</span><span class="specialchar">\t</span><span class="string">Ctrl+O"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open an existing encrypted container in the editor."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> wxID_SAVE</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Save</span><span class="specialchar">\t</span><span class="string">Ctrl+S"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save the current encrypted container to disk."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> wxID_SAVEAS</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save &amp;as ...</span><span class="specialchar">\t</span><span class="string">Ctrl+Shift+S"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Choose a file name and save the current encrypted container to disk."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> wxID_REVERT</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Revert</span><span class="specialchar">\t</span><span class="string">Ctrl+Shift+W"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Revert the current container by reloading it from disk and losing all unsaved changes."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> wxID_CLOSE</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Close</span><span class="specialchar">\t</span><span class="string">Ctrl+Shift+N"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Close the current encrypted container."</span><span class="symbol">));</span>

<span class="normal">    menuContainer</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> myID_MENU_CONTAINER_SHOWLIST</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show &amp;SubFile List"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show list of subfiles contained in current encrypted container."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> wxID_PROPERTIES</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Properties ...</span><span class="specialchar">\t</span><span class="string">Alt+Enter"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show metadata properties of the encrypted container."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> myID_MENU_CONTAINER_PASSLIST</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Password &amp;List ..."</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"List and modify encryption password slots of the current container."</span><span class="symbol">));</span>

<span class="normal">    menuContainer</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> wxID_PREFERENCES</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Preferences ..."</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show CryptoTE preferences."</span><span class="symbol">));</span>

<span class="normal">    menuContainer</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> wxID_EXIT</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Quit</span><span class="specialchar">\t</span><span class="string">Alt+F4"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Exit CryptoTE."</span><span class="symbol">));</span>

<span class="normal">    menubar</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">menuContainer</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Container"</span><span class="symbol">));</span>

<span class="normal">    </span><span class="comment">// *** SubFile</span>

<span class="normal">    </span><span class="usertype">wxMenu</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">menuSubFile </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuSubFile</span><span class="symbol">,</span><span class="normal"> myID_MENU_SUBFILE_NEW</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;New Text SubFile</span><span class="specialchar">\t</span><span class="string">Ctrl+N"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Create a new empty text subfile in encrypted container."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuSubFile</span><span class="symbol">,</span><span class="normal"> myID_MENU_SUBFILE_IMPORT</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Import SubFile ...</span><span class="specialchar">\t</span><span class="string">Ctrl+I"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Import any file from disk into encrypted container."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuSubFile</span><span class="symbol">,</span><span class="normal"> myID_MENU_SUBFILE_EXPORT</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Export SubFile ...</span><span class="specialchar">\t</span><span class="string">Ctrl+E"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Export current subfile to disk."</span><span class="symbol">));</span>
<span class="normal"> </span>
<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuSubFile</span><span class="symbol">,</span><span class="normal"> myID_MENU_SUBFILE_PROPERTIES</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Properties ...</span><span class="specialchar">\t</span><span class="string">Alt+Shift+Enter"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show metadata properties of current subfile."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuSubFile</span><span class="symbol">,</span><span class="normal"> myID_MENU_SUBFILE_CLOSE</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Close SubFile</span><span class="specialchar">\t</span><span class="string">Ctrl+W"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Close the currently view subfile."</span><span class="symbol">));</span>

<span class="normal">    menubar</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">menuSubFile</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;SubFile"</span><span class="symbol">));</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page </span><span class="symbol">==</span><span class="normal"> </span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">))</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// *** Edit</span>

<span class="normal">	</span><span class="usertype">wxMenu</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">menuEdit </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_UNDO</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Undo</span><span class="specialchar">\t</span><span class="string">Ctrl+Z"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Undo the last change."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_REDO</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Redo</span><span class="specialchar">\t</span><span class="string">Ctrl+Shift+Z"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Redo the previously undone change."</span><span class="symbol">));</span>

<span class="normal">	menuEdit</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_CUT</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Cu&amp;t</span><span class="specialchar">\t</span><span class="string">Ctrl+X"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Cut selected text into clipboard."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_COPY</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Copy</span><span class="specialchar">\t</span><span class="string">Ctrl+C"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Copy selected text into clipboard."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_PASTE</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Paste</span><span class="specialchar">\t</span><span class="string">Ctrl+V"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Paste clipboard contents at the current text position."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_CLEAR</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Delete</span><span class="specialchar">\t</span><span class="string">Del"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Delete selected text."</span><span class="symbol">));</span>

<span class="normal">	menuEdit</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_QUICKFIND</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Quick-Find ...</span><span class="specialchar">\t</span><span class="string">Ctrl+F"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Find a string in the buffer."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_FIND</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Find ...</span><span class="specialchar">\t</span><span class="string">Ctrl+Shift+F"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open find dialog to search for a string in the buffer."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_REPLACE</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Replace ...</span><span class="specialchar">\t</span><span class="string">Ctrl+H"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open find and replace dialog to search for and replace a string in the buffer."</span><span class="symbol">));</span>

<span class="normal">	menuEdit</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_GOTO</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Go to line ...</span><span class="specialchar">\t</span><span class="string">Ctrl+G"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Jump to the entered line number."</span><span class="symbol">));</span>

<span class="normal">	menuEdit</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> wxID_SELECTALL</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Select all</span><span class="specialchar">\t</span><span class="string">Ctrl+A"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Select all text in the current buffer."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_SELECTLINE</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Select &amp;line</span><span class="specialchar">\t</span><span class="string">Ctrl+L"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Select whole line at the current cursor position."</span><span class="symbol">));</span>

<span class="normal">	menuEdit</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>
<span class="normal">	</span>
<span class="normal">	</span><span class="comment">// Create Password Generator Submenu</span>
<span class="normal">	wxMenu</span><span class="symbol">*</span><span class="normal"> passgenmenu </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>
<span class="normal"> </span>
<span class="normal">	passgenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_PASSWORD_DIALOG</span><span class="symbol">,</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open Generator Dialog ...</span><span class="specialchar">\t</span><span class="string">Ctrl+P"</span><span class="symbol">),</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open random generator dialog box and insert the generated password."</span><span class="symbol">));</span>

<span class="normal">	passgenmenu</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="comment">// Create wxMenuItem for PassGen Submenu</span>
<span class="normal">	wxMenuItem</span><span class="symbol">*</span><span class="normal"> passgenitem</span>
<span class="normal">	    </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_INSERT_PASSWORD</span><span class="symbol">,</span>
<span class="normal">			     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert &amp;Password"</span><span class="symbol">),</span>
<span class="normal">			     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert random password from generator preset or open generator dialog box."</span><span class="symbol">),</span>
<span class="normal">			     wxITEM_NORMAL</span><span class="symbol">,</span><span class="normal"> passgenmenu</span><span class="symbol">);</span>
<span class="normal">	</span>
<span class="normal">	passgenitem</span><span class="symbol">-&gt;</span><span class="function">SetBitmap</span><span class="symbol">(</span><span class="normal"> BitmapCatalog</span><span class="symbol">::</span><span class="function">GetMenuBitmap</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_PASSWORD</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">	menuEdit</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">passgenitem</span><span class="symbol">);</span>

<span class="normal">	</span><span class="comment">// Create Date/Time Generator Submenu</span>

<span class="normal">	wxMenu</span><span class="symbol">*</span><span class="normal"> dategenmenu </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>
<span class="normal"> </span>
<span class="normal">	dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_YYYYMMDD_HHMMSS</span><span class="symbol">,</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"YYYY-MM-DD HH:MM:SS"</span><span class="symbol">),</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date/time in YYYY-MM-DD HH:MM:SS (ISO 8601) format."</span><span class="symbol">));</span>

<span class="normal">	dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_YYYYMMDD</span><span class="symbol">,</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"YYYY-MM-DD"</span><span class="symbol">),</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date in YYYY-MM-DD (ISO 8601) format."</span><span class="symbol">));</span>

<span class="normal">	dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_HHMMSS</span><span class="symbol">,</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"HH:MM:SS"</span><span class="symbol">),</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local time in HH:MM:SS (ISO 8601) format."</span><span class="symbol">));</span>

<span class="normal">	dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE</span><span class="symbol">,</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Text Date/Time"</span><span class="symbol">),</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date/time in text format."</span><span class="symbol">));</span>

<span class="normal">	dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE_DATE</span><span class="symbol">,</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Text Date"</span><span class="symbol">),</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date in text format."</span><span class="symbol">));</span>

<span class="normal">	dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE_TIME</span><span class="symbol">,</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Text Time"</span><span class="symbol">),</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local time in text format."</span><span class="symbol">));</span>

<span class="normal">	dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_RFC822</span><span class="symbol">,</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"RFC 822 Date/Time"</span><span class="symbol">),</span>
<span class="normal">			    </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date/time in RFC 822 format."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="comment">// Create wxMenuItem for Date Generator Submenu</span>
<span class="normal">	wxMenuItem</span><span class="symbol">*</span><span class="normal"> dategenitem</span>
<span class="normal">	    </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_INSERT_DATETIME</span><span class="symbol">,</span>
<span class="normal">			     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert &amp;Date/Time"</span><span class="symbol">),</span>
<span class="normal">			     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current date/time."</span><span class="symbol">),</span>
<span class="normal">			     wxITEM_NORMAL</span><span class="symbol">,</span><span class="normal"> dategenmenu</span><span class="symbol">);</span>
<span class="normal">	</span>
<span class="normal">	dategenitem</span><span class="symbol">-&gt;</span><span class="function">SetBitmap</span><span class="symbol">(</span><span class="normal"> BitmapCatalog</span><span class="symbol">::</span><span class="function">GetMenuBitmap</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">	menuEdit</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">dategenitem</span><span class="symbol">);</span>

<span class="normal">	menubar</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Edit"</span><span class="symbol">));</span>

<span class="normal">	</span><span class="comment">// *** View</span>

<span class="normal">	</span><span class="usertype">wxMenu</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">menuView </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>

<span class="normal">	menuView</span><span class="symbol">-&gt;</span><span class="function">AppendCheckItem</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_LINEWRAP</span><span class="symbol">,</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Wrap long lines"</span><span class="symbol">),</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Wrap long lines in editor."</span><span class="symbol">));</span>

<span class="normal">	menuView</span><span class="symbol">-&gt;</span><span class="function">AppendCheckItem</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_LINENUMBER</span><span class="symbol">,</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show line &amp;numbers"</span><span class="symbol">),</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show line numbers on left margin."</span><span class="symbol">));</span>

<span class="normal">	menuView</span><span class="symbol">-&gt;</span><span class="function">AppendCheckItem</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_WHITESPACE</span><span class="symbol">,</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show white&amp;space"</span><span class="symbol">),</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show white space (space and tab) in buffer."</span><span class="symbol">));</span>

<span class="normal">	menuView</span><span class="symbol">-&gt;</span><span class="function">AppendCheckItem</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_ENDOFLINE</span><span class="symbol">,</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show &amp;end of line symbols"</span><span class="symbol">),</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show end of line symbols (new-line and carriage-return) in buffer."</span><span class="symbol">));</span>

<span class="normal">	menuView</span><span class="symbol">-&gt;</span><span class="function">AppendCheckItem</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_INDENTGUIDE</span><span class="symbol">,</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show &amp;indent guide lines"</span><span class="symbol">),</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show guide lines following the indention depth."</span><span class="symbol">));</span>

<span class="normal">	menuView</span><span class="symbol">-&gt;</span><span class="function">AppendCheckItem</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_LONGLINEGUIDE</span><span class="symbol">,</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show guide line at &amp;column 80"</span><span class="symbol">),</span>
<span class="normal">				  </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show guide line at column 80 to display over-long lines."</span><span class="symbol">));</span>

<span class="normal">	menuView</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// *** View -&gt; Zoom Level</span>

<span class="normal">	    </span><span class="usertype">wxMenu</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">menuZoom </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>

<span class="normal">	    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuZoom</span><span class="symbol">,</span><span class="normal"> myID_MENU_VIEW_ZOOM_INCREASE</span><span class="symbol">,</span>
<span class="normal">			   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Increase Zoom +1pt</span><span class="specialchar">\t</span><span class="string">Ctrl++"</span><span class="symbol">),</span>
<span class="normal">			   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Increase the font zoom size by one point."</span><span class="symbol">));</span>

<span class="normal">	    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuZoom</span><span class="symbol">,</span><span class="normal"> myID_MENU_VIEW_ZOOM_DECREASE</span><span class="symbol">,</span>
<span class="normal">			   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Decrease Zoom -1pt</span><span class="specialchar">\t</span><span class="string">Ctrl+-"</span><span class="symbol">),</span>
<span class="normal">			   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Decrease the font zoom size by one point."</span><span class="symbol">));</span>

<span class="normal">	    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuZoom</span><span class="symbol">,</span><span class="normal"> myID_MENU_VIEW_ZOOM_RESET</span><span class="symbol">,</span>
<span class="normal">			   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Reset Zoom</span><span class="specialchar">\t</span><span class="string">Ctrl+0"</span><span class="symbol">),</span>
<span class="normal">			   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Reset the font zoom size to the normal pointsize."</span><span class="symbol">));</span>

<span class="normal">	    wxMenuItem</span><span class="symbol">*</span><span class="normal"> zoomitem</span>
<span class="normal">		</span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> myID_MENU_VIEW_ZOOM</span><span class="symbol">,</span>
<span class="normal">				 </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Zoom Level ..."</span><span class="symbol">),</span>
<span class="normal">				 </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Change zoom level of text. Added or substracted to font point size."</span><span class="symbol">),</span>
<span class="normal">				 wxITEM_NORMAL</span><span class="symbol">,</span><span class="normal"> menuZoom</span><span class="symbol">);</span>
<span class="normal">	    zoomitem</span><span class="symbol">-&gt;</span><span class="function">SetBitmap</span><span class="symbol">(</span><span class="normal"> BitmapCatalog</span><span class="symbol">::</span><span class="function">GetMenuBitmap</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_ZOOM</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">	    menuView</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">zoomitem</span><span class="symbol">);</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	menubar</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">menuView</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;View"</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">page </span><span class="symbol">==</span><span class="normal"> </span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WBinaryPage</span><span class="symbol">))</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// *** Edit</span>

<span class="normal">	</span><span class="usertype">wxMenu</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">menuEdit </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>

<span class="normal">	</span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_GOTO</span><span class="symbol">,</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Go to Offset ...</span><span class="specialchar">\t</span><span class="string">Ctrl+G"</span><span class="symbol">),</span>
<span class="normal">		       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Jump to the entered offset."</span><span class="symbol">));</span>

<span class="normal">	menubar</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">menuEdit</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Edit"</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// *** Help</span>

<span class="normal">    </span><span class="usertype">wxMenu</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">menuHelp </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuHelp</span><span class="symbol">,</span><span class="normal"> myID_MENU_HELP_BROWSER</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show &amp;Help ..."</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show help document browser."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuHelp</span><span class="symbol">,</span><span class="normal"> myID_MENU_HELP_WEBUPDATECHECK</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Check for Update ..."</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Check online web page for updates to CryptoTE."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menuHelp</span><span class="symbol">,</span><span class="normal"> wxID_ABOUT</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;About ...</span><span class="specialchar">\t</span><span class="string">Shift+F1"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show some information about CryptoTE."</span><span class="symbol">));</span>

<span class="normal">    menubar</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">menuHelp</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Help"</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">UpdateMenuInsertPassword</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> menubar</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="keyword">static</span><span class="normal"> </span><span class="keyword">inline</span><span class="normal"> </span><span class="type">void</span><span class="normal"> </span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">wxToolBar</span><span class="symbol">*</span><span class="normal"> toolbar</span><span class="symbol">,</span><span class="normal"> </span><span class="type">int</span><span class="normal"> toolId</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> label</span><span class="symbol">,</span><span class="normal"> </span><span class="usertype">wxItemKind</span><span class="normal"> kind </span><span class="symbol">=</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> longHelpString </span><span class="symbol">=</span><span class="normal"> wxEmptyString</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    toolbar</span><span class="symbol">-&gt;</span><span class="function">AddTool</span><span class="symbol">(</span><span class="normal">toolId</span><span class="symbol">,</span><span class="normal"> label</span><span class="symbol">,</span>
<span class="normal">		     BitmapCatalog</span><span class="symbol">::</span><span class="function">GetToolbarBitmap</span><span class="symbol">(</span><span class="normal">toolId</span><span class="symbol">),</span><span class="normal"> wxNullBitmap</span><span class="symbol">,</span>
<span class="normal">		     kind</span><span class="symbol">,</span><span class="normal"> label</span><span class="symbol">,</span><span class="normal"> longHelpString</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">CreateToolBar</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">toolbar</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	toolbar </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxToolBar</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> wxDefaultSize</span><span class="symbol">,</span>
<span class="normal">				wxNO_BORDER </span><span class="symbol">|</span><span class="normal"> wxTB_HORIZONTAL </span><span class="symbol">|</span><span class="normal"> wxTB_FLAT </span><span class="symbol">|</span><span class="normal"> wxTB_NODIVIDER</span><span class="symbol">);</span>
<span class="normal">	toolbar</span><span class="symbol">-&gt;</span><span class="function">SetToolBitmapSize</span><span class="symbol">(</span><span class="function">wxSize</span><span class="symbol">(</span><span class="number">22</span><span class="symbol">,</span><span class="normal"> </span><span class="number">22</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	toolbar</span><span class="symbol">-&gt;</span><span class="function">ClearTools</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// *** Container</span>

<span class="normal">    </span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_OPEN</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open Container"</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">	       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open an existing encrypted container in the editor."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_SAVE</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save Container"</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">	       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save the current encrypted container to disk."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_SAVEAS</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save Container as ..."</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">	       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Choose a file name and save the current encrypted container to disk."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> myID_MENU_CONTAINER_SHOWLIST</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show SubFile List"</span><span class="symbol">),</span><span class="normal"> wxITEM_CHECK</span><span class="symbol">,</span>
<span class="normal">	       </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show list of subfiles contained in current encrypted container."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="comment">// *** SubFile</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage </span><span class="symbol">&amp;&amp;</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	toolbar</span><span class="symbol">-&gt;</span><span class="function">AddSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="comment">// *** Edit</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_UNDO</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Undo Operation"</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Undo the last change."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_REDO</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Redo Operation"</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Redo the previously undone change."</span><span class="symbol">));</span>

<span class="normal">	toolbar</span><span class="symbol">-&gt;</span><span class="function">AddSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_CUT</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Cut Selection"</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Cut selected text into clipboard."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_COPY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Copy Selection"</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Copy selected text into clipboard."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_PASTE</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Paste Clipboard"</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Paste clipboard contents at the current text position."</span><span class="symbol">));</span>

<span class="normal">	toolbar</span><span class="symbol">-&gt;</span><span class="function">AddSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_FIND</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Find Text ..."</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open find dialog to search for a string in the buffer."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> wxID_REPLACE</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Find and Replace Text ..."</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open find and replace dialog to search for and replace a string in the buffer."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_GOTO</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Goto to Line ..."</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Jump to the entered line number."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> myID_TOOL_EDIT_INSERT_PASSWORD</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert Password ..."</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert random password from generator preset or open generator dialog box."</span><span class="symbol">));</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> myID_TOOL_EDIT_INSERT_DATETIME</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert Date/Time ..."</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current date/time."</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage </span><span class="symbol">&amp;&amp;</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WBinaryPage</span><span class="symbol">)))</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	toolbar</span><span class="symbol">-&gt;</span><span class="function">AddSeparator</span><span class="symbol">();</span>

<span class="normal">	</span><span class="comment">// *** Edit</span>

<span class="normal">	</span><span class="function">appendTool</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_GOTO</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Goto to Offset ..."</span><span class="symbol">),</span><span class="normal"> wxITEM_NORMAL</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Jump to the entered offset."</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// *** Help</span>

<span class="normal">    toolbar</span><span class="symbol">-&gt;</span><span class="function">Realize</span><span class="symbol">();</span>

<span class="normal">    wxAuiPaneInfo</span><span class="symbol">&amp;</span><span class="normal"> toolpane </span><span class="symbol">=</span><span class="normal"> auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">toolpane</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	toolpane</span><span class="symbol">.</span><span class="function">BestSize</span><span class="symbol">(</span><span class="normal">toolbar</span><span class="symbol">-&gt;</span><span class="function">GetBestSize</span><span class="symbol">());</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="comment">// *** Preference Variables ***</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">LoadPreferences</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    wxConfigBase</span><span class="symbol">*</span><span class="normal"> cfg </span><span class="symbol">=</span><span class="normal"> wxConfigBase</span><span class="symbol">::</span><span class="function">Get</span><span class="symbol">();</span>

<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">SetPath</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"/cryptote"</span><span class="symbol">));</span>
<span class="normal">    </span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"bitmaptheme"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_bitmaptheme</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>

<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"backups"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_makebackups</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"backupnum"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_backupnum</span><span class="symbol">,</span><span class="normal"> </span><span class="number">5</span><span class="symbol">);</span>

<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"autoclose"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_autoclose</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"autoclosetime"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_autoclosetime</span><span class="symbol">,</span><span class="normal"> </span><span class="number">15</span><span class="symbol">);</span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"autocloseexit"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_autocloseexit</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>

<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"sharelock"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_sharelock</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>

<span class="preproc">#ifndef</span><span class="normal"> DISABLE_WEBUPDATECHECK</span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"webupdatecheck"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_webupdatecheck</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="preproc">#else</span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"webupdatecheck"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_webupdatecheck</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="preproc">#endif</span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"webupdatecheck_time"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_webupdatecheck_time</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    cfg</span><span class="symbol">-&gt;</span><span class="function">Read</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"webupdatecheck_version"</span><span class="symbol">),</span><span class="normal"> </span><span class="symbol">&amp;</span><span class="normal">prefs_webupdatecheck_version</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="comment">// *** Generic Events ***</span>

<span class="type">bool</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">AllowCloseModified</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">IsModified</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">while</span><span class="symbol">(</span><span class="number">1</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">wxString</span><span class="normal"> closestr</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container_filename</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span>
<span class="normal">	    closestr </span><span class="symbol">=</span><span class="normal"> wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save modified container </span><span class="specialchar">\"</span><span class="string">%s</span><span class="specialchar">\"</span><span class="string">?"</span><span class="symbol">),</span><span class="normal"> container_filename</span><span class="symbol">.</span><span class="function">GetFullName</span><span class="symbol">().</span><span class="function">c_str</span><span class="symbol">());</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	    closestr </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save untitled modified container?"</span><span class="symbol">);</span>

<span class="normal">	</span><span class="usertype">WMessageDialog</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> closestr</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Close CryptoTE"</span><span class="symbol">),</span>
<span class="normal">			   wxICON_WARNING</span><span class="symbol">,</span>
<span class="normal">			   wxID_SAVE</span><span class="symbol">,</span><span class="normal"> wxID_NO</span><span class="symbol">,</span><span class="normal"> wxID_CANCEL</span><span class="symbol">);</span>

<span class="normal">	</span><span class="type">int</span><span class="normal"> id </span><span class="symbol">=</span><span class="normal"> dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">();</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">==</span><span class="normal"> wxID_SAVE</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="function">UserContainerSave</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">==</span><span class="normal"> wxID_NO</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">==</span><span class="normal"> wxID_CANCEL</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnClose</span><span class="symbol">(</span><span class="normal">wxCloseEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">event</span><span class="symbol">.</span><span class="function">CanVeto</span><span class="symbol">())</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">Destroy</span><span class="symbol">();</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="function">AllowCloseModified</span><span class="symbol">())</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">Destroy</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	event</span><span class="symbol">.</span><span class="function">Veto</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="comment">// *** Menu Events ***</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerOpen</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">UserContainerOpen</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">bool</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UserContainerOpen</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">AllowCloseModified</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxFileDialog</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span>
<span class="normal">		     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open Container"</span><span class="symbol">),</span><span class="normal"> wxEmptyString</span><span class="symbol">,</span><span class="normal"> wxEmptyString</span><span class="symbol">,</span>
<span class="normal">		     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Encrypted Container (*.ect)|*.ect"</span><span class="symbol">),</span>
<span class="normal">                     wxFD_OPEN </span><span class="symbol">|</span><span class="normal"> wxFD_FILE_MUST_EXIST</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">!=</span><span class="normal"> wxID_OK</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="function">ContainerOpen</span><span class="symbol">(</span><span class="normal"> dlg</span><span class="symbol">.</span><span class="function">GetPath</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerSave</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">UserContainerSave</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">bool</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UserContainerSave</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">container_filename</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">return</span><span class="normal"> </span><span class="function">UserContainerSaveAs</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="function">ContainerSaveAs</span><span class="symbol">(</span><span class="normal"> container_filename</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerSaveAs</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">UserContainerSaveAs</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">bool</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UserContainerSaveAs</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">wxFileDialog</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span>
<span class="normal">		     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save Container"</span><span class="symbol">),</span><span class="normal"> wxEmptyString</span><span class="symbol">,</span><span class="normal"> container_filename</span><span class="symbol">.</span><span class="function">GetFullName</span><span class="symbol">(),</span>
<span class="normal">		     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Encrypted Container (*.ect)|*.ect"</span><span class="symbol">),</span>
<span class="normal">		     wxFD_SAVE </span><span class="symbol">|</span><span class="normal"> wxFD_OVERWRITE_PROMPT</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">!=</span><span class="normal"> wxID_OK</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxFileName</span><span class="normal"> </span><span class="function">fname</span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">GetPath</span><span class="symbol">());</span>

<span class="normal">    </span><span class="comment">// set extension .ect if none was entered and the file dialog filter is set.</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">fname</span><span class="symbol">.</span><span class="function">GetExt</span><span class="symbol">().</span><span class="function">IsEmpty</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> dlg</span><span class="symbol">.</span><span class="function">GetFilterIndex</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	fname</span><span class="symbol">.</span><span class="function">SetExt</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">"ect"</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="function">ContainerSaveAs</span><span class="symbol">(</span><span class="normal"> fname</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerRevert</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">AllowCloseModified</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">container_filename</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">ContainerNew</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">ContainerOpen</span><span class="symbol">(</span><span class="normal"> container_filename</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerClose</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">AllowCloseModified</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">ContainerNew</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerShowList</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">ShowFilelistPane</span><span class="symbol">(</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">filelistpane</span><span class="symbol">).</span><span class="function">IsShown</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerProperties</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">WContainerProperties</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> wxID_OK</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">SetModified</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerPasswordList</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">WPasswordList</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>
<span class="normal">    dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerPreferences</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">WPreferences</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> wxID_OK</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">LoadPreferences</span><span class="symbol">();</span>

<span class="normal">	</span><span class="function">Freeze</span><span class="symbol">();</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_bitmaptheme </span><span class="symbol">!=</span><span class="normal"> BitmapCatalog</span><span class="symbol">::</span><span class="function">GetSingleton</span><span class="symbol">()-&gt;</span><span class="function">GetCurrentTheme</span><span class="symbol">())</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// reload all images</span>
<span class="normal">	    BitmapCatalog</span><span class="symbol">::</span><span class="function">GetSingleton</span><span class="symbol">()-&gt;</span><span class="function">SetTheme</span><span class="symbol">(</span><span class="normal">prefs_bitmaptheme</span><span class="symbol">);</span>

<span class="normal">	    </span><span class="comment">// Rebuild menus</span>
<span class="normal">	    </span><span class="function">SetMenuBar</span><span class="symbol">(</span><span class="normal">NULL</span><span class="symbol">);</span>

<span class="normal">	    menubar_plain </span><span class="symbol">=</span><span class="normal"> </span><span class="function">CreateMenuBar</span><span class="symbol">(</span><span class="normal">NULL</span><span class="symbol">);</span>
<span class="normal">	    menubar_textpage </span><span class="symbol">=</span><span class="normal"> </span><span class="function">CreateMenuBar</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">));</span>
<span class="normal">	    menubar_binarypage </span><span class="symbol">=</span><span class="normal"> </span><span class="function">CreateMenuBar</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WBinaryPage</span><span class="symbol">));</span>

<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		menubar_active </span><span class="symbol">=</span><span class="normal"> menubar_textpage</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	    </span><span class="keyword">else</span><span class="normal"> </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WBinaryPage</span><span class="symbol">)))</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		menubar_active </span><span class="symbol">=</span><span class="normal"> menubar_binarypage</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	    </span><span class="keyword">else</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		menubar_active </span><span class="symbol">=</span><span class="normal"> menubar_plain</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="cbracket">}</span>

<span class="normal">	    </span><span class="function">SetMenuBar</span><span class="symbol">(</span><span class="normal">menubar_active</span><span class="symbol">);</span>
<span class="normal">	    </span>
<span class="normal">	    </span><span class="function">CreateToolBar</span><span class="symbol">();</span>

<span class="normal">	    </span><span class="comment">// Force page and others to update their menu item status</span>

<span class="normal">	    menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_EXPORT</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">	    menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_PROPERTIES</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">	    menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_CLOSE</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>

<span class="normal">	    </span><span class="function">UpdateModified</span><span class="symbol">();</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">PageFocused</span><span class="symbol">();</span>

<span class="normal">	    </span><span class="comment">// QuickFind and Goto Panes</span>

<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">)</span><span class="normal"> quickfindbar</span><span class="symbol">-&gt;</span><span class="function">set_bitmaps</span><span class="symbol">();</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">)</span><span class="normal"> quickgotobar</span><span class="symbol">-&gt;</span><span class="function">set_bitmaps</span><span class="symbol">();</span>

<span class="normal">	    filelistpane</span><span class="symbol">-&gt;</span><span class="function">BuildImageList</span><span class="symbol">();</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="comment">// no need to check if idle timer changed, the user's mouse click will</span>
<span class="normal">	</span><span class="comment">// have reset the timer anyway.</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">prefs_sharelock</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// release file handle and thus the lock if it exists.</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">container_filehandle</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="keyword">delete</span><span class="normal"> container_filehandle</span><span class="symbol">;</span>
<span class="normal">		container_filehandle </span><span class="symbol">=</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="function">Thaw</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuContainerQuit</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">Close</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuSubFileNew</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// Set up an empty text file in the container</span>
<span class="normal">    </span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> sfnew </span><span class="symbol">=</span><span class="normal"> container</span><span class="symbol">.</span><span class="function">AppendSubFile</span><span class="symbol">();</span>
<span class="normal">    </span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Name"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Untitled.txt"</span><span class="symbol">)));</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Filetype"</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"text"</span><span class="symbol">);</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Author"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strWX2STL</span><span class="symbol">(</span><span class="function">wxGetUserId</span><span class="symbol">()));</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileProperty</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"CTime"</span><span class="symbol">,</span><span class="normal"> </span><span class="function">strTimeStampNow</span><span class="symbol">());</span>

<span class="normal">    </span><span class="comment">// use defaults from global properties</span>

<span class="normal">    </span><span class="type">long</span><span class="normal"> defcomp </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"DefaultCompression"</span><span class="symbol">)).</span><span class="function">ToLong</span><span class="symbol">(&amp;</span><span class="normal">defcomp</span><span class="symbol">))</span>
<span class="normal">	defcomp </span><span class="symbol">=</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">COMPRESSION_ZLIB</span><span class="symbol">;</span>

<span class="normal">    </span><span class="type">long</span><span class="normal"> defencr </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetGlobalEncryptedProperty</span><span class="symbol">(</span><span class="string">"DefaultEncryption"</span><span class="symbol">)).</span><span class="function">ToLong</span><span class="symbol">(&amp;</span><span class="normal">defencr</span><span class="symbol">))</span>
<span class="normal">	defencr </span><span class="symbol">=</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">ENCRYPTION_SERPENT256</span><span class="symbol">;</span>

<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileCompression</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">compression_type</span><span class="symbol">)</span><span class="normal">defcomp</span><span class="symbol">);</span>
<span class="normal">    container</span><span class="symbol">.</span><span class="function">SetSubFileEncryption</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">,</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">Enctain</span><span class="symbol">::</span><span class="normal">encryption_type</span><span class="symbol">)</span><span class="normal">defencr</span><span class="symbol">);</span>

<span class="normal">    filelistpane</span><span class="symbol">-&gt;</span><span class="function">ResetItems</span><span class="symbol">();</span>

<span class="normal">    </span><span class="function">OpenSubFile</span><span class="symbol">(</span><span class="normal">sfnew</span><span class="symbol">);</span>

<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Created new empty text subfile in container."</span><span class="symbol">));</span>
<span class="normal">    </span><span class="function">SetModified</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuSubFileImport</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">wxFileDialog</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span>
<span class="normal">		     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Import File(s)"</span><span class="symbol">),</span><span class="normal"> wxEmptyString</span><span class="symbol">,</span><span class="normal"> wxEmptyString</span><span class="symbol">,</span>
<span class="normal">		     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Text File (*.txt)|*.txt|Any Text File (*.txt;*)|*.txt;*|Any Binary File (*)|*"</span><span class="symbol">),</span>
<span class="normal">                     wxFD_OPEN </span><span class="symbol">|</span><span class="normal"> wxFD_FILE_MUST_EXIST </span><span class="symbol">|</span><span class="normal"> wxFD_MULTIPLE</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">!=</span><span class="normal"> wxID_OK</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxArrayString</span><span class="normal"> importlist</span><span class="symbol">;</span>
<span class="normal">    dlg</span><span class="symbol">.</span><span class="function">GetPaths</span><span class="symbol">(</span><span class="normal">importlist</span><span class="symbol">);</span>

<span class="normal">    std</span><span class="symbol">::</span><span class="usertype">string</span><span class="normal"> filetype</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">GetFilterIndex</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">0</span><span class="normal"> </span><span class="symbol">||</span><span class="normal"> dlg</span><span class="symbol">.</span><span class="function">GetFilterIndex</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">1</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	filetype </span><span class="symbol">=</span><span class="normal"> </span><span class="string">"text"</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="function">ImportSubFiles</span><span class="symbol">(</span><span class="normal">importlist</span><span class="symbol">,</span><span class="normal"> filetype</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuSubFileExport</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="normal">subfileid </span><span class="symbol">&lt;</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> suggestname </span><span class="symbol">=</span><span class="normal"> </span><span class="function">strSTL2WX</span><span class="symbol">(</span><span class="normal">container</span><span class="symbol">.</span><span class="function">GetSubFileProperty</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="normal">subfileid</span><span class="symbol">,</span><span class="normal"> </span><span class="string">"Name"</span><span class="symbol">));</span>

<span class="normal">    </span><span class="usertype">wxFileDialog</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span>
<span class="normal">		     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Save SubFile"</span><span class="symbol">),</span><span class="normal"> wxEmptyString</span><span class="symbol">,</span><span class="normal"> suggestname</span><span class="symbol">,</span>
<span class="normal">		     </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Any file (*)|*"</span><span class="symbol">),</span>
<span class="normal">		     wxFD_SAVE </span><span class="symbol">|</span><span class="normal"> wxFD_OVERWRITE_PROMPT</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">!=</span><span class="normal"> wxID_OK</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxFile</span><span class="normal"> </span><span class="function">outfile</span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">GetPath</span><span class="symbol">(),</span><span class="normal"> wxFile</span><span class="symbol">::</span><span class="normal">write</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">outfile</span><span class="symbol">.</span><span class="function">IsOpened</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">wxFileOutputStream</span><span class="normal"> </span><span class="function">outstream</span><span class="symbol">(</span><span class="normal">outfile</span><span class="symbol">);</span>
<span class="normal">	</span><span class="function">ExportSubFile</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="normal">subfileid</span><span class="symbol">,</span><span class="normal"> outstream</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="normal">wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Wrote %u bytes from subfile </span><span class="specialchar">\"</span><span class="string">%s</span><span class="specialchar">\"</span><span class="string"> to %s"</span><span class="symbol">),</span>
<span class="normal">				     </span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="symbol">)(</span><span class="normal">outfile</span><span class="symbol">.</span><span class="function">Tell</span><span class="symbol">()),</span>
<span class="normal">				     suggestname</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">(),</span>
<span class="normal">				     dlg</span><span class="symbol">.</span><span class="function">GetPath</span><span class="symbol">().</span><span class="function">c_str</span><span class="symbol">()));</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuSubFileProperties</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="normal">subfileid </span><span class="symbol">&lt;</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">WFileProperties</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="normal">subfileid</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> wxID_OK</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">UpdateSubFileCaption</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="normal">subfileid</span><span class="symbol">);</span>
<span class="normal">	</span><span class="function">SetModified</span><span class="symbol">();</span>

<span class="normal">	filelistpane</span><span class="symbol">-&gt;</span><span class="function">UpdateItem</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="normal">subfileid</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuSubFileClose</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageIndex</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">pi </span><span class="symbol">==</span><span class="normal"> wxNOT_FOUND</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="comment">// PageClose event is not generated by wxAuiNotebook</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">1</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// will be empty after the last page is closed</span>
<span class="normal">	</span><span class="function">UpdateNotebookPageChanged</span><span class="symbol">(-</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> NULL</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    auinotebook</span><span class="symbol">-&gt;</span><span class="function">DeletePage</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuEditGeneric</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// This is actually very dangerous: the page window MUST process the event</span>
<span class="normal">    </span><span class="comment">// otherwise it will be passed up to the parent window, and will be caught</span>
<span class="normal">    </span><span class="comment">// by this event handler and passed down again, creating an infinite loop.</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage </span><span class="symbol">&amp;&amp;</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	cpage</span><span class="symbol">-&gt;</span><span class="function">ProcessEvent</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuEditQuickFind</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">,</span><span class="normal"> WTextPage</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickfindbar_visible</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// pushing Ctrl+F again is equivalent to Search-Next</span>

<span class="normal">        </span><span class="usertype">wxString</span><span class="normal"> findtext </span><span class="symbol">=</span><span class="normal"> quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">GetValue</span><span class="symbol">();</span>

<span class="normal">        page</span><span class="symbol">-&gt;</span><span class="function">PrepareQuickFind</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>

<span class="normal">        page</span><span class="symbol">-&gt;</span><span class="function">DoQuickFind</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">,</span><span class="normal"> findtext</span><span class="symbol">);</span>

<span class="normal">        quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">        quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">SetSelection</span><span class="symbol">(-</span><span class="number">1</span><span class="symbol">,-</span><span class="number">1</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">quickfindbar</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// create Quick-Find bar</span>

<span class="normal">	    quickfindbar </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WQuickFindBar</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">	    auimgr</span><span class="symbol">.</span><span class="function">AddPane</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxAuiPaneInfo</span><span class="symbol">().</span><span class="function">Hide</span><span class="symbol">().</span>
<span class="normal">			   </span><span class="function">Name</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">"quickfindbar"</span><span class="symbol">)).</span><span class="function">Caption</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Quick-Find"</span><span class="symbol">)).</span>
<span class="normal">			   </span><span class="function">CaptionVisible</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">PaneBorder</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">Row</span><span class="symbol">(</span><span class="number">10</span><span class="symbol">).</span>
<span class="normal">			   </span><span class="function">Bottom</span><span class="symbol">().</span><span class="function">Gripper</span><span class="symbol">().</span>
<span class="preproc">#if</span><span class="normal"> </span><span class="function">wxCHECK_VERSION</span><span class="symbol">(</span><span class="number">2</span><span class="symbol">,</span><span class="number">8</span><span class="symbol">,</span><span class="number">7</span><span class="symbol">)</span>
<span class="normal">			   </span><span class="function">DockFixed</span><span class="symbol">().</span>
<span class="preproc">#else</span>
<span class="normal">			   </span><span class="function">Dock</span><span class="symbol">().</span>
<span class="preproc">#endif</span>
<span class="normal">			   </span><span class="function">LeftDockable</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">RightDockable</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">));</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="comment">// make Quick-Find bar visible</span>

<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">).</span><span class="function">Show</span><span class="symbol">();</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">)</span><span class="normal"> auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	quickgotobar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	quickfindbar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>

<span class="normal">	page</span><span class="symbol">-&gt;</span><span class="function">PrepareQuickFind</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>

<span class="normal">	quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">	quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">SetValue</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">""</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuEditGoto</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickgotobar_visible</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	quickgotobar</span><span class="symbol">-&gt;</span><span class="normal">textctrlGoto</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">quickgotobar</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// create Quick-Goto bar</span>

<span class="normal">	    quickgotobar </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WQuickGotoBar</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">	    auimgr</span><span class="symbol">.</span><span class="function">AddPane</span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxAuiPaneInfo</span><span class="symbol">().</span><span class="function">Hide</span><span class="symbol">().</span>
<span class="normal">			   </span><span class="function">Name</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">"quickgotobar"</span><span class="symbol">)).</span><span class="function">Caption</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Quick-Goto"</span><span class="symbol">)).</span>
<span class="normal">			   </span><span class="function">CaptionVisible</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">PaneBorder</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">Row</span><span class="symbol">(</span><span class="number">10</span><span class="symbol">).</span>
<span class="normal">			   </span><span class="function">Bottom</span><span class="symbol">().</span><span class="function">Gripper</span><span class="symbol">().</span>
<span class="preproc">#if</span><span class="normal"> </span><span class="function">wxCHECK_VERSION</span><span class="symbol">(</span><span class="number">2</span><span class="symbol">,</span><span class="number">8</span><span class="symbol">,</span><span class="number">7</span><span class="symbol">)</span>
<span class="normal">			   </span><span class="function">DockFixed</span><span class="symbol">().</span>
<span class="preproc">#else</span>
<span class="normal">			   </span><span class="function">Dock</span><span class="symbol">().</span>
<span class="preproc">#endif</span>
<span class="normal">			   </span><span class="function">LeftDockable</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">RightDockable</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">));</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="comment">// make Quick-Goto bar visible</span>

<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">).</span><span class="function">Show</span><span class="symbol">();</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickfindbar_visible</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">            </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">StopQuickFind</span><span class="symbol">();</span>
<span class="normal">            auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">        </span><span class="cbracket">}</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	quickfindbar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	quickgotobar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">;</span>

<span class="normal">	quickgotobar</span><span class="symbol">-&gt;</span><span class="normal">textctrlGoto</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">)</span><span class="normal"> quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">SetValue</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">""</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuEditInsertPassword</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">,</span><span class="normal"> WTextPage</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    wpassgen</span><span class="symbol">-&gt;</span><span class="function">Centre</span><span class="symbol">();</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">wpassgen</span><span class="symbol">-&gt;</span><span class="function">ShowModal</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> wxID_OK</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">wxArrayString</span><span class="normal"> arrstr </span><span class="symbol">=</span><span class="normal"> wpassgen</span><span class="symbol">-&gt;</span><span class="function">GetSelectedPassword</span><span class="symbol">();</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">arrstr</span><span class="symbol">.</span><span class="function">GetCount</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">1</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    page</span><span class="symbol">-&gt;</span><span class="function">AddText</span><span class="symbol">(</span><span class="normal">arrstr</span><span class="symbol">[</span><span class="number">0</span><span class="symbol">]);</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="usertype">size_t</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> arrstr</span><span class="symbol">.</span><span class="function">GetCount</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		page</span><span class="symbol">-&gt;</span><span class="function">AddText</span><span class="symbol">(</span><span class="normal">wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"%d %s</span><span class="specialchar">\n</span><span class="string">"</span><span class="symbol">),</span><span class="normal"> pi</span><span class="symbol">,</span><span class="normal"> arrstr</span><span class="symbol">[</span><span class="normal">pi</span><span class="symbol">].</span><span class="function">c_str</span><span class="symbol">()));</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="function">UpdateMenuInsertPassword</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UpdateMenuInsertPassword</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">menubar_textpage</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">wpassgen</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    wxMenuItem</span><span class="symbol">*</span><span class="normal"> pgitem </span><span class="symbol">=</span><span class="normal"> menubar_textpage</span><span class="symbol">-&gt;</span><span class="function">FindItem</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_PASSWORD</span><span class="symbol">);</span>
<span class="normal">    wxMenu</span><span class="symbol">*</span><span class="normal"> pgsubmenu </span><span class="symbol">=</span><span class="normal"> pgitem </span><span class="symbol">?</span><span class="normal"> pgitem</span><span class="symbol">-&gt;</span><span class="function">GetSubMenu</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">:</span><span class="normal"> NULL</span><span class="symbol">;</span>
<span class="normal">    </span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">pgitem </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">pgsubmenu</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Internal Menu Error: could not find insert-password submenu"</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// Delete all preset items</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> myID_MENU_EDIT_INSERT_PASSWORD_FIRST</span><span class="symbol">;</span>
<span class="normal">	wxMenuItem</span><span class="symbol">*</span><span class="normal"> presetitem </span><span class="symbol">=</span><span class="normal"> pgsubmenu</span><span class="symbol">-&gt;</span><span class="function">FindItem</span><span class="symbol">(</span><span class="normal">pi</span><span class="symbol">);</span>
<span class="normal">	</span>
<span class="normal">	</span><span class="keyword">while</span><span class="symbol">(</span><span class="normal">presetitem </span><span class="symbol">!=</span><span class="normal"> NULL</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    pgsubmenu</span><span class="symbol">-&gt;</span><span class="function">Remove</span><span class="symbol">(</span><span class="normal">presetitem</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">delete</span><span class="normal"> presetitem</span><span class="symbol">;</span>
<span class="normal">	    presetitem </span><span class="symbol">=</span><span class="normal"> pgsubmenu</span><span class="symbol">-&gt;</span><span class="function">FindItem</span><span class="symbol">(++</span><span class="normal">pi</span><span class="symbol">);</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// Append all presets</span>
<span class="normal">    </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> wpassgen</span><span class="symbol">-&gt;</span><span class="normal">presetlist</span><span class="symbol">.</span><span class="function">size</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">const</span><span class="normal"> WPassGen</span><span class="symbol">::</span><span class="normal">Preset</span><span class="symbol">&amp;</span><span class="normal"> preset </span><span class="symbol">=</span><span class="normal"> wpassgen</span><span class="symbol">-&gt;</span><span class="normal">presetlist</span><span class="symbol">[</span><span class="normal">pi</span><span class="symbol">];</span>
<span class="normal">    </span>
<span class="normal">	pgsubmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_PASSWORD_FIRST </span><span class="symbol">+</span><span class="normal"> pi</span><span class="symbol">,</span>
<span class="normal">			  preset</span><span class="symbol">.</span><span class="normal">name</span><span class="symbol">,</span>
<span class="normal">			  wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert a password generated with the preset %s"</span><span class="symbol">),</span><span class="normal"> preset</span><span class="symbol">.</span><span class="normal">name</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">()));</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnToolEditInsertPassword</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    wxMenu</span><span class="symbol">*</span><span class="normal"> menu </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxMenu</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert Password Presets"</span><span class="symbol">));</span>
<span class="normal"> </span>
<span class="normal">    </span><span class="keyword">for</span><span class="normal"> </span><span class="symbol">(</span><span class="type">unsigned</span><span class="normal"> </span><span class="type">int</span><span class="normal"> pi </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> pi </span><span class="symbol">&lt;</span><span class="normal"> wpassgen</span><span class="symbol">-&gt;</span><span class="normal">presetlist</span><span class="symbol">.</span><span class="function">size</span><span class="symbol">();</span><span class="normal"> </span><span class="symbol">++</span><span class="normal">pi</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">const</span><span class="normal"> WPassGen</span><span class="symbol">::</span><span class="normal">Preset</span><span class="symbol">&amp;</span><span class="normal"> preset </span><span class="symbol">=</span><span class="normal"> wpassgen</span><span class="symbol">-&gt;</span><span class="normal">presetlist</span><span class="symbol">[</span><span class="normal">pi</span><span class="symbol">];</span>
<span class="normal">    </span>
<span class="normal">	menu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_PASSWORD_FIRST </span><span class="symbol">+</span><span class="normal"> pi</span><span class="symbol">,</span>
<span class="normal">		     preset</span><span class="symbol">.</span><span class="normal">name</span><span class="symbol">,</span>
<span class="normal">		     wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert a password generated with the preset %s"</span><span class="symbol">),</span><span class="normal"> preset</span><span class="symbol">.</span><span class="normal">name</span><span class="symbol">.</span><span class="function">c_str</span><span class="symbol">()));</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    menu</span><span class="symbol">-&gt;</span><span class="function">AppendSeparator</span><span class="symbol">();</span>

<span class="normal">    menu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_PASSWORD_DIALOG</span><span class="symbol">,</span>
<span class="normal">		 </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open Generator Dialog ..."</span><span class="symbol">),</span>
<span class="normal">		 </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Open random generator dialog box and insert the generated password."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">PopupMenu</span><span class="symbol">(</span><span class="normal">menu</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuEditInsertPasswordPreset</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">,</span><span class="normal"> WTextPage</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="type">int</span><span class="normal"> id </span><span class="symbol">=</span><span class="normal"> event</span><span class="symbol">.</span><span class="function">GetId</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">-</span><span class="normal"> myID_MENU_EDIT_INSERT_PASSWORD_FIRST</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">&lt;</span><span class="normal"> </span><span class="number">0</span><span class="normal"> </span><span class="symbol">||</span><span class="normal"> id </span><span class="symbol">&gt;=</span><span class="normal"> </span><span class="symbol">(</span><span class="type">int</span><span class="symbol">)</span><span class="normal">wpassgen</span><span class="symbol">-&gt;</span><span class="normal">presetlist</span><span class="symbol">.</span><span class="function">size</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">const</span><span class="normal"> WPassGen</span><span class="symbol">::</span><span class="normal">Preset</span><span class="symbol">&amp;</span><span class="normal"> preset </span><span class="symbol">=</span><span class="normal"> wpassgen</span><span class="symbol">-&gt;</span><span class="normal">presetlist</span><span class="symbol">[</span><span class="normal">id</span><span class="symbol">];</span>
<span class="normal">    </span>
<span class="normal">    page</span><span class="symbol">-&gt;</span><span class="function">AddText</span><span class="symbol">(</span><span class="normal">wpassgen</span><span class="symbol">-&gt;</span><span class="function">MakePassword</span><span class="symbol">(</span><span class="normal">preset</span><span class="symbol">));</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuEditInsertDateTime</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">,</span><span class="normal"> WTextPage</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> datestr</span><span class="symbol">;</span>
<span class="normal">    </span><span class="usertype">wxDateTime</span><span class="normal"> now </span><span class="symbol">=</span><span class="normal"> wxDateTime</span><span class="symbol">::</span><span class="function">Now</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">switch</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">GetId</span><span class="symbol">())</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="label">    default:</span>
<span class="normal">    </span><span class="keyword">case</span><span class="normal"> myID_MENU_EDIT_INSERT_DATETIME_YYYYMMDD_HHMMSS</span><span class="symbol">:</span>
<span class="normal">	datestr </span><span class="symbol">=</span><span class="normal"> now</span><span class="symbol">.</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"%Y-%m-%d %H:%M:%S"</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">break</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> myID_MENU_EDIT_INSERT_DATETIME_YYYYMMDD</span><span class="symbol">:</span>
<span class="normal">	datestr </span><span class="symbol">=</span><span class="normal"> now</span><span class="symbol">.</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"%Y-%m-%d"</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">break</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> myID_MENU_EDIT_INSERT_DATETIME_HHMMSS</span><span class="symbol">:</span>
<span class="normal">	datestr </span><span class="symbol">=</span><span class="normal"> now</span><span class="symbol">.</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"%H:%M:%S"</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">break</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> myID_MENU_EDIT_INSERT_DATETIME_LOCALE</span><span class="symbol">:</span>
<span class="normal">	datestr </span><span class="symbol">=</span><span class="normal"> now</span><span class="symbol">.</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"%c"</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">break</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> myID_MENU_EDIT_INSERT_DATETIME_LOCALE_DATE</span><span class="symbol">:</span>
<span class="normal">	datestr </span><span class="symbol">=</span><span class="normal"> now</span><span class="symbol">.</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"%x"</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">break</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> myID_MENU_EDIT_INSERT_DATETIME_LOCALE_TIME</span><span class="symbol">:</span>
<span class="normal">	datestr </span><span class="symbol">=</span><span class="normal"> now</span><span class="symbol">.</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"%X"</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">break</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">case</span><span class="normal"> myID_MENU_EDIT_INSERT_DATETIME_RFC822</span><span class="symbol">:</span>
<span class="normal">	datestr </span><span class="symbol">=</span><span class="normal"> now</span><span class="symbol">.</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"%a, %d %b %Y %H:%M:%S %z"</span><span class="symbol">));</span>
<span class="normal">	</span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    page</span><span class="symbol">-&gt;</span><span class="function">AddText</span><span class="symbol">(</span><span class="normal">datestr</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnToolEditInsertDateTime</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    wxMenu</span><span class="symbol">*</span><span class="normal"> dategenmenu </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxMenu</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert Date/Time"</span><span class="symbol">));</span>
<span class="normal"> </span>
<span class="normal">    dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_YYYYMMDD_HHMMSS</span><span class="symbol">,</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"YYYY-MM-DD HH:MM:SS"</span><span class="symbol">),</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date/time in YYYY-MM-DD HH:MM:SS (ISO 8601) format."</span><span class="symbol">));</span>

<span class="normal">    dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_YYYYMMDD</span><span class="symbol">,</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"YYYY-MM-DD"</span><span class="symbol">),</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date in YYYY-MM-DD (ISO 8601) format."</span><span class="symbol">));</span>

<span class="normal">    dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_HHMMSS</span><span class="symbol">,</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"HH:MM:SS"</span><span class="symbol">),</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local time in HH:MM:SS (ISO 8601) format."</span><span class="symbol">));</span>

<span class="normal">    dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE</span><span class="symbol">,</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Text Date/Time"</span><span class="symbol">),</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date/time in text format."</span><span class="symbol">));</span>

<span class="normal">    dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE_DATE</span><span class="symbol">,</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Text Date"</span><span class="symbol">),</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date in text format."</span><span class="symbol">));</span>

<span class="normal">    dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE_TIME</span><span class="symbol">,</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Text Time"</span><span class="symbol">),</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local time in text format."</span><span class="symbol">));</span>

<span class="normal">    dategenmenu</span><span class="symbol">-&gt;</span><span class="function">Append</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_RFC822</span><span class="symbol">,</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"RFC 822 Date/Time"</span><span class="symbol">),</span>
<span class="normal">			</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Insert current local date/time in RFC 822 format."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">PopupMenu</span><span class="symbol">(</span><span class="normal">dategenmenu</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewLineWrap</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetViewLineWrap</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">IsChecked</span><span class="symbol">());</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewLineNumber</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetViewLineNumber</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">IsChecked</span><span class="symbol">());</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewWhitespace</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetViewWhitespace</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">IsChecked</span><span class="symbol">());</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewEndOfLine</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetViewEndOfLine</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">IsChecked</span><span class="symbol">());</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewIndentGuide</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetViewIndentGuide</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">IsChecked</span><span class="symbol">());</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewLonglineGuide</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetViewLonglineGuide</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">IsChecked</span><span class="symbol">());</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewZoomIncrease</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetZoom</span><span class="symbol">(</span><span class="normal"> ctext</span><span class="symbol">-&gt;</span><span class="function">GetZoom</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> </span><span class="number">1</span><span class="normal"> </span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewZoomDecrease</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetZoom</span><span class="symbol">(</span><span class="normal"> ctext</span><span class="symbol">-&gt;</span><span class="function">GetZoom</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">-</span><span class="normal"> </span><span class="number">1</span><span class="normal"> </span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuViewZoomReset</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">cpage </span><span class="symbol">||</span><span class="normal"> </span><span class="symbol">!</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> ctext </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">*)</span><span class="normal">cpage</span><span class="symbol">;</span>

<span class="normal">    ctext</span><span class="symbol">-&gt;</span><span class="function">SetZoom</span><span class="symbol">(</span><span class="number">0</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuHelpBrowser</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">GetHtmlHelpController</span><span class="symbol">()-&gt;</span><span class="function">DisplayContents</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuHelpWebUpdateCheck</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">WebUpdateCheck</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuHelpAbout</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="usertype">WAbout</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>
<span class="normal">    dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnAccelEscape</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">HideQuickBars</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="comment">// *** wxAuiManager Callbacks ***</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnAuiManagerPaneClose</span><span class="symbol">(</span><span class="normal">wxAuiManagerEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">&amp;&amp;</span><span class="normal"> event</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">()-&gt;</span><span class="normal">window </span><span class="symbol">==</span><span class="normal"> filelistpane</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        toolbar</span><span class="symbol">-&gt;</span><span class="function">ToggleTool</span><span class="symbol">(</span><span class="normal">myID_MENU_CONTAINER_SHOWLIST</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="comment">// *** wxAuiNotebook Callbacks ***</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnNotebookPageChanged</span><span class="symbol">(</span><span class="normal">wxAuiNotebookEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxLogDebug</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Debug: OnNotebookPageChanged() to %d event."</span><span class="symbol">),</span><span class="normal"> event</span><span class="symbol">.</span><span class="function">GetSelection</span><span class="symbol">());</span>

<span class="normal">    WNotePage</span><span class="symbol">*</span><span class="normal"> sel </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="normal"> event</span><span class="symbol">.</span><span class="function">GetSelection</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">),</span><span class="normal"> WNotePage</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">sel</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">UpdateNotebookPageChanged</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">.</span><span class="function">GetSelection</span><span class="symbol">(),</span><span class="normal"> sel</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">wxLogError</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Invalid notebook page activated."</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnNotebookPageClose</span><span class="symbol">(</span><span class="normal">wxAuiNotebookEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxLogDebug</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Debug: OnNotebookPageClose() event."</span><span class="symbol">));</span>

<span class="normal">    WNotePage</span><span class="symbol">*</span><span class="normal"> sel </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPage</span><span class="symbol">(</span><span class="normal"> event</span><span class="symbol">.</span><span class="function">GetSelection</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">),</span><span class="normal"> WNotePage</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">sel</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	sel</span><span class="symbol">-&gt;</span><span class="function">PageClosed</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">auinotebook</span><span class="symbol">-&gt;</span><span class="function">GetPageCount</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> </span><span class="number">1</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// will be empty after the last page is closed</span>
<span class="normal">	</span><span class="function">UpdateNotebookPageChanged</span><span class="symbol">(-</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> NULL</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">UpdateNotebookPageChanged</span><span class="symbol">(</span><span class="type">int</span><span class="normal"> pageid</span><span class="symbol">,</span><span class="normal"> WNotePage</span><span class="symbol">*</span><span class="normal"> page</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxLogDebug</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Debug: UpdateNotebookPageChanged() event for %d page %p."</span><span class="symbol">),</span><span class="normal"> pageid</span><span class="symbol">,</span><span class="normal"> page</span><span class="symbol">);</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpageid </span><span class="symbol">==</span><span class="normal"> pageid </span><span class="symbol">&amp;&amp;</span><span class="normal"> cpage </span><span class="symbol">==</span><span class="normal"> page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">PageBlurred</span><span class="symbol">();</span>

<span class="normal">    cpage </span><span class="symbol">=</span><span class="normal"> page</span><span class="symbol">;</span>
<span class="normal">    cpageid </span><span class="symbol">=</span><span class="normal"> pageid</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">Freeze</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	cpage</span><span class="symbol">-&gt;</span><span class="function">PageFocused</span><span class="symbol">();</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WTextPage</span><span class="symbol">)))</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    menubar_active </span><span class="symbol">=</span><span class="normal"> menubar_textpage</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span><span class="normal"> </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">-&gt;</span><span class="function">IsKindOf</span><span class="symbol">(</span><span class="function">CLASSINFO</span><span class="symbol">(</span><span class="normal">WBinaryPage</span><span class="symbol">)))</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    menubar_active </span><span class="symbol">=</span><span class="normal"> menubar_binarypage</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    menubar_active </span><span class="symbol">=</span><span class="normal"> menubar_plain</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="function">SetMenuBar</span><span class="symbol">(</span><span class="normal">menubar_active</span><span class="symbol">);</span>
<span class="normal">	</span><span class="function">CreateToolBar</span><span class="symbol">();</span>

<span class="normal">	menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_EXPORT</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">	menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_PROPERTIES</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">	menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_CLOSE</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	menubar_active </span><span class="symbol">=</span><span class="normal"> menubar_plain</span><span class="symbol">;</span>
<span class="normal">	</span><span class="function">SetMenuBar</span><span class="symbol">(</span><span class="normal">menubar_active</span><span class="symbol">);</span>
<span class="normal">	</span><span class="function">CreateToolBar</span><span class="symbol">();</span>

<span class="normal">	menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_EXPORT</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">	menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_PROPERTIES</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>
<span class="normal">	menubar_active</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_CLOSE</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>

<span class="normal">	</span><span class="comment">// always show the file list pane if no file is open</span>
<span class="normal">	</span><span class="function">ShowFilelistPane</span><span class="symbol">(</span><span class="keyword">true</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="function">Thaw</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnNotebookPageRightDown</span><span class="symbol">(</span><span class="normal">wxAuiNotebookEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    wxMenu</span><span class="symbol">*</span><span class="normal"> menu </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> wxMenu</span><span class="symbol">;</span>
<span class="normal"> </span>
<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menu</span><span class="symbol">,</span><span class="normal"> myID_MENU_SUBFILE_EXPORT</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Export SubFile ..."</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Export current subfile to disk."</span><span class="symbol">));</span>
<span class="normal"> </span>
<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menu</span><span class="symbol">,</span><span class="normal"> myID_MENU_SUBFILE_PROPERTIES</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Properties ..."</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Show metadata properties of current subfile."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">appendMenuItem</span><span class="symbol">(</span><span class="normal">menu</span><span class="symbol">,</span><span class="normal"> myID_MENU_SUBFILE_CLOSE</span><span class="symbol">,</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"&amp;Close SubFile"</span><span class="symbol">),</span>
<span class="normal">		   </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Close current subfile."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">PopupMenu</span><span class="symbol">(</span><span class="normal">menu</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="comment">// *** WQuickFindBar Callbacks ***</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnButtonQuickFindClose</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxCHECK_RET</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Program Error: QuickFindBar was not created."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickfindbar_visible</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">StopQuickFind</span><span class="symbol">();</span>

<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	quickfindbar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnTextQuickFind</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxCHECK_RET</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Program Error: QuickFindBar was not created."</span><span class="symbol">));</span>

<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">,</span><span class="normal"> WTextPage</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> findtext </span><span class="symbol">=</span><span class="normal"> quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">GetValue</span><span class="symbol">();</span>

<span class="normal">    page</span><span class="symbol">-&gt;</span><span class="function">DoQuickFind</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">,</span><span class="normal"> findtext</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnButtonQuickFindNext</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxCHECK_RET</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Program Error: QuickFindBar was not created."</span><span class="symbol">));</span>

<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">,</span><span class="normal"> WTextPage</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> findtext </span><span class="symbol">=</span><span class="normal"> quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">GetValue</span><span class="symbol">();</span>

<span class="normal">    page</span><span class="symbol">-&gt;</span><span class="function">PrepareQuickFind</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>

<span class="normal">    page</span><span class="symbol">-&gt;</span><span class="function">DoQuickFind</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">,</span><span class="normal"> findtext</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnButtonQuickFindPrev</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxCHECK_RET</span><span class="symbol">(</span><span class="normal">quickfindbar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Program Error: QuickFindBar was not created."</span><span class="symbol">));</span>

<span class="normal">    WTextPage</span><span class="symbol">*</span><span class="normal"> page </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxDynamicCast</span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">,</span><span class="normal"> WTextPage</span><span class="symbol">);</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">page</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="usertype">wxString</span><span class="normal"> findtext </span><span class="symbol">=</span><span class="normal"> quickfindbar</span><span class="symbol">-&gt;</span><span class="normal">textctrlQuickFind</span><span class="symbol">-&gt;</span><span class="function">GetValue</span><span class="symbol">();</span>

<span class="normal">    page</span><span class="symbol">-&gt;</span><span class="function">PrepareQuickFind</span><span class="symbol">(</span><span class="keyword">true</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">);</span>

<span class="normal">    page</span><span class="symbol">-&gt;</span><span class="function">DoQuickFind</span><span class="symbol">(</span><span class="keyword">true</span><span class="symbol">,</span><span class="normal"> findtext</span><span class="symbol">);</span>
<span class="cbracket">}</span>
<span class="comment">// *** WQuickGotoBar Callbacks ***</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnButtonGotoClose</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxCHECK_RET</span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Program Error: QuickGotoBar was not created."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">quickgotobar_visible</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	quickgotobar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnButtonGotoGo</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">wxCHECK_RET</span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"Program Error: QuickGotoBar was not created."</span><span class="symbol">));</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">cpage</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="type">bool</span><span class="normal"> r </span><span class="symbol">=</span><span class="normal"> cpage</span><span class="symbol">-&gt;</span><span class="function">DoQuickGoto</span><span class="symbol">(</span><span class="normal"> quickgotobar</span><span class="symbol">-&gt;</span><span class="normal">textctrlGoto</span><span class="symbol">-&gt;</span><span class="function">GetValue</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">);</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">r</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	    quickgotobar</span><span class="symbol">-&gt;</span><span class="normal">textctrlGoto</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	</span><span class="keyword">else</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	    auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">quickgotobar</span><span class="symbol">).</span><span class="function">Hide</span><span class="symbol">();</span>
<span class="normal">	    auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>

<span class="normal">	    quickgotobar_visible </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">false</span><span class="symbol">;</span>
<span class="normal">	    </span>
<span class="normal">	    cpage</span><span class="symbol">-&gt;</span><span class="function">SetFocus</span><span class="symbol">();</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuEditFind</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">findreplacedlg</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	findreplacedlg </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WFindReplace</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">AddPane</span><span class="symbol">(</span><span class="normal">findreplacedlg</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxAuiPaneInfo</span><span class="symbol">().</span>
<span class="normal">		       </span><span class="function">Name</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">"findreplacedlg"</span><span class="symbol">)).</span>
<span class="normal">		       </span><span class="function">Dockable</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">Float</span><span class="symbol">());</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    findreplacedlg</span><span class="symbol">-&gt;</span><span class="function">ShowReplace</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">);</span>

<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">findreplacedlg</span><span class="symbol">).</span><span class="function">Show</span><span class="symbol">().</span><span class="function">Caption</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Find"</span><span class="symbol">));</span>
<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnMenuEditFindReplace</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">findreplacedlg</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	findreplacedlg </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">WFindReplace</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">	auimgr</span><span class="symbol">.</span><span class="function">AddPane</span><span class="symbol">(</span><span class="normal">findreplacedlg</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxAuiPaneInfo</span><span class="symbol">().</span>
<span class="normal">		       </span><span class="function">Name</span><span class="symbol">(</span><span class="function">wxT</span><span class="symbol">(</span><span class="string">"findreplacedlg"</span><span class="symbol">)).</span>
<span class="normal">		       </span><span class="function">Dockable</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">).</span><span class="function">Float</span><span class="symbol">());</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    findreplacedlg</span><span class="symbol">-&gt;</span><span class="function">ShowReplace</span><span class="symbol">(</span><span class="keyword">true</span><span class="symbol">);</span>

<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">GetPane</span><span class="symbol">(</span><span class="normal">findreplacedlg</span><span class="symbol">).</span><span class="function">Show</span><span class="symbol">().</span><span class="function">Caption</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Find &amp; Replace"</span><span class="symbol">));</span>
<span class="normal">    auimgr</span><span class="symbol">.</span><span class="function">Update</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="normal">wxHtmlHelpController</span><span class="symbol">*</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">GetHtmlHelpController</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">m_htmlhelp</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">        wxFileSystem</span><span class="symbol">::</span><span class="function">AddHandler</span><span class="symbol">(</span><span class="keyword">new</span><span class="normal"> BuiltinHtmlHelpFSHandler</span><span class="symbol">);</span>

<span class="normal">        m_htmlhelp </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxHtmlHelpController</span><span class="symbol">(</span><span class="normal">wxHF_FRAME </span><span class="symbol">|</span><span class="normal"> wxHF_TOOLBAR </span><span class="symbol">|</span><span class="normal"> wxHF_FLAT_TOOLBAR </span><span class="symbol">|</span><span class="normal"> wxHF_CONTENTS </span><span class="symbol">|</span><span class="normal"> wxHF_INDEX </span><span class="symbol">|</span><span class="normal"> wxHF_SEARCH </span><span class="symbol">|</span><span class="normal"> wxHF_PRINT</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">this</span><span class="symbol">);</span>

<span class="normal">        m_htmlhelp</span><span class="symbol">-&gt;</span><span class="function">UseConfig</span><span class="symbol">(</span><span class="normal">wxConfigBase</span><span class="symbol">::</span><span class="function">Get</span><span class="symbol">(),</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="string">"htmlhelp"</span><span class="symbol">));</span>

<span class="normal">        </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">m_locale</span><span class="symbol">-&gt;</span><span class="function">GetLanguage</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">==</span><span class="normal"> wxLANGUAGE_GERMAN</span><span class="symbol">)</span>
<span class="normal">        </span><span class="cbracket">{</span>
<span class="normal">            m_htmlhelp</span><span class="symbol">-&gt;</span><span class="function">AddBook</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"help:de/cryptote.hhp"</span><span class="symbol">));</span>
<span class="normal">        </span><span class="cbracket">}</span>
<span class="normal">        </span><span class="keyword">else</span>
<span class="normal">        </span><span class="cbracket">{</span>
<span class="normal">            m_htmlhelp</span><span class="symbol">-&gt;</span><span class="function">AddBook</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"help:en/cryptote.hhp"</span><span class="symbol">));</span>
<span class="normal">        </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">return</span><span class="normal"> m_htmlhelp</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">OnIdleTimerCheck</span><span class="symbol">(</span><span class="normal">wxTimerEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">lastuserevent </span><span class="symbol">==</span><span class="normal"> </span><span class="number">0</span><span class="symbol">)</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>

<span class="normal">    </span><span class="type">long</span><span class="normal"> timenow </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">::</span><span class="function">wxGetLocalTime</span><span class="symbol">();</span>
<span class="normal">    </span><span class="type">long</span><span class="normal"> timedelta </span><span class="symbol">=</span><span class="normal"> timenow </span><span class="symbol">-</span><span class="normal"> lastuserevent</span><span class="symbol">;</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_autoclose</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">timedelta </span><span class="symbol">&gt;=</span><span class="normal"> prefs_autoclosetime </span><span class="symbol">*</span><span class="normal"> </span><span class="number">60</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    lastuserevent </span><span class="symbol">=</span><span class="normal"> </span><span class="number">0</span><span class="symbol">;</span><span class="normal"> </span><span class="comment">// disable timer before processing, only one</span>
<span class="normal">			       </span><span class="comment">// idle-timeout per user-event.</span>

<span class="normal">	    </span><span class="comment">// cannot auto-close if the filename is unset.</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">container_filename</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Inactivity time elapsed. But could not auto-save container: no default file name set."</span><span class="symbol">));</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	    </span><span class="keyword">else</span>
<span class="normal">	    </span><span class="cbracket">{</span>
<span class="normal">		</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="function">IsModified</span><span class="symbol">())</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">		    </span><span class="comment">// error during save?</span>
<span class="normal">		    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="function">UserContainerSave</span><span class="symbol">())</span><span class="normal"> </span><span class="keyword">return</span><span class="symbol">;</span>
<span class="normal">		</span><span class="cbracket">}</span>
<span class="normal">		</span><span class="keyword">else</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">		    </span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Inactivity time elapsed. No modifications to save."</span><span class="symbol">));</span>
<span class="normal">		</span><span class="cbracket">}</span>

<span class="normal">		</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_autocloseexit</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">		    </span><span class="function">Close</span><span class="symbol">();</span>
<span class="normal">		</span><span class="cbracket">}</span>
<span class="normal">		</span><span class="keyword">else</span>
<span class="normal">                </span><span class="cbracket">{</span>
<span class="normal">                    </span><span class="usertype">wxFileName</span><span class="normal"> closedfile </span><span class="symbol">=</span><span class="normal"> container_filename</span><span class="symbol">;</span>
<span class="normal">                    </span><span class="function">ContainerNew</span><span class="symbol">();</span>

<span class="normal">                    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">closedfile</span><span class="symbol">.</span><span class="function">IsOk</span><span class="symbol">())</span>
<span class="normal">                    </span><span class="cbracket">{</span>
<span class="normal">                        </span><span class="comment">// Allow direct reopen of the auto-closed container</span>

<span class="normal">                        </span><span class="usertype">wxString</span><span class="normal"> msg </span><span class="symbol">=</span><span class="normal"> wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Inactivity time elapsed.</span><span class="specialchar">\n</span><span class="string">"</span>
<span class="normal">                                                          </span><span class="string">"Loaded container </span><span class="specialchar">\"</span><span class="string">%s</span><span class="specialchar">\"</span><span class="string"> was automatically closed.</span><span class="specialchar">\n</span><span class="string">"</span>
<span class="normal">                                                          </span><span class="string">"Reopen the container?"</span><span class="symbol">),</span>
<span class="normal">                                                        closedfile</span><span class="symbol">.</span><span class="function">GetFullName</span><span class="symbol">().</span><span class="function">c_str</span><span class="symbol">());</span>

<span class="normal">                        </span><span class="usertype">WMessageDialog</span><span class="normal"> </span><span class="function">dlg</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> msg</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE"</span><span class="symbol">),</span>
<span class="normal">                                           wxICON_INFORMATION</span><span class="symbol">,</span>
<span class="normal">                                           wxID_YES</span><span class="symbol">,</span><span class="normal"> wxID_NO</span><span class="symbol">,</span><span class="normal"> wxID_EXIT</span><span class="symbol">);</span>

<span class="normal">                        </span><span class="type">int</span><span class="normal"> id </span><span class="symbol">=</span><span class="normal"> dlg</span><span class="symbol">.</span><span class="function">ShowModal</span><span class="symbol">();</span>

<span class="normal">                        </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">==</span><span class="normal"> wxID_YES</span><span class="symbol">)</span>
<span class="normal">                            </span><span class="function">ContainerOpen</span><span class="symbol">(</span><span class="normal"> closedfile</span><span class="symbol">.</span><span class="function">GetFullPath</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">);</span>
<span class="normal">                        </span><span class="keyword">else</span><span class="normal"> </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">id </span><span class="symbol">==</span><span class="normal"> wxID_EXIT</span><span class="symbol">)</span>
<span class="normal">                            </span><span class="function">Close</span><span class="symbol">();</span>
<span class="normal">                    </span><span class="cbracket">}</span>
<span class="normal">		</span><span class="cbracket">}</span>
<span class="normal">	    </span><span class="cbracket">}</span>
<span class="normal">	</span><span class="cbracket">}</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">timedelta </span><span class="symbol">&gt;</span><span class="normal"> </span><span class="number">50</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">idletimestatusbar</span><span class="symbol">.</span><span class="function">IsEmpty</span><span class="symbol">())</span>
<span class="normal">		idletimestatusbar </span><span class="symbol">=</span><span class="normal"> statusbar</span><span class="symbol">-&gt;</span><span class="function">GetStatusText</span><span class="symbol">(</span><span class="number">1</span><span class="symbol">);</span>

<span class="normal">	    </span><span class="usertype">wxString</span><span class="normal"> sb </span><span class="symbol">=</span><span class="normal"> wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Auto-close in %ds"</span><span class="symbol">),</span><span class="normal"> prefs_autoclosetime </span><span class="symbol">*</span><span class="normal"> </span><span class="number">60</span><span class="normal"> </span><span class="symbol">-</span><span class="normal"> timedelta</span><span class="symbol">);</span>
<span class="normal">	    statusbar</span><span class="symbol">-&gt;</span><span class="function">SetStatusText</span><span class="symbol">(</span><span class="normal">sb</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">);</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">timedelta </span><span class="symbol">&gt;</span><span class="normal"> </span><span class="number">60</span><span class="symbol">)</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="comment">// Toggle automatic WebUpdateCheck if enabled.</span>

<span class="normal">	</span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">prefs_webupdatecheck </span><span class="symbol">&amp;&amp;</span><span class="normal"> timenow </span><span class="symbol">&gt;=</span><span class="normal"> prefs_webupdatecheck_time </span><span class="symbol">+</span><span class="normal"> </span><span class="number">24</span><span class="symbol">*</span><span class="number">3600</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	    </span><span class="comment">// Always update check time, regardless of webcheck's result.</span>
<span class="normal">	    prefs_webupdatecheck_time </span><span class="symbol">=</span><span class="normal"> timenow</span><span class="symbol">;</span>

<span class="normal">	    wxConfigBase</span><span class="symbol">*</span><span class="normal"> cfg </span><span class="symbol">=</span><span class="normal"> wxConfigBase</span><span class="symbol">::</span><span class="function">Get</span><span class="symbol">();</span>
<span class="normal">	    cfg</span><span class="symbol">-&gt;</span><span class="function">SetPath</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"/cryptote"</span><span class="symbol">));</span>
<span class="normal">	    cfg</span><span class="symbol">-&gt;</span><span class="function">Write</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"webupdatecheck_time"</span><span class="symbol">),</span><span class="normal"> timenow</span><span class="symbol">);</span>
<span class="normal">	    cfg</span><span class="symbol">-&gt;</span><span class="function">Flush</span><span class="symbol">();</span>

<span class="normal">	    </span><span class="function">WebUpdateCheck</span><span class="symbol">();</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="function">ResetIdleTimer</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    lastuserevent </span><span class="symbol">=</span><span class="normal"> </span><span class="symbol">::</span><span class="function">wxGetLocalTime</span><span class="symbol">();</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(!</span><span class="normal">idletimestatusbar</span><span class="symbol">.</span><span class="function">IsEmpty</span><span class="symbol">())</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	statusbar</span><span class="symbol">-&gt;</span><span class="function">SetStatusText</span><span class="symbol">(</span><span class="normal">idletimestatusbar</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">);</span>
<span class="normal">	idletimestatusbar</span><span class="symbol">.</span><span class="function">Clear</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="function">BEGIN_EVENT_TABLE</span><span class="symbol">(</span><span class="normal">WCryptoTE</span><span class="symbol">,</span><span class="normal"> wxFrame</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// *** Generic Events</span>

<span class="normal">    </span><span class="function">EVT_CLOSE</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">WCryptoTE</span><span class="symbol">::</span><span class="normal">OnClose</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_TIMER</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_TIMER_IDLECHECK</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnIdleTimerCheck</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// *** Menu Items</span>

<span class="normal">    </span><span class="comment">// Container</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_OPEN</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerOpen</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_SAVE</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerSave</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_SAVEAS</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerSaveAs</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_REVERT</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerRevert</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_CLOSE</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerClose</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_CONTAINER_SHOWLIST</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerShowList</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_PROPERTIES</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerProperties</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_CONTAINER_PASSLIST</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerPasswordList</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_PREFERENCES</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerPreferences</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_EXIT</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuContainerQuit</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// SubFile</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_NEW</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuSubFileNew</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_IMPORT</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuSubFileImport</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_EXPORT</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuSubFileExport</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_PROPERTIES</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuSubFileProperties</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_SUBFILE_CLOSE</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuSubFileClose</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// Edit</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_UNDO</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGeneric</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_REDO</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGeneric</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_CUT</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGeneric</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_COPY</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGeneric</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_PASTE</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGeneric</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_CLEAR</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGeneric</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_QUICKFIND</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditQuickFind</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_FIND</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditFind</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_REPLACE</span><span class="symbol">,</span><span class="normal">		WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditFindReplace</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_GOTO</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGoto</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_SELECTALL</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGeneric</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_SELECTLINE</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditGeneric</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_PASSWORD_DIALOG</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertPassword</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_TOOL</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_TOOL_EDIT_INSERT_PASSWORD</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnToolEditInsertPassword</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU_RANGE</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_PASSWORD_FIRST</span><span class="symbol">,</span><span class="normal"> myID_MENU_EDIT_INSERT_PASSWORD_FIRST </span><span class="symbol">+</span><span class="normal"> </span><span class="number">999</span><span class="symbol">,</span>
<span class="normal">		   WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertPasswordPreset</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_TOOL</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_TOOL_EDIT_INSERT_DATETIME</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnToolEditInsertDateTime</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_YYYYMMDD_HHMMSS</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertDateTime</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_YYYYMMDD</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertDateTime</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_HHMMSS</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertDateTime</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertDateTime</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE_DATE</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertDateTime</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_LOCALE_TIME</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertDateTime</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_EDIT_INSERT_DATETIME_RFC822</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuEditInsertDateTime</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// View</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_LINEWRAP</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewLineWrap</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_LINENUMBER</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewLineNumber</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_WHITESPACE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewWhitespace</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_ENDOFLINE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewEndOfLine</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_INDENTGUIDE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewIndentGuide</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_LONGLINEGUIDE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewLonglineGuide</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_ZOOM_INCREASE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewZoomIncrease</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_ZOOM_DECREASE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewZoomDecrease</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_VIEW_ZOOM_RESET</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuViewZoomReset</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// Help</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_HELP_BROWSER</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuHelpBrowser</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_MENU_HELP_WEBUPDATECHECK</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuHelpWebUpdateCheck</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">wxID_ABOUT</span><span class="symbol">,</span><span class="normal">			WCryptoTE</span><span class="symbol">::</span><span class="normal">OnMenuHelpAbout</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// *** Accelerators</span>

<span class="normal">    </span><span class="function">EVT_MENU</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_ACCEL_ESCAPE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnAccelEscape</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// *** wxAuiManager Callbacks</span>

<span class="normal">    </span><span class="function">EVT_AUI_PANE_CLOSE</span><span class="symbol">(</span><span class="normal">WCryptoTE</span><span class="symbol">::</span><span class="normal">OnAuiManagerPaneClose</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// *** wxAuiNotebook Callbacks</span>

<span class="normal">    </span><span class="function">EVT_AUINOTEBOOK_PAGE_CHANGED</span><span class="symbol">(</span><span class="normal">myID_AUINOTEBOOK</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnNotebookPageChanged</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_AUINOTEBOOK_PAGE_CLOSE</span><span class="symbol">(</span><span class="normal">myID_AUINOTEBOOK</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnNotebookPageClose</span><span class="symbol">)</span>
<span class="preproc">#if</span><span class="normal"> </span><span class="function">wxCHECK_VERSION</span><span class="symbol">(</span><span class="number">2</span><span class="symbol">,</span><span class="number">8</span><span class="symbol">,</span><span class="number">7</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_AUINOTEBOOK_TAB_RIGHT_DOWN</span><span class="symbol">(</span><span class="normal">myID_AUINOTEBOOK</span><span class="symbol">,</span><span class="normal"> WCryptoTE</span><span class="symbol">::</span><span class="normal">OnNotebookPageRightDown</span><span class="symbol">)</span>
<span class="preproc">#endif</span>

<span class="normal">    </span><span class="comment">// *** Quick-Find Bar</span>

<span class="normal">    </span><span class="function">EVT_TEXT</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_QUICKFIND_TEXT</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnTextQuickFind</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_BUTTON</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_QUICKFIND_NEXT</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnButtonQuickFindNext</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_BUTTON</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_QUICKFIND_PREV</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnButtonQuickFindPrev</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_BUTTON</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_QUICKFIND_CLOSE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnButtonQuickFindClose</span><span class="symbol">)</span>

<span class="normal">    </span><span class="comment">// *** Quick-Goto Bar</span>

<span class="normal">    </span><span class="function">EVT_TEXT_ENTER</span><span class="symbol">(</span><span class="normal">myID_QUICKGOTO_TEXT</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnButtonGotoGo</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_BUTTON</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_QUICKGOTO_GO</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnButtonGotoGo</span><span class="symbol">)</span>
<span class="normal">    </span><span class="function">EVT_BUTTON</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">myID_QUICKGOTO_CLOSE</span><span class="symbol">,</span><span class="normal">	WCryptoTE</span><span class="symbol">::</span><span class="normal">OnButtonGotoClose</span><span class="symbol">)</span>

<span class="function">END_EVENT_TABLE</span><span class="symbol">()</span>

<span class="comment">// *** WStatusBar ***</span>

<span class="normal">WStatusBar</span><span class="symbol">::</span><span class="function">WStatusBar</span><span class="symbol">(</span><span class="usertype">wxWindow</span><span class="normal"> </span><span class="symbol">*</span><span class="normal">_parent</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">:</span><span class="normal"> </span><span class="function">wxStatusBar</span><span class="symbol">(</span><span class="normal">_parent</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">),</span>
<span class="normal">      </span><span class="function">parent</span><span class="symbol">(</span><span class="normal">_parent</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">static</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> </span><span class="type">int</span><span class="normal"> statusbar_widths</span><span class="symbol">[</span><span class="number">3</span><span class="symbol">]</span><span class="normal"> </span><span class="symbol">=</span><span class="normal"> </span><span class="cbracket">{</span><span class="normal"> </span><span class="symbol">-</span><span class="number">1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">150</span><span class="symbol">,</span><span class="normal"> </span><span class="number">28</span><span class="normal"> </span><span class="cbracket">}</span><span class="symbol">;</span>

<span class="normal">    </span><span class="function">SetFieldsCount</span><span class="symbol">(</span><span class="number">3</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">SetStatusWidths</span><span class="symbol">(</span><span class="number">3</span><span class="symbol">,</span><span class="normal"> statusbar_widths</span><span class="symbol">);</span>

<span class="preproc">    #include</span><span class="normal"> </span><span class="string">"art/unmodified-16.h"</span>

<span class="normal">    lockbitmap </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticBitmap</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxIconFromMemory</span><span class="symbol">(</span><span class="normal">unmodified_16_png</span><span class="symbol">));</span>

<span class="normal">    panelProgress </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxWindow</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">);</span>
<span class="normal">    labelProgress </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="normal">panelProgress</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Reencrypting:"</span><span class="symbol">),</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> wxDefaultSize</span><span class="symbol">,</span><span class="normal"> wxALIGN_RIGHT</span><span class="symbol">);</span>
<span class="normal">    gaugeProgress </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxGauge</span><span class="symbol">(</span><span class="normal">panelProgress</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="number">20</span><span class="symbol">,</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> wxDefaultSize</span><span class="symbol">,</span><span class="normal"> wxGA_HORIZONTAL</span><span class="symbol">|</span><span class="normal">wxGA_SMOOTH</span><span class="symbol">);</span>

<span class="normal">    sizerProgress </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxBoxSizer</span><span class="symbol">(</span><span class="normal">wxHORIZONTAL</span><span class="symbol">);</span>
<span class="normal">    sizerProgress</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">labelProgress</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_VERTICAL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">2</span><span class="symbol">);</span>
<span class="normal">    sizerProgress</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">gaugeProgress</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">2</span><span class="symbol">);</span>
<span class="normal">    panelProgress</span><span class="symbol">-&gt;</span><span class="function">SetSizer</span><span class="symbol">(</span><span class="normal">sizerProgress</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WStatusBar</span><span class="symbol">::</span><span class="function">OnSize</span><span class="symbol">(</span><span class="normal">wxSizeEvent</span><span class="symbol">&amp;</span><span class="normal"> event</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// move progress panel</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">wxRect</span><span class="normal"> rect</span><span class="symbol">;</span>
<span class="normal">	</span><span class="function">GetFieldRect</span><span class="symbol">(</span><span class="number">0</span><span class="symbol">,</span><span class="normal"> rect</span><span class="symbol">);</span>

<span class="normal">	panelProgress</span><span class="symbol">-&gt;</span><span class="function">SetSize</span><span class="symbol">(</span><span class="normal">rect</span><span class="symbol">);</span>
<span class="normal">	panelProgress</span><span class="symbol">-&gt;</span><span class="function">Layout</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    </span><span class="comment">// move bitmap to position</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">wxRect</span><span class="normal"> rect</span><span class="symbol">;</span>
<span class="normal">	</span><span class="function">GetFieldRect</span><span class="symbol">(</span><span class="number">2</span><span class="symbol">,</span><span class="normal"> rect</span><span class="symbol">);</span>
<span class="normal">	</span><span class="usertype">wxSize</span><span class="normal"> size </span><span class="symbol">=</span><span class="normal"> lockbitmap</span><span class="symbol">-&gt;</span><span class="function">GetSize</span><span class="symbol">();</span>

<span class="normal">	lockbitmap</span><span class="symbol">-&gt;</span><span class="function">Move</span><span class="symbol">(</span><span class="normal">rect</span><span class="symbol">.</span><span class="normal">x </span><span class="symbol">+</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">rect</span><span class="symbol">.</span><span class="normal">width </span><span class="symbol">-</span><span class="normal"> size</span><span class="symbol">.</span><span class="normal">x</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">/</span><span class="normal"> </span><span class="number">2</span><span class="symbol">,</span>
<span class="normal">			 rect</span><span class="symbol">.</span><span class="normal">y </span><span class="symbol">+</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">rect</span><span class="symbol">.</span><span class="normal">height </span><span class="symbol">-</span><span class="normal"> size</span><span class="symbol">.</span><span class="normal">y</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">/</span><span class="normal"> </span><span class="number">2</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    event</span><span class="symbol">.</span><span class="function">Skip</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WStatusBar</span><span class="symbol">::</span><span class="function">SetModified</span><span class="symbol">(</span><span class="type">bool</span><span class="normal"> on</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="preproc">    #include</span><span class="normal"> </span><span class="string">"art/modified-16.h"</span>
<span class="preproc">    #include</span><span class="normal"> </span><span class="string">"art/unmodified-16.h"</span>

<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">on</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	lockbitmap</span><span class="symbol">-&gt;</span><span class="function">SetBitmap</span><span class="symbol">(</span><span class="function">wxIconFromMemory</span><span class="symbol">(</span><span class="normal">modified_16_png</span><span class="symbol">));</span>
<span class="normal">	lockbitmap</span><span class="symbol">-&gt;</span><span class="function">SetToolTip</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Container is modified."</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="keyword">else</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">	lockbitmap</span><span class="symbol">-&gt;</span><span class="function">SetBitmap</span><span class="symbol">(</span><span class="function">wxIconFromMemory</span><span class="symbol">(</span><span class="normal">unmodified_16_png</span><span class="symbol">));</span>
<span class="normal">	lockbitmap</span><span class="symbol">-&gt;</span><span class="function">SetToolTip</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Container is saved to disk and unmodified."</span><span class="symbol">));</span>
<span class="normal">    </span><span class="cbracket">}</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WStatusBar</span><span class="symbol">::</span><span class="function">ProgressStart</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> </span><span class="type">char</span><span class="symbol">*</span><span class="normal"> text</span><span class="symbol">,</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="usertype">progress_indicator_type</span><span class="normal"> pitype</span><span class="symbol">,</span>
<span class="normal">			       </span><span class="usertype">size_t</span><span class="normal"> value</span><span class="symbol">,</span><span class="normal"> </span><span class="usertype">size_t</span><span class="normal"> limit</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    panelProgress</span><span class="symbol">-&gt;</span><span class="function">Show</span><span class="symbol">();</span>
<span class="normal">    parent</span><span class="symbol">-&gt;</span><span class="function">Disable</span><span class="symbol">();</span>

<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="usertype">wxString</span><span class="normal"> label </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Unknown Progress"</span><span class="symbol">);</span>
<span class="normal">	</span><span class="keyword">switch</span><span class="symbol">(</span><span class="normal">pitype</span><span class="symbol">)</span>
<span class="normal">	</span><span class="cbracket">{</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">PI_GENERIC</span><span class="symbol">:</span>
<span class="normal">	    label </span><span class="symbol">=</span><span class="normal"> </span><span class="function">wxString</span><span class="symbol">(</span><span class="normal">text</span><span class="symbol">,</span><span class="normal"> wxConvUTF8</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">PI_SAVE_CONTAINER</span><span class="symbol">:</span>
<span class="normal">	    label </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Saving Container"</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">PI_LOAD_CONTAINER</span><span class="symbol">:</span>
<span class="normal">	    label </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Loading Container"</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">PI_REENCRYPT</span><span class="symbol">:</span>
<span class="normal">	    label </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Reencrypting"</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">PI_SAVE_SUBFILE</span><span class="symbol">:</span>
<span class="normal">	    label </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Saving SubFile"</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="keyword">case</span><span class="normal"> Enctain</span><span class="symbol">::</span><span class="normal">PI_LOAD_SUBFILE</span><span class="symbol">:</span>
<span class="normal">	    label </span><span class="symbol">=</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Loading SubFile"</span><span class="symbol">);</span>
<span class="normal">	    </span><span class="keyword">break</span><span class="symbol">;</span>
<span class="normal">	</span><span class="cbracket">}</span>
<span class="normal">	labelProgress</span><span class="symbol">-&gt;</span><span class="function">SetLabel</span><span class="symbol">(</span><span class="normal">label</span><span class="symbol">);</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    panelProgress</span><span class="symbol">-&gt;</span><span class="function">Layout</span><span class="symbol">();</span>

<span class="normal">    gaugeProgress</span><span class="symbol">-&gt;</span><span class="function">SetRange</span><span class="symbol">(</span><span class="normal">limit</span><span class="symbol">);</span>
<span class="normal">    gaugeProgress</span><span class="symbol">-&gt;</span><span class="function">SetValue</span><span class="symbol">(</span><span class="normal">value</span><span class="symbol">);</span>

<span class="normal">    wxTheApp</span><span class="symbol">-&gt;</span><span class="function">Yield</span><span class="symbol">(</span><span class="keyword">true</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WStatusBar</span><span class="symbol">::</span><span class="function">ProgressUpdate</span><span class="symbol">(</span><span class="usertype">size_t</span><span class="normal"> value</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">if</span><span class="normal"> </span><span class="symbol">((</span><span class="type">int</span><span class="symbol">)</span><span class="normal">value </span><span class="symbol">&gt;</span><span class="normal"> gaugeProgress</span><span class="symbol">-&gt;</span><span class="function">GetRange</span><span class="symbol">())</span>
<span class="normal">    </span><span class="cbracket">{</span>
<span class="normal">	</span><span class="function">wxLogDebug</span><span class="symbol">(</span><span class="function">_T</span><span class="symbol">(</span><span class="string">"gaugeProgress out of range: %d - %d = %d."</span><span class="symbol">),</span>
<span class="normal">		   value</span><span class="symbol">,</span><span class="normal"> gaugeProgress</span><span class="symbol">-&gt;</span><span class="function">GetRange</span><span class="symbol">(),</span>
<span class="normal">		   gaugeProgress</span><span class="symbol">-&gt;</span><span class="function">GetRange</span><span class="symbol">()</span><span class="normal"> </span><span class="symbol">-</span><span class="normal"> value</span><span class="symbol">);</span>

<span class="normal">	value </span><span class="symbol">=</span><span class="normal"> gaugeProgress</span><span class="symbol">-&gt;</span><span class="function">GetRange</span><span class="symbol">();</span>
<span class="normal">    </span><span class="cbracket">}</span>

<span class="normal">    gaugeProgress</span><span class="symbol">-&gt;</span><span class="function">SetValue</span><span class="symbol">(</span><span class="normal">value</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">Update</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WStatusBar</span><span class="symbol">::</span><span class="function">ProgressStop</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    parent</span><span class="symbol">-&gt;</span><span class="function">Enable</span><span class="symbol">();</span>
<span class="normal">    panelProgress</span><span class="symbol">-&gt;</span><span class="function">Hide</span><span class="symbol">();</span>

<span class="normal">    wxTheApp</span><span class="symbol">-&gt;</span><span class="function">Yield</span><span class="symbol">(</span><span class="keyword">true</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="function">BEGIN_EVENT_TABLE</span><span class="symbol">(</span><span class="normal">WStatusBar</span><span class="symbol">,</span><span class="normal"> wxStatusBar</span><span class="symbol">)</span>

<span class="normal">    </span><span class="function">EVT_SIZE</span><span class="normal">	</span><span class="symbol">(</span><span class="normal">WStatusBar</span><span class="symbol">::</span><span class="normal">OnSize</span><span class="symbol">)</span>

<span class="function">END_EVENT_TABLE</span><span class="symbol">();</span>

<span class="comment">// *** WAbout ***</span>

<span class="normal">WAbout</span><span class="symbol">::</span><span class="function">WAbout</span><span class="symbol">(</span><span class="normal">wxWindow</span><span class="symbol">*</span><span class="normal"> parent</span><span class="symbol">,</span><span class="normal"> </span><span class="type">int</span><span class="normal"> id</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> title</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxPoint</span><span class="symbol">&amp;</span><span class="normal"> pos</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxSize</span><span class="symbol">&amp;</span><span class="normal"> size</span><span class="symbol">,</span><span class="normal"> </span><span class="type">long</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">style</span><span class="symbol">))</span>
<span class="normal">    </span><span class="symbol">:</span><span class="normal"> </span><span class="function">wxDialog</span><span class="symbol">(</span><span class="normal">parent</span><span class="symbol">,</span><span class="normal"> id</span><span class="symbol">,</span><span class="normal"> title</span><span class="symbol">,</span><span class="normal"> pos</span><span class="symbol">,</span><span class="normal"> size</span><span class="symbol">,</span><span class="normal"> wxDEFAULT_DIALOG_STYLE</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// begin wxGlade: WAbout::WAbout</span>
<span class="normal">    bitmapIcon </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticBitmap</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> wxNullBitmap</span><span class="symbol">);</span>
<span class="normal">    bitmapWeb </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticBitmap</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> wxNullBitmap</span><span class="symbol">);</span>
<span class="normal">    hyperlink1 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxHyperlinkCtrl</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Visit http://idlebox.net/2009/cryptote/"</span><span class="symbol">),</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"http://idlebox.net/2009/cryptote/"</span><span class="symbol">),</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> wxDefaultSize</span><span class="symbol">,</span><span class="normal"> wxNO_BORDER</span><span class="symbol">|</span><span class="normal">wxHL_CONTEXTMENU</span><span class="symbol">|</span><span class="normal">wxHL_ALIGN_LEFT</span><span class="symbol">);</span>
<span class="normal">    labelBuildTime </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Binary compiled at "</span><span class="symbol">));</span>
<span class="normal">    buttonOK </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxButton</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_OK</span><span class="symbol">,</span><span class="normal"> wxEmptyString</span><span class="symbol">);</span>

<span class="normal">    </span><span class="function">set_properties</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">do_layout</span><span class="symbol">();</span>
<span class="normal">    </span><span class="comment">// end wxGlade</span>

<span class="preproc">    #include</span><span class="normal"> </span><span class="string">"art/cryptote-48.h"</span>
<span class="normal">    bitmapIcon</span><span class="symbol">-&gt;</span><span class="function">SetBitmap</span><span class="symbol">(</span><span class="normal"> </span><span class="function">wxBitmapFromMemory</span><span class="symbol">(</span><span class="normal">cryptote_48_png</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>

<span class="preproc">    #include</span><span class="normal"> </span><span class="string">"art/web-16.h"</span>
<span class="normal">    bitmapWeb</span><span class="symbol">-&gt;</span><span class="function">SetBitmap</span><span class="symbol">(</span><span class="normal"> </span><span class="function">wxBitmapFromMemory</span><span class="symbol">(</span><span class="normal">web_16_png</span><span class="symbol">)</span><span class="normal"> </span><span class="symbol">);</span>

<span class="normal">    labelBuildTime</span><span class="symbol">-&gt;</span><span class="function">SetLabel</span><span class="symbol">(</span><span class="function">wxString</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"Binary compiled at "</span><span class="symbol">))</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> </span><span class="function">_T</span><span class="symbol">(</span><span class="normal">MY_BUILDTIME</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">Layout</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">GetSizer</span><span class="symbol">()-&gt;</span><span class="function">Fit</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">Centre</span><span class="symbol">();</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WAbout</span><span class="symbol">::</span><span class="function">set_properties</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// begin wxGlade: WAbout::set_properties</span>
<span class="normal">    </span><span class="function">SetTitle</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"About CryptoTE"</span><span class="symbol">));</span>
<span class="normal">    </span><span class="comment">// end wxGlade</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WAbout</span><span class="symbol">::</span><span class="function">do_layout</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// begin wxGlade: WAbout::do_layout</span>
<span class="normal">    wxBoxSizer</span><span class="symbol">*</span><span class="normal"> sizer1 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxBoxSizer</span><span class="symbol">(</span><span class="normal">wxVERTICAL</span><span class="symbol">);</span>
<span class="normal">    wxBoxSizer</span><span class="symbol">*</span><span class="normal"> sizer2 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxBoxSizer</span><span class="symbol">(</span><span class="normal">wxHORIZONTAL</span><span class="symbol">);</span>
<span class="normal">    wxBoxSizer</span><span class="symbol">*</span><span class="normal"> sizer3 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxBoxSizer</span><span class="symbol">(</span><span class="normal">wxVERTICAL</span><span class="symbol">);</span>
<span class="normal">    wxBoxSizer</span><span class="symbol">*</span><span class="normal"> sizer4 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxBoxSizer</span><span class="symbol">(</span><span class="normal">wxHORIZONTAL</span><span class="symbol">);</span>
<span class="normal">    wxBoxSizer</span><span class="symbol">*</span><span class="normal"> sizer5 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxBoxSizer</span><span class="symbol">(</span><span class="normal">wxVERTICAL</span><span class="symbol">);</span>
<span class="normal">    sizer2</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">bitmapIcon</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">8</span><span class="symbol">);</span>
<span class="normal">    wxStaticText</span><span class="symbol">*</span><span class="normal"> label1 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE"</span><span class="symbol">));</span>
<span class="normal">    label1</span><span class="symbol">-&gt;</span><span class="function">SetFont</span><span class="symbol">(</span><span class="function">wxFont</span><span class="symbol">(</span><span class="number">18</span><span class="symbol">,</span><span class="normal"> wxDEFAULT</span><span class="symbol">,</span><span class="normal"> wxNORMAL</span><span class="symbol">,</span><span class="normal"> wxBOLD</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxT</span><span class="symbol">(</span><span class="string">""</span><span class="symbol">)));</span>
<span class="normal">    sizer3</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">label1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">6</span><span class="symbol">);</span>
<span class="normal">    wxStaticText</span><span class="symbol">*</span><span class="normal"> label2 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE is a text editor built upon the popular</span><span class="specialchar">\n</span><span class="string">Scintilla editing widget. Text is saved encrypted</span><span class="specialchar">\n</span><span class="string">and compressed to secure sensitive data."</span><span class="symbol">));</span>
<span class="normal">    sizer3</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">label2</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">6</span><span class="symbol">);</span>
<span class="normal">    wxStaticText</span><span class="symbol">*</span><span class="normal"> label4 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Copyright 2009 Timo Bingmann</span><span class="specialchar">\n</span><span class="string">Released under the GNU General Public License v2"</span><span class="symbol">));</span>
<span class="normal">    sizer3</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">label4</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">6</span><span class="symbol">);</span>
<span class="normal">    sizer4</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">bitmapWeb</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_VERTICAL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">6</span><span class="symbol">);</span>
<span class="normal">    sizer5</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">hyperlink1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    wxStaticText</span><span class="symbol">*</span><span class="normal"> label5 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"for updates and more."</span><span class="symbol">));</span>
<span class="normal">    sizer5</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">label5</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    sizer4</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">sizer5</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    sizer3</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">sizer4</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">6</span><span class="symbol">);</span>
<span class="normal">    sizer3</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">labelBuildTime</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">6</span><span class="symbol">);</span>
<span class="normal">    sizer2</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">sizer3</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">sizer2</span><span class="symbol">,</span><span class="normal"> </span><span class="number">1</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">6</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">buttonOK</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_HORIZONTAL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_VERTICAL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">6</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">SetSizer</span><span class="symbol">(</span><span class="normal">sizer1</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Fit</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">Layout</span><span class="symbol">();</span>
<span class="normal">    </span><span class="comment">// end wxGlade</span>

<span class="normal">    label1</span><span class="symbol">-&gt;</span><span class="function">SetLabel</span><span class="symbol">(</span><span class="normal">wxString</span><span class="symbol">::</span><span class="function">Format</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE %s"</span><span class="symbol">),</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="normal">VERSION</span><span class="symbol">)));</span>
<span class="cbracket">}</span>

<span class="comment">// *** WWebUpdateCheck ***</span>

<span class="normal">WWebUpdateCheck</span><span class="symbol">::</span><span class="function">WWebUpdateCheck</span><span class="symbol">(</span><span class="normal">wxWindow</span><span class="symbol">*</span><span class="normal"> parent</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> newversion</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> changes</span><span class="symbol">,</span><span class="normal"> </span><span class="type">int</span><span class="normal"> id</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> title</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxPoint</span><span class="symbol">&amp;</span><span class="normal"> pos</span><span class="symbol">,</span><span class="normal"> </span><span class="keyword">const</span><span class="normal"> wxSize</span><span class="symbol">&amp;</span><span class="normal"> size</span><span class="symbol">,</span><span class="normal"> </span><span class="type">long</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">style</span><span class="symbol">))</span>
<span class="normal">    </span><span class="symbol">:</span><span class="normal"> </span><span class="function">wxDialog</span><span class="symbol">(</span><span class="normal">parent</span><span class="symbol">,</span><span class="normal"> id</span><span class="symbol">,</span><span class="normal"> title</span><span class="symbol">,</span><span class="normal"> pos</span><span class="symbol">,</span><span class="normal"> size</span><span class="symbol">,</span><span class="normal"> wxDEFAULT_DIALOG_STYLE</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// begin wxGlade: WWebUpdateCheck::WWebUpdateCheck</span>
<span class="normal">    labelNewVersion </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE 0.1.2"</span><span class="symbol">),</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> wxDefaultSize</span><span class="symbol">,</span><span class="normal"> wxALIGN_CENTRE</span><span class="symbol">);</span>
<span class="normal">    hyperlink1 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxHyperlinkCtrl</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"http://idlebox.net/2009/cryptote/"</span><span class="symbol">),</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"http://idlebox.net/2009/cryptote/"</span><span class="symbol">),</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> wxDefaultSize</span><span class="symbol">,</span><span class="normal"> wxNO_BORDER</span><span class="symbol">|</span><span class="normal">wxHL_CONTEXTMENU</span><span class="symbol">|</span><span class="normal">wxHL_ALIGN_CENTRE</span><span class="symbol">);</span>
<span class="normal">    textctrlChanges </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxTextCtrl</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> wxEmptyString</span><span class="symbol">,</span><span class="normal"> wxDefaultPosition</span><span class="symbol">,</span><span class="normal"> wxDefaultSize</span><span class="symbol">,</span><span class="normal"> wxTE_MULTILINE</span><span class="symbol">|</span><span class="normal">wxTE_READONLY</span><span class="symbol">);</span>
<span class="normal">    buttonOK </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxButton</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_OK</span><span class="symbol">,</span><span class="normal"> wxEmptyString</span><span class="symbol">);</span>
<span class="normal">    buttonDisable </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxButton</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_NO</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Disable WebUpdateCheck"</span><span class="symbol">));</span>
<span class="normal">    buttonClose </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxButton</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_CANCEL</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Remind me again"</span><span class="symbol">));</span>

<span class="normal">    </span><span class="function">set_properties</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">do_layout</span><span class="symbol">();</span>
<span class="normal">    </span><span class="comment">// end wxGlade</span>

<span class="normal">    labelNewVersion</span><span class="symbol">-&gt;</span><span class="function">SetLabel</span><span class="symbol">(</span><span class="normal">newversion</span><span class="symbol">);</span>
<span class="normal">    textctrlChanges</span><span class="symbol">-&gt;</span><span class="function">SetValue</span><span class="symbol">(</span><span class="normal">changes</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WWebUpdateCheck</span><span class="symbol">::</span><span class="function">set_properties</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// begin wxGlade: WWebUpdateCheck::set_properties</span>
<span class="normal">    </span><span class="function">SetTitle</span><span class="symbol">(</span><span class="function">_</span><span class="symbol">(</span><span class="string">"CryptoTE WebUpdateCheck"</span><span class="symbol">));</span>
<span class="normal">    labelNewVersion</span><span class="symbol">-&gt;</span><span class="function">SetFont</span><span class="symbol">(</span><span class="function">wxFont</span><span class="symbol">(</span><span class="number">12</span><span class="symbol">,</span><span class="normal"> wxDEFAULT</span><span class="symbol">,</span><span class="normal"> wxNORMAL</span><span class="symbol">,</span><span class="normal"> wxBOLD</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> </span><span class="function">wxT</span><span class="symbol">(</span><span class="string">""</span><span class="symbol">)));</span>
<span class="normal">    textctrlChanges</span><span class="symbol">-&gt;</span><span class="function">SetBackgroundColour</span><span class="symbol">(</span><span class="normal">wxSystemSettings</span><span class="symbol">::</span><span class="function">GetColour</span><span class="symbol">(</span><span class="normal">wxSYS_COLOUR_3DFACE</span><span class="symbol">));</span>
<span class="normal">    </span><span class="comment">// end wxGlade</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WWebUpdateCheck</span><span class="symbol">::</span><span class="function">do_layout</span><span class="symbol">()</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="comment">// begin wxGlade: WWebUpdateCheck::do_layout</span>
<span class="normal">    wxBoxSizer</span><span class="symbol">*</span><span class="normal"> sizer1 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxBoxSizer</span><span class="symbol">(</span><span class="normal">wxVERTICAL</span><span class="symbol">);</span>
<span class="normal">    wxBoxSizer</span><span class="symbol">*</span><span class="normal"> sizer2 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxBoxSizer</span><span class="symbol">(</span><span class="normal">wxHORIZONTAL</span><span class="symbol">);</span>
<span class="normal">    wxStaticText</span><span class="symbol">*</span><span class="normal"> label1 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"A newer program version is available:"</span><span class="symbol">));</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">label1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">8</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">labelNewVersion</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxLEFT</span><span class="symbol">|</span><span class="normal">wxRIGHT</span><span class="symbol">|</span><span class="normal">wxBOTTOM</span><span class="symbol">|</span><span class="normal">wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">8</span><span class="symbol">);</span>
<span class="normal">    wxStaticText</span><span class="symbol">*</span><span class="normal"> label2 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"can be downloaded from the web page:"</span><span class="symbol">));</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">label2</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxLEFT</span><span class="symbol">|</span><span class="normal">wxRIGHT</span><span class="symbol">|</span><span class="normal">wxBOTTOM</span><span class="symbol">|</span><span class="normal">wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">8</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">hyperlink1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxLEFT</span><span class="symbol">|</span><span class="normal">wxRIGHT</span><span class="symbol">|</span><span class="normal">wxBOTTOM</span><span class="symbol">|</span><span class="normal">wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">8</span><span class="symbol">);</span>
<span class="normal">    wxStaticLine</span><span class="symbol">*</span><span class="normal"> staticline1 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticLine</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">staticline1</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    wxStaticText</span><span class="symbol">*</span><span class="normal"> label3 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticText</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">,</span><span class="normal"> </span><span class="function">_</span><span class="symbol">(</span><span class="string">"Summary of changes to the new version:"</span><span class="symbol">));</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">label3</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">8</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">textctrlChanges</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxLEFT</span><span class="symbol">|</span><span class="normal">wxRIGHT</span><span class="symbol">|</span><span class="normal">wxBOTTOM</span><span class="symbol">|</span><span class="normal">wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">8</span><span class="symbol">);</span>
<span class="normal">    wxStaticLine</span><span class="symbol">*</span><span class="normal"> staticline2 </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">new</span><span class="normal"> </span><span class="function">wxStaticLine</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> wxID_ANY</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">staticline2</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    sizer2</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">buttonOK</span><span class="symbol">,</span><span class="normal"> </span><span class="number">2</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_HORIZONTAL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_VERTICAL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">4</span><span class="symbol">);</span>
<span class="normal">    sizer2</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">buttonDisable</span><span class="symbol">,</span><span class="normal"> </span><span class="number">3</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_HORIZONTAL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_VERTICAL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">4</span><span class="symbol">);</span>
<span class="normal">    sizer2</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">buttonClose</span><span class="symbol">,</span><span class="normal"> </span><span class="number">2</span><span class="symbol">,</span><span class="normal"> wxALL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_HORIZONTAL</span><span class="symbol">|</span><span class="normal">wxALIGN_CENTER_VERTICAL</span><span class="symbol">,</span><span class="normal"> </span><span class="number">4</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Add</span><span class="symbol">(</span><span class="normal">sizer2</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">,</span><span class="normal"> wxEXPAND</span><span class="symbol">,</span><span class="normal"> </span><span class="number">0</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">SetSizer</span><span class="symbol">(</span><span class="normal">sizer1</span><span class="symbol">);</span>
<span class="normal">    sizer1</span><span class="symbol">-&gt;</span><span class="function">Fit</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">);</span>
<span class="normal">    </span><span class="function">Layout</span><span class="symbol">();</span>
<span class="normal">    </span><span class="function">Centre</span><span class="symbol">();</span>
<span class="normal">    </span><span class="comment">// end wxGlade</span>
<span class="cbracket">}</span>

<span class="function">BEGIN_EVENT_TABLE</span><span class="symbol">(</span><span class="normal">WWebUpdateCheck</span><span class="symbol">,</span><span class="normal"> wxDialog</span><span class="symbol">)</span>
<span class="normal">    </span><span class="comment">// begin wxGlade: WWebUpdateCheck::event_table</span>
<span class="normal">    </span><span class="function">EVT_BUTTON</span><span class="symbol">(</span><span class="normal">wxID_NO</span><span class="symbol">,</span><span class="normal"> WWebUpdateCheck</span><span class="symbol">::</span><span class="normal">OnButtonDisableWebUpdateCheck</span><span class="symbol">)</span>
<span class="normal">    </span><span class="comment">// end wxGlade</span>
<span class="function">END_EVENT_TABLE</span><span class="symbol">();</span>

<span class="type">void</span><span class="normal"> WWebUpdateCheck</span><span class="symbol">::</span><span class="function">OnButtonDisableWebUpdateCheck</span><span class="symbol">(</span><span class="normal">wxCommandEvent</span><span class="symbol">&amp;</span><span class="normal"> </span><span class="function">WXUNUSED</span><span class="symbol">(</span><span class="normal">event</span><span class="symbol">))</span>
<span class="cbracket">{</span>
<span class="normal">    </span><span class="function">EndModal</span><span class="symbol">(</span><span class="normal">wxID_NO</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="comment">// *** WNotePage ***</span>

<span class="normal">WNotePage</span><span class="symbol">::</span><span class="function">WNotePage</span><span class="symbol">(</span><span class="keyword">class</span><span class="normal"> </span><span class="classname">WCryptoTE</span><span class="symbol">*</span><span class="normal"> _wmain</span><span class="symbol">)</span>
<span class="normal">    </span><span class="symbol">:</span><span class="normal"> </span><span class="function">wxPanel</span><span class="symbol">(</span><span class="normal">_wmain</span><span class="symbol">-&gt;</span><span class="normal">auinotebook</span><span class="symbol">),</span>
<span class="normal">      </span><span class="function">wmain</span><span class="symbol">(</span><span class="normal">_wmain</span><span class="symbol">),</span>
<span class="normal">      </span><span class="function">subfileid</span><span class="symbol">(-</span><span class="number">1</span><span class="symbol">),</span><span class="normal"> </span><span class="function">page_modified</span><span class="symbol">(</span><span class="keyword">false</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WNotePage</span><span class="symbol">::</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="keyword">const</span><span class="normal"> wxString</span><span class="symbol">&amp;</span><span class="normal"> str</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    wmain</span><span class="symbol">-&gt;</span><span class="function">UpdateStatusBar</span><span class="symbol">(</span><span class="normal">str</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="type">void</span><span class="normal"> WNotePage</span><span class="symbol">::</span><span class="function">SetModified</span><span class="symbol">(</span><span class="type">bool</span><span class="normal"> modified</span><span class="symbol">)</span>
<span class="cbracket">{</span>
<span class="normal">    page_modified </span><span class="symbol">=</span><span class="normal"> modified</span><span class="symbol">;</span>

<span class="normal">    wmain</span><span class="symbol">-&gt;</span><span class="function">UpdateSubFileModified</span><span class="symbol">(</span><span class="keyword">this</span><span class="symbol">,</span><span class="normal"> page_modified</span><span class="symbol">);</span>
<span class="cbracket">}</span>

<span class="function">IMPLEMENT_ABSTRACT_CLASS</span><span class="symbol">(</span><span class="normal">WNotePage</span><span class="symbol">,</span><span class="normal"> wxPanel</span><span class="symbol">);</span>


</tt></pre></div><div style="text-align: right; padding: 8pt; font-size: 12px"><a href="/xmlfeed/weblog-rss20.xml"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPAgMAAAAOp6AcAAAADFBMVEVmZmb/ZgD///+JjnlbTUWmAAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABQAAAADwCexKkxAAAAWUlEQVQYlWNgwAa0VmGAFQyqoSCQ/x8J/CBFMCt0ZdTU/F/7/+1HEkydFpoKVPn+93sUlUujQvP/7UcRTAuNDJ2a//s/imDqtKVZofm/1qGYSZk7sfodGwAAiobBJtffoNAAAAAASUVORK5CYII=" alt="RSS 2.0 Weblog Feed" width="80" height="15"/></a> <a href="/xmlfeed/weblog-atom10.xml"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPAgMAAAAOp6AcAAAADFBMVEVmZmb/ZgD///+JjnlbTUWmAAAAaklEQVQYlWNgwAa0VmGAFQyqoSCQ/x8J/CBFMDV16rTQ/H/7V//69+//v/3/9oMEI6cuAwr+fv/+/b5d///v//0eJBgWOhMo+Gs9UPAdXDBy6lSYyn9wQZCZS0GCYDPXQcykzJ1Y/Y4NAABKvL80wyoMPgAAAABJRU5ErkJggg==" alt="Atom 1.0 Weblog Feed" width="80" height="15"/></a> <a href="http://validator.w3.org/check?uri=referer"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAB1FBMVEUHQIgIRY0MN4QNRYoSRYsXUpIYVJQeUpUhWpgjUJMjWpgmU5QnXJkuYZ0uYpwwV5YyZJ4zaKM3ZaA5aaI6aqM6a6E8ZqA8Z6BAbaRBbqdCbaVHd61KSkpKcaZQUFBUf69UgbBVVVVXfq9Yg7NZhbJZh7RagrNeXVxeh7RfjLdgYGBiiLZmZmZnZ2doirhpkbt0m8F3m8B3ncJ5lb55ocR+ocSDgX+Do8eEpMqGhoaHp8iIpMeJjnmJpseKqMeOqsqPsdCQrcyVlZWVsM2Zs9CZtNCfu9ahoaGhuNShudSivNSjtMWjvNSmpqWnpqSrw9qvxNqyxdmyxdyzsK6zs7Ozx9y0xt21yN22tra4y+K80eK/v7/AwMDExMTEy9DH2ejK2+jM2ujN3uvP0dLR0NDR3uvS3uvS3+zU4u3V1dXY2dnY4u7Y4+3b5e/d3d3d5u/d5/De3t7f39/h4uLj4uHj6/Ll7PXm7fTn7/Xo7/Tp7/bq7Ozr6unr8ffw8PDw9vvx9fny+P7z8/Pz9vnz9vv3+fv4+vz5+vz6+vr6+/36/P36///7+/77/Pz7/f37/f78/Pz8/f38/f79/f39/f79/f/9/v79///+/v7+/v////3///+tYR2LAAABKklEQVQ4y2PQoTJg0JlNVYDPQBsyAMTAqaFes8tdsmdPCtA3MDStr3GKKK6myMAprgJ9pcpWs/MlRExYJBvNZLR0sigycHYOV1S7mtjsQJ4gf+HIFPXoWMs6qIGzIRiKZs9GFoEaMRuZhhrYqqJXy8uZYauRxC/VHew7e3YTPAxnI5swG6JxNrKBNjB1EFmIgV0+HA6C8pqqzhXG7BbJJROQIwViMYQ7G2oDQQNn57JyG7kxiCfObrBmS5+BHMuYLkTzMnYDm5WY4lOZZRPKZocxes+aPbuwCFsYohiICLvZsKBAMrDTQ7K/StveU8icTzrOL8JdLpOyWJ49u8Bx9ozw8DY7UYW03hhdxZAOSg2c3jN79rSJs1vSKmfOnpFXNJmynELlvExlAADnaZpLFGEC2wAAAABJRU5ErkJggg==" alt="Valid XHTML 1.1" width="80" height="15"/></a> <a href="http://jigsaw.w3.org/css-validator/check/referer"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAB1FBMVEUHQIgIRY0MN4QNRYoSRYsXUpIYVJQeUpUhWpgjUJMjWpgmU5QnXJkuYZ0uYpwwV5YyZJ4zaKM3ZaA5aaI6aqM6a6E8ZqA8Z6BAbaRBbqdCbaVHd61KSkpKcaZQUFBUf69UgbBVVVVXfq9Yg7NZhbJZh7RagrNeXVxeh7RfjLdgYGBiiLZmZmZnZ2doirhpkbt0m8F3m8B3ncJ5lb55ocR+ocSDgX+Do8eEpMqGhoaHp8iIpMeJjnmJpseKqMeOqsqPsdCQrcyVlZWVsM2Zs9CZtNCfu9ahoaGhuNShudSivNSjtMWjvNSmpqWnpqSrw9qvxNqyxdmyxdyzsK6zs7Ozx9y0xt21yN22tra4y+K80eK/v7/AwMDExMTEy9DH2ejK2+jM2ujN3uvP0dLR0NDR3uvS3uvS3+zU4u3V1dXY2dnY4u7Y4+3b5e/d3d3d5u/d5/De3t7f39/h4uLj4uHj6/Ll7PXm7fTn7/Xo7/Tp7/bq7Ozr6unr8ffw8PDw9vvx9fny+P7z8/Pz9vnz9vv3+fv4+vz5+vz6+vr6+/36/P36///7+/77/Pz7/f37/f78/Pz8/f38/f79/f39/f79/f/9/v79///+/v7+/v////3///+tYR2LAAABEUlEQVQ4y2PQoTJg0JlNVYDPQBsyAMTAqaFes8tdsmdPCtA3MDStr3GKKK6myMAprgJ9pcpWs/MlRExYJBvNZLR0sigycHYOV1S7mtjsQJ4gf+HIFPXoWMs6mIEQCsIjwhKoga0qerW8nBm2Gkn8Ut3BvrNnN8HCcDYM2cBIogzs8uFwEJTXVHWuMGa3SC6ZgIgUqCEwdxJr4OxcVm4jNwbxxNkN1mzpM2ajGIjsPGK9PLtZiSk+lVk2oWx2GKP3rNmzC4tQwpDoIIQb2Okh2V+lbe8pZM4nHecX4S6XSVksz55d4Dh7Rnh4m52oQlpvjK5iSAelBk7vmT172sTZLWmVM2fPyCuaTFlOoXJepjIAANlljDGY/l5pAAAAAElFTkSuQmCC" alt="Valid CSS (2.1)" width="80" height="15"/></a><br/>Copyright 2005-2018 <a href="/about/">Timo Bingmann</a> - <a href="/about/impressum.html">Impressum</a></div><script type="text/javascript">var _paq = _paq || []; _paq.push(["trackPageView"]); _paq.push(["enableLinkTracking"]);(function() {var u=(("https:" == document.location.protocol) ? "https" : "http") + "://panthema.net/wik-331/"; _paq.push(["setTrackerUrl", u+"js/"]); _paq.push(["setSiteId", "2"]);var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";g.defer=true; g.async=true; g.src=u+"js/"; s.parentNode.insertBefore(g,s);})();</script><noscript><p><img src="http://panthema.net/wik-331/js/?idsite=2&amp;rec=1" style="border:0" alt="" /></p></noscript></body></html>