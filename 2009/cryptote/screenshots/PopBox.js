function SeekLayer(d,b){var a;for(var c=0;c<d.layers.length;c++){if(d.layers[c].name==b){a=d.layers[c];break}if(d.layers[c].document.layers.length>0){a=SeekLayer(document.layers[c].document,b)}}return a}function GetRawObject(c){var b;if(typeof c=="string"){var a=(document.body&&document.body.style)?true:false;if(a&&document.getElementById){b=document.getElementById(c)}else{if(a&&document.all){b=document.all(c)}else{if(document.layers){b=SeekLayer(document,c)}}}}else{b=c}return b}function GetInsideWindowSize(){if(window.innerWidth){return{x:window.innerWidth,y:window.innerHeight}}else{var a=document.getElementsByTagName("base");if(a.length==0){if(document.compatMode&&document.compatMode.indexOf("CSS1")>=0){return{x:document.body.parentNode.clientWidth,y:document.body.parentNode.clientHeight}}else{if(document.body&&document.body.clientWidth){return{x:document.body.clientWidth,y:document.body.clientHeight}}}}else{if(document.body&&document.body.clientWidth){return{x:document.body.clientWidth,y:document.body.clientHeight}}else{if(document.compatMode&&document.compatMode.indexOf("CSS1")>=0){return{x:document.body.parentNode.clientWidth,y:document.body.parentNode.clientHeight}}}}}return{x:0,y:0}}function GetObjectPadding(g){var f=GetRawObject(g);var c=0;var e=0;var d=0;var a=0;if(f.currentStyle){if(f.currentStyle.paddingLeft){c=parseInt(f.currentStyle.paddingLeft,10)}if(f.currentStyle.paddingRight){e=parseInt(f.currentStyle.paddingRight,10)}if(f.currentStyle.paddingTop){d=parseInt(f.currentStyle.paddingTop,10)}if(f.currentStyle.paddingBottom){a=parseInt(f.currentStyle.paddingBottom,10)}}else{if(window.getComputedStyle){c=parseInt(window.getComputedStyle(f,null).paddingLeft,10);e=parseInt(window.getComputedStyle(f,null).paddingRight,10);d=parseInt(window.getComputedStyle(f,null).paddingTop,10);a=parseInt(window.getComputedStyle(f,null).paddingBottom,10)}}if(isNaN(c)==true){c=0}if(isNaN(e)==true){e=0}if(isNaN(d)==true){d=0}if(isNaN(a)==true){a=0}return{l:(c),r:(e),t:(d),b:(a)}}function GetObjectSize(e){var c=GetRawObject(e);var a=0;var b=0;if(c.offsetWidth){a=c.offsetWidth;b=c.offsetHeight}else{if(c.clip&&c.clip.width){a=c.clip.width;b=c.clip.height}else{if(c.style&&c.style.pixelWidth){a=c.style.pixelWidth;b=c.style.pixelHeight}}}a=parseInt(a,10);b=parseInt(b,10);var d=GetObjectPadding(c);a-=(d.l+d.r);b-=(d.t+d.b);return{w:(a),h:(b)}}function GetElementPosition(g){var d=GetRawObject(g);var f=0;var e=0;var b=GetObjectPadding(d);f=b.l;e=b.t;if(d.offsetParent){f+=d.offsetLeft;e+=d.offsetTop;var c=d.offsetParent;while(c){f+=c.offsetLeft;e+=c.offsetTop;if(c.style&&c.style.overflow&&c.style.overflow!=""){f-=c.scrollLeft;e-=c.scrollTop}var a=c.tagName.toLowerCase();if(a!="table"&&a!="body"&&a!="html"&&a!="div"&&c.clientTop&&c.clientLeft){f+=c.clientLeft;e+=c.clientTop}c=c.offsetParent}}else{if(d.left&&d.top){f=d.left;e=d.top}else{if(d.x){f=d.x}if(d.y){e=d.y}}}return{x:f,y:e}}function GetScrollOffset(){if(window.pageYOffset){return{x:window.pageXOffset,y:window.pageYOffset}}else{if(document.compatMode&&document.compatMode.indexOf("CSS1")>=0){return{x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop}}else{if(document.body&&document.body.clientWidth){return{x:document.body.scrollLeft,y:document.body.scrollTop}}}}return{x:0,y:0}}function CreateRandomId(){var b=0;while(b==0){b=Math.random()}var a=b+"";return"id"+a.substr(2)}function MouseMoveRevert(g){if(pbMouseMoveRevert!=null&&pbMouseMoveRevert.length!=0){var c=(g)?g:window.event;var d={x:0,y:0};if(c.pageX||c.pageY){d.x=c.pageX;d.y=c.pageY}else{if(c.clientX||c.clientY){var b=GetScrollOffset();d.x=c.clientX+b.x;d.y=c.clientY+b.y}}for(var a=0;a<pbMouseMoveRevert.length;){if(pbMouseMoveRevert[a]!=null){var h=pbMouseMoveRevert[a].id;if(typeof popBox[h]!="undefined"&&popBox[h]!=null&&popBox[h].hTarg!=0){if(d.x<popBox[h].xTarg||d.x>(popBox[h].xTarg+popBox[h].wTarg)||d.y<popBox[h].yTarg||d.y>(popBox[h].yTarg+popBox[h].hTarg)){var f=pbMouseMoveRevert[a].className;pbMouseMoveRevert.splice(a,1);Revert(h,null,f);continue}}}a++}}}var popBox=new Array();var popBoxIds=new Array();var popBoxZ=100;var pbSrc=new Array();var pbPopBarFunc=new Array();var pbMouseMoveRevert=null;if(typeof window.onload=="function"){var func=window.onload;window.onload=function(){func();InitPbSrc();InitPbPopBar()}}else{window.onload=function(){InitPbSrc();InitPbPopBar()}}function InitPbSrc(){var b=null;if(document.body){if(document.body.getElementsByTagName){b=document.body.getElementsByTagName("img")}else{if(document.body.all){b=document.body.all.tags("img")}}}if(b!=null){for(var a=0;a<b.length;a++){var c=b[a].getAttribute("pbSrc");if(c!=null){if(b[a].id==""){b[a].id=CreateRandomId()}if(pbSrc[b[a].id]==null){pbSrc[b[a].id]=new Image();pbSrc[b[a].id].src=c}}}}}function InitPbPopBar(){var b=null;if(document.body){if(document.body.getElementsByTagName){b=document.body.getElementsByTagName("img")}else{if(document.body.all){b=document.body.all.tags("img")}}}if(b!=null){var c=new Array();for(var a=0;a<b.length;a++){if(b[a].id==""){b[a].id=CreateRandomId()}c[a]=b[a]}for(var a=0;a<c.length;a++){CreatePopBar(c[a])}}}function InitPopBox(d){d=GetRawObject(d);if(typeof popBox[d.id]!="undefined"&&popBox[d.id]!=null){return d}var i=document.body;if(d.id==""){d.id=CreateRandomId()}var b=d;var g=GetElementPosition(b);var c=GetObjectSize(b);if(b.style.position=="absolute"||b.style.position=="relative"){i=b.parentNode;g.x=parseInt(b.style.left,10);g.y=parseInt(b.style.top,10)}if(pbSrc[b.id]!=null||(b.style.position!="absolute"&&b.style.position!="relative")){var f=(pbSrc[b.id]!=null)?pbSrc[b.id].src:b.src;var e=null;try{e=document.createElement("<img src='"+f+"' />")}catch(h){e=document.createElement("img");e.src=f}e.border=b.border;e.className=b.className;e.height=b.height;e.id="popcopy"+b.id;e.alt=b.alt;e.title=b.title;e.width=b.width;e.onclick=b.onclick;e.ondblclick=b.ondblclick;e.onmouseout=b.onmouseout;b.onmouseout=null;e.style.width=c.w;e.style.height=c.h;e.style.position="absolute";e.style.left=g.x+"px";e.style.top=g.y+"px";e.style.cursor=b.style.cursor;i.appendChild(e);b.style.visibility="hidden";b=e}popBoxIds.push(b.id);popBox[b.id]={elemId:b.id,xCurr:0,yCurr:0,xTarg:0,yTarg:0,wCurr:0,hCurr:0,wTarg:0,hTarg:0,xStep:0,yStep:0,wStep:0,hStep:0,xDelta:0,yDelta:0,wDelta:0,hDelta:0,xTravel:0,yTravel:0,wTravel:0,hTravel:0,velM:1,velS:1,interval:null,isAnimating:false,xOriginal:g.x,yOriginal:g.y,wOriginal:parseFloat(c.w),hOriginal:parseFloat(c.h),isPopped:false,fnClick:null,fnDone:null,fnPre:null,originalId:null,cursor:""};if(typeof d.onclick=="function"){popBox[b.id].fnClick=b.onclick;if(popBoxAutoClose==true&&(typeof d.ondblclick!="function"||d.ondblclick==null)&&typeof d.onmouseover!="function"){b.ondblclick=function(){Revert(b.id,null,b.className)}}}if(popBoxAutoClose==true&&typeof d.onmouseover=="function"&&(typeof d.onmouseout!="function"||d.onmouseout==null)){if(popBoxMouseMoveRevert==true){if(pbMouseMoveRevert==null){pbMouseMoveRevert=new Array();if(typeof document.onmousemove=="function"){var a=document.onmousemove;document.onmousemove=function(j){a(j);MouseMoveRevert(j)}}else{document.onmousemove=MouseMoveRevert}}pbMouseMoveRevert.push({id:b.id,className:b.className})}else{b.onmouseout=function(){Revert(b.id,null,b.className)}}}if(d.id!=b.id){popBox[b.id].originalId=d.id}return b}function DoPopBox(c){if(typeof c=="string"){c=GetRawObject(c)}try{var a=false;var f=false;if((popBox[c.id].xTravel+Math.abs(popBox[c.id].xStep))<popBox[c.id].xDelta){var j=popBox[c.id].xCurr+popBox[c.id].xStep;c.style.left=parseInt(j,10)+"px";popBox[c.id].xTravel+=Math.abs(popBox[c.id].xStep);popBox[c.id].xCurr=j}else{popBox[c.id].xTravel+=Math.abs(popBox[c.id].xStep);c.style.left=parseInt(popBox[c.id].xTarg,10)+"px";a=true}if((popBox[c.id].yTravel+Math.abs(popBox[c.id].yStep))<popBox[c.id].yDelta){var i=popBox[c.id].yCurr+popBox[c.id].yStep;c.style.top=parseInt(i,10)+"px";popBox[c.id].yTravel+=Math.abs(popBox[c.id].yStep);popBox[c.id].yCurr=i;a=false}else{popBox[c.id].yTravel+=Math.abs(popBox[c.id].yStep);c.style.top=parseInt(popBox[c.id].yTarg,10)+"px"}if((popBox[c.id].wTravel+Math.abs(popBox[c.id].wStep))<popBox[c.id].wDelta){var k=popBox[c.id].wCurr+popBox[c.id].wStep;c.style.width=parseInt(k,10)+"px";popBox[c.id].wTravel+=Math.abs(popBox[c.id].wStep);popBox[c.id].wCurr=k}else{popBox[c.id].wTravel+=Math.abs(popBox[c.id].wStep);c.style.width=parseInt(popBox[c.id].wTarg,10)+"px";f=true}if((popBox[c.id].hTravel+Math.abs(popBox[c.id].hStep))<popBox[c.id].hDelta){var e=popBox[c.id].hCurr+popBox[c.id].hStep;c.style.height=parseInt(e,10)+"px";popBox[c.id].hTravel+=Math.abs(popBox[c.id].hStep);popBox[c.id].hCurr=e;f=false}else{popBox[c.id].hTravel+=Math.abs(popBox[c.id].hStep);c.style.height=parseInt(popBox[c.id].hTarg,10)+"px"}var d=c;if(a==true&&f==true){clearInterval(popBox[c.id].interval);c.style.cursor=popBox[c.id].cursor;var b=null;if(popBox[c.id].fnDone!=null&&typeof popBox[c.id].fnDone=="function"){b=popBox[c.id].fnDone}if(popBox[c.id].isPopped==true){c.style.zIndex="";if(popBox[c.id].originalId!=null){d=GetRawObject(popBox[c.id].originalId);d.onmouseout=c.onmouseout;d.style.visibility="visible";c.parentNode.removeChild(c)}else{c.style.width=parseInt(popBox[c.id].wOriginal,10)+"px";c.style.height=parseInt(popBox[c.id].hOriginal,10)+"px";if(typeof popBox[c.id].fnClick=="function"){c.onclick=popBox[c.id].fnClick}}delete popBox[c.id];popBox[c.id]=null;CreatePopBar(d)}else{popBox[c.id].isPopped=true;popBox[c.id].isAnimating=false;CreateRevertBar(c)}if(b!=null&&typeof b=="function"){b(d)}}}catch(g){}}function HasRevertBar(e){if(typeof e=="string"){e=GetRawObject(e)}var b=e;if(popBox[b.id]!=null&&popBox[b.id].originalId!=null){b=GetRawObject(popBox[b.id].originalId)}var a=b.getAttribute("pbShowRevertBar");var d=b.getAttribute("pbShowRevertText");var c=b.getAttribute("pbShowRevertImage");a=(a!=null)?(a=="true"||a==true):popBoxShowRevertBar;d=(d!=null)?(d=="true"||d==true):popBoxShowRevertText;c=(c!=null)?(c=="true"||c==true):popBoxShowRevertImage;return(a||d||c)}function HasCaption(c){if(typeof c=="string"){c=GetRawObject(c)}var a=c;if(popBox[a.id]!=null&&popBox[a.id].originalId!=null){a=GetRawObject(popBox[a.id].originalId)}var d=a.getAttribute("pbShowCaption");d=(d!=null)?(d=="true"||d==true):popBoxShowCaption;var b=null;if(d==true){b=a.getAttribute("pbCaption");if(b==null&&a.title!=""){b=a.title}}return(b!=null&&b!="")}function CreateRevertBar(f){if(typeof f=="string"){f=GetRawObject(f)}var c=f;if(popBox[c.id]!=null&&popBox[c.id].originalId!=null){c=GetRawObject(popBox[c.id].originalId)}var h=c.getAttribute("pbShowRevertBar");var i=c.getAttribute("pbShowRevertText");var a=c.getAttribute("pbShowRevertImage");var b=c.getAttribute("pbRevertText");var g=c.getAttribute("pbRevertImage");h=(h!=null)?(h=="true"||h==true):popBoxShowRevertBar;i=(i!=null)?(i=="true"||i==true):popBoxShowRevertText;a=(a!=null)?(a=="true"||a==true):popBoxShowRevertImage;if(b==null){b=popBoxRevertText}if(g==null){g=popBoxRevertImage}var e=c.getAttribute("pbShowCaption");e=(e!=null)?(e=="true"||e==true):popBoxShowCaption;var d=null;if(e==true){d=c.getAttribute("pbCaption");if(d==null&&c.title!=""){d=c.title}}CreatePbBar(f,h,i,a,b,g,popBoxRevertBarAbove,true,d)}function CreatePopBar(f){if(typeof f=="string"){f=GetRawObject(f)}if(typeof pbPopBarFunc[f.id]!="undefined"&&pbPopBarFunc[f.id]!=null){return}var b=f.getAttribute("pbShowPopBar");if(b!=null){var e=f.getAttribute("pbShowPopText");var d=f.getAttribute("pbShowPopImage");var a=f.getAttribute("pbPopText");var c=f.getAttribute("pbPopImage");b=(b=="true"||b==true);e=(e!=null)?(e=="true"||e==true):popBoxShowPopText;d=(d!=null)?(d=="true"||d==true):popBoxShowPopImage;if(a==null){a=popBoxPopText}if(c==null){c=popBoxPopImage}CreatePbBar(f,b,e,d,a,c,popBoxPopBarAbove,false,null)}}function CreatePbBar(q,n,H,g,I,x,h,u,C){if(n==false&&H==false&&g==false&&C==null){return}if(typeof q=="string"){q=GetRawObject(q)}var B="hand";if(q.currentStyle){B=q.currentStyle.cursor}else{if(window.getComputedStyle){B=window.getComputedStyle(q,null).cursor}}var F=function(){if(typeof q.onclick=="function"){q.onclick()}};var i=function(){if(typeof q.onmouseout=="function"){q.onmouseout()}};var a=function(){if(typeof q.onmouseover=="function"){q.onmouseover()}};var D=new Array();var p=(q.style.position=="absolute"||q.style.position=="relative");var f=0;var t=0;var k=q.parentNode;var d=null;if(p==true){f=parseInt(q.style.left,10);t=parseInt(q.style.top,10);var s=GetObjectPadding(q);f+=s.l;t+=s.t}else{d=document.createElement("span");d=(q.nextSibling!=null)?k.insertBefore(d,q.nextSibling):k.appendChild(d);d.style.position="relative";d.style.left="0px";d.style.top="0px";var r="";if(q.align=="left"){r="left"}else{if(q.align=="right"){r="right"}}r=(q.style.styleFloat&&q.style.styleFloat!="")?q.style.styleFloat:(q.style.cssFloat&&q.style.cssFloat!="")?q.style.cssFloat:r;if(typeof q.style.styleFloat!="undefined"){d.style.styleFloat=r}else{if(typeof q.style.cssFloat!="undefined"){d.style.cssFloat=r}}var b=GetElementPosition(q);var c=GetElementPosition(d);d.style.left=(b.x-c.x)+"px";d.style.top=(r!="")?"1px":(b.y-c.y)+"px";k=d}var A=parseInt(q.style.width,10);var w=parseInt(q.style.height,10);var v=GetObjectSize(q);if(isNaN(A)==true){A=v.w}else{if(v.w>A){f+=((v.w-A)/2)}}if(isNaN(w)==true){w=v.h}else{if(v.h>w){t+=((v.h-w)/2)}}if(h==true){t-=20}var l=q.style.zIndex+1;if(n==true){var y=document.createElement("div");y.id="popBoxDivTrans"+l;y.style.width=A+"px";y.style.height="20px";y.style.borderStyle="none";y.style.padding="0px";y.style.margin="0px";y.style.position="absolute";y.style.left=f+"px";y.style.top=t+"px";y.style.backgroundColor="#000000";y.style.cursor=B;y.style.zIndex=l;if(h==false){if(typeof y.style.filter!="undefined"){y.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=20)"}if(typeof y.style.opacity!="undefined"){y.style.opacity="0.2"}}y.onclick=F;if(u==true){y.onmouseout=i}else{y.onmouseover=a}k.appendChild(y);D.push(function(){y.parentNode.removeChild(y)})}if(H==true){var o=document.createElement("div");o.id="popBoxDivText"+l;o.style.width=A+"px";o.style.height="20px";o.style.borderStyle="none";o.style.padding="0px";o.style.margin="0px";o.style.position="absolute";o.style.left=f+"px";o.style.top=t+"px";o.style.cursor=B;o.style.textAlign="center";o.style.fontFamily="Arial, Verdana, Sans-Serif";o.style.fontSize="10pt";o.style.backgroundColor="Transparent";o.style.color="#ffffff";o.style.zIndex=l;o.innerHTML=I;o.onclick=F;if(u==true){o.onmouseout=i}else{o.onmouseover=a}k.appendChild(o);D.push(function(){o.parentNode.removeChild(o)})}if(g==true){var j=null;try{j=document.createElement("<img src='"+x+"' />")}catch(E){j=document.createElement("img");j.src=x}j.id="popBoxImgPopped"+l;j.style.width="20px";j.style.height="20px";j.style.borderStyle="none";j.style.padding="0px";j.style.margin="0px";j.style.position="absolute";j.style.left=(f+A-20)+"px";j.style.top=t+"px";j.style.cursor=B;j.style.zIndex=l;j.onclick=F;if(u==true){j.onmouseout=i}else{j.onmouseover=a}k.appendChild(j);D.push(function(){j.parentNode.removeChild(j)})}if(C!=null&&C!=""){t+=(w-20);if(h==true){t+=20}if(popBoxCaptionBelow==true){t+=20}var G=document.createElement("div");G.id="popBoxDivCapTrans"+l;G.style.width=A-2+"px";G.style.height="20px";G.style.borderStyle="solid";G.style.borderWidth="1px";G.style.borderColor="#999999";G.style.padding="0px";G.style.margin="0px";G.style.position="absolute";G.style.left=f+"px";G.style.top=t-1+"px";G.style.backgroundColor="#ffffdd";G.style.zIndex=l;if(popBoxCaptionBelow==false){if(typeof G.style.filter!="undefined"){G.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=70)"}if(typeof G.style.opacity!="undefined"){G.style.opacity="0.7"}}k.appendChild(G);D.push(function(){G.parentNode.removeChild(G)});var e=document.createElement("div");e.id="popBoxDivCapText"+l;e.style.width=A-20+"px";e.style.height="20px";e.style.borderStyle="none";e.style.padding="0px";e.style.margin="0px";e.style.position="absolute";e.style.left=f+10+"px";e.style.top=t+"px";e.style.textAlign="center";e.style.fontFamily="Arial, Verdana, Sans-Serif";e.style.fontSize="10pt";e.style.overflowY="hidden";e.style.backgroundColor="Transparent";e.style.color="#000000";e.style.zIndex=l;k.appendChild(e);D.push(function(){e.parentNode.removeChild(e)});AddCaptionText(G,e,C);if(popBoxExpandCaptions==true&&e.hasChildNodes()==true){var m=e.lastChild;if(m&&m.onclick){m.id=CreateRandomId();setTimeout(new Function("","var spanMore = GetRawObject('"+m.id+"'); if (spanMore != null && spanMore.onclick) { spanMore.onclick(); }"),10)}}}if(D.length!=0){if(d!=null){D.push(function(){d.parentNode.removeChild(d)})}if(u==true){if(popBox[q.id].fnPre!=null&&typeof(popBox[q.id].fnPre)=="function"){D.push(popBox[q.id].fnPre)}popBox[q.id].fnPre=function(){for(var z=0;z<D.length;z++){D[z]()}}}else{pbPopBarFunc[q.id]=function(){for(var z=0;z<D.length;z++){D[z]()}}}}}function AddCaptionText(g,i,h){var b=parseInt(i.style.width,10);var c=document.createElement("div");c.style.position="absolute";c.style.width=b+"px";c.style.margin="0px";c.style.fontFamily=i.style.fontFamily;c.style.fontSize=i.style.fontSize;c.style.visibility="hidden";c.innerHTML=h;document.body.appendChild(c);var f=GetObjectSize(c);if(f.h>20){c.innerHTML=h+"..."+popBoxCaptionLessText;f=GetObjectSize(c);var e=h;var a=parseInt(b*0.14,10)-5;i.innerHTML=h.substr(0,a)+"...";var d=document.createElement("span");d.style.color="#0000ff";d.style.textDecoration="underline";d.style.cursor="pointer";d.onclick=function(){d.parentNode.removeChild(d);ResizeCaption(g.id,i.id,f.h,e)};d.innerHTML=popBoxCaptionMoreText;i.appendChild(d)}else{i.innerHTML=h}document.body.removeChild(c)}function ResizeCaption(e,c,b,d){if(typeof e=="string"){e=GetRawObject(e)}if(typeof c=="string"){c=GetRawObject(c)}var f=parseInt(c.style.height,10);var g=parseInt(c.style.top,10);if(f<b){if(f==20){b+=10;c.style.paddingTop="5px";c.innerHTML=d+"...";var a=document.createElement("span");a.style.color="#0000ff";a.style.textDecoration="underline";a.style.cursor="pointer";a.onclick=function(){a.parentNode.removeChild(a);c.innerHTML=d;ResizeCaption(e.id,c.id,20,d)};a.innerHTML=popBoxCaptionLessText;c.appendChild(a);if(popBoxCaptionBelow==false){if(typeof e.style.filter!="undefined"){e.style.filter=""}if(typeof e.style.opacity!="undefined"){e.style.opacity="1.0"}}}if((f+10)>=b){if(popBoxExpandCaptionsBelow==false){g-=(b-f)}f=b}else{if(popBoxExpandCaptionsBelow==false){g-=10}f+=10}e.style.height=f+"px";c.style.height=f+"px";e.style.top=(g-1)+"px";c.style.top=g+"px";if(f!=b){setTimeout('ResizeCaption("'+e.id+'","'+c.id+'",'+b+',"'+d+'")',10)}}else{if((f-10)<=b){if(popBoxExpandCaptionsBelow==false){g+=(f-b)}f=b}else{if(popBoxExpandCaptionsBelow==false){g+=10}f-=10}e.style.height=f+"px";c.style.height=f+"px";e.style.top=(g-1)+"px";c.style.top=g+"px";c.style.paddingTop="0px";if(f==b){if(popBoxCaptionBelow==false){if(typeof e.style.filter!="undefined"){e.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=70)"}if(typeof e.style.opacity!="undefined"){e.style.opacity="0.7"}}AddCaptionText(e,c,d)}else{setTimeout('ResizeCaption("'+e.id+'","'+c.id+'",'+b+',"'+d+'")',10)}}}function CreateWaitImage(e){if(typeof e=="string"){e=GetRawObject(e)}var c="popBoxImgWait"+e.id;var b=GetRawObject(c);if(b!=null){return b}var d=0;var h=0;if(e.style.position=="absolute"||e.style.position=="relative"){d=parseInt(e.style.left,10);h=parseInt(e.style.top,10)}else{var l=GetElementPosition(e);d=l.x;h=l.y;var i=GetObjectPadding(e);d-=i.l;h-=i.t}var a=parseInt(e.style.width,10);var j=parseInt(e.style.height,10);var k=GetObjectSize(e);if(isNaN(a)==true){a=k.w}else{if(k.w>a){d+=((k.w-a)/2)}}if(isNaN(j)==true){j=k.h}else{if(k.h>j){h+=((k.h-j)/2)}}var f=e.parentNode;try{b=document.createElement("<img src='"+popBoxWaitImage.src+"' />")}catch(g){b=document.createElement("img");b.src=popBoxWaitImage.src}b.id=c;b.style.position="absolute";b.style.left=(d+(a/2)-(popBoxWaitImage.width/2))+"px";b.style.top=(h+(j/2)-(popBoxWaitImage.height/2))+"px";b.style.cursor=e.style.cursor;b.style.zIndex=e.style.zIndex+1;f.appendChild(b);return b}function CalculateImageDimensions(d,a,f,b,c){if(d==null){if(a==null){d=f;a=b}else{if(a==0){a=Math.min(c.y,b);var e=parseFloat(a)/parseFloat(b);d=parseInt(f*e)}else{var e=parseFloat(a)/parseFloat(b);d=parseInt(f*e)}}}else{if(d==0){if(a==null){d=Math.min(c.x,f);var e=parseFloat(d)/parseFloat(f);a=parseInt(b*e)}else{if(a==0){if(c.x<f||c.y<b){var e=Math.min(parseFloat(c.x)/parseFloat(f),parseFloat(c.y)/parseFloat(b));d=parseInt(f*e);a=parseInt(b*e)}else{d=f;a=b}}else{var e=parseFloat(a)/parseFloat(b);d=Math.min(c.x,parseInt(f*e))}}}else{if(a==null){var e=parseFloat(d)/parseFloat(f);a=parseInt(b*e)}else{if(a==0){var e=parseFloat(d)/parseFloat(f);a=Math.min(c.y,parseInt(b*e))}}}}return{x:d,y:a}}function GetObjectToPop(c){if(typeof c=="string"){c=GetRawObject(c)}if(c.id==""){c.id=CreateRandomId()}var a=c.getAttribute("pbSrcNL");if(a==null&&pbSrc[c.id]==null){a=c.getAttribute("pbSrc")}if(a!=null&&pbSrc[c.id]==null){var b=new Image();b.src=a;if(pbSrc[c.id]!=null){delete pbSrc[c.id]}pbSrc[c.id]=b}return(pbSrc[c.id]!=null)?pbSrc[c.id]:c}function GetPoppedImageSize(c){var b={x:0,y:0};if(c!=null&&typeof c.id!="undefined"){if(pbSrc[c.id]!=null){b.x=pbSrc[c.id].width;b.y=pbSrc[c.id].height}else{if(c.naturalWidth&&c.naturalHeight){b.x=c.naturalWidth;b.y=c.naturalHeight}else{var a=new Image();a.src=c.src;b.x=a.width;b.y=a.height;delete a}}}return b}var popBoxAutoClose=true;var popBoxMouseMoveRevert=true;var popBoxWaitImage=new Image();popBoxWaitImage.src="spinner40.gif";var popBoxShowRevertBar=true;var popBoxShowRevertText=true;var popBoxShowRevertImage=true;var popBoxRevertText="Click the image to shrink it.";var popBoxRevertImage="magminus.gif";var popBoxRevertBarAbove=false;var popBoxShowPopText=true;var popBoxShowPopImage=true;var popBoxPopText="Click to expand.";var popBoxPopImage="magplus.gif";var popBoxPopBarAbove=false;var popBoxShowCaption=true;var popBoxCaptionBelow=false;var popBoxCaptionMoreText="more";var popBoxCaptionLessText="less";var popBoxExpandCaptions=false;var popBoxExpandCaptionsBelow=false;function PopBox(i,p,o,b,a,q,f,c,g,j,h,d,e){if(typeof i=="string"){i=GetRawObject(i)}if(i==null||typeof i!="object"||isNaN(p)||isNaN(o)||isNaN(b)||isNaN(a)||isNaN(q)||isNaN(f)||isNaN(c)||isNaN(g)||isNaN(j)||isNaN(h)){return}var r=InitPopBox(i);if(popBox[r.id].isAnimating==true){var n="PopBox('"+r.id+"',"+p+","+o+","+b+","+a+","+q+","+f+","+c+","+g+","+j+","+h+",'"+d+"');";setTimeout(n,10)}else{popBox[r.id].isAnimating=true;popBox[r.id].xCurr=parseFloat(p);popBox[r.id].yCurr=parseFloat(o);popBox[r.id].wCurr=parseFloat(q);popBox[r.id].hCurr=parseFloat(f);popBox[r.id].xTarg=parseFloat(b);popBox[r.id].yTarg=parseFloat(a);popBox[r.id].wTarg=parseFloat(c);popBox[r.id].hTarg=parseFloat(g);popBox[r.id].xDelta=Math.abs(parseFloat(b)-parseFloat(p));popBox[r.id].yDelta=Math.abs(parseFloat(a)-parseFloat(o));popBox[r.id].wDelta=Math.abs(parseFloat(c)-parseFloat(q));popBox[r.id].hDelta=Math.abs(parseFloat(g)-parseFloat(f));popBox[r.id].velM=(j)?Math.abs(parseFloat(j)):1;popBox[r.id].velS=(h)?Math.abs(parseFloat(h)):1;popBox[r.id].xTravel=0;popBox[r.id].yTravel=0;popBox[r.id].wTravel=0;popBox[r.id].hTravel=0;r.style.position="absolute";r.style.left=p+"px";r.style.top=o+"px";r.style.width=q+"px";r.style.height=f+"px";r.style.display="inline";var m=Math.sqrt((Math.pow((p-b),2))+(Math.pow((o-a),2)));var k=Math.sqrt((Math.pow((q-c),2))+(Math.pow((f-g),2)));if(popBox[r.id].velM==popBox[r.id].velS){m=k=Math.sqrt(Math.pow(m,2)+Math.pow(k,2))}popBox[r.id].xStep=((popBox[r.id].xTarg-popBox[r.id].xCurr)/m)*popBox[r.id].velM;popBox[r.id].yStep=((popBox[r.id].yTarg-popBox[r.id].yCurr)/m)*popBox[r.id].velM;popBox[r.id].wStep=((popBox[r.id].wTarg-popBox[r.id].wCurr)/k)*popBox[r.id].velS;popBox[r.id].hStep=((popBox[r.id].hTarg-popBox[r.id].hCurr)/k)*popBox[r.id].velS;popBox[r.id].fnDone=e;if(d!=null){r.className=d}popBox[r.id].cursor=r.style.cursor;r.style.cursor="default";if(popBox[r.id].isPopped==false){r.style.zIndex=++popBoxZ}var l=r.id;if(popBox[r.id].originalId!=null){l=popBox[r.id].originalId}if(pbPopBarFunc[l]!=null){pbPopBarFunc[l]();pbPopBarFunc[l]=null}if(popBox[r.id].fnPre!=null&&typeof popBox[r.id].fnPre=="function"){popBox[r.id].fnPre()}popBox[r.id].interval=setInterval("DoPopBox('"+r.id+"')",10)}}function Pop(c,b,a){PopEx(c,null,null,0,0,b,a)}function PopEx(j,n,g,h,q,r,e){if(typeof j=="string"){j=GetRawObject(j)}var d=GetObjectToPop(j);var o=(typeof d.readyState!="undefined")?(d.readyState=="complete"):((typeof d.complete!="undefined")?(d.complete==true):true);if(o==false){var l=CreateWaitImage(j);var p="var imgWait = GetRawObject('"+l.id+"'); if (imgWait != null) { imgWait.parentNode.removeChild(imgWait); } PopEx('"+j.id+"',";if(n==null){p+=n+","}else{p+="'"+n+"',"}if(g==null){p+=g+","}else{p+="'"+g+"',"}p+=h+","+q+","+r+",'"+e+"');";d.onload=new Function("",p);return}var u=InitPopBox(j);if(popBox[u.id].isPopped==true){return}if(typeof u.ondblclick=="function"){u.onclick=u.ondblclick}var t=parseInt(u.style.left);var s=parseInt(u.style.top);var k=GetInsideWindowSize();var i=HasRevertBar(j);var b=HasCaption(j);if(i==true&&popBoxRevertBarAbove==true){k.y-=20}if(b==true&&popBoxCaptionBelow==true){k.y-=20}var m={x:h,y:q};if(h==0||q==0||h==null||q==null){m=GetPoppedImageSize(u);if(m.x==0||m.y==0){var v=Math.min(parseFloat(k.x)/parseFloat(u.width),parseFloat(k.y)/parseFloat(u.height));m.x=parseInt(u.width*v);m.y=parseInt(u.height*v)}}if(n!=null){if(typeof n=="string"&&n.indexOf("A")==(n.length-1)){n=parseInt(n,10)}else{n=popBox[u.id].xOriginal+parseInt(n,10)}k.x-=n}if(g!=null){if(typeof g=="string"&&g.indexOf("A")==(g.length-1)){g=parseInt(g,10)}else{g=popBox[u.id].yOriginal+parseInt(g,10)}k.y-=g}if(h==null&&q==0&&m.x>(k.x-20)){k.y-=20}else{if(h==0&&q==null&&m.y>(k.y-4)){k.x-=4}}var a=CalculateImageDimensions(h,q,m.x,m.y,k);if(n==null||g==null){var c=GetScrollOffset();if(n==null){n=((k.x/2)+c.x)-(a.x/2);if(n<0){n=0}}if(g==null){g=((k.y/2)+c.y)-(a.y/2);if(i==true&&popBoxRevertBarAbove==true){g+=10}if(b==true&&popBoxCaptionBelow==true){g-=10}if(g<0){g=0}}}var f=null;if(typeof PostPopProcessing=="function"){f=PostPopProcessing}if(typeof PrePopProcessing=="function"){PrePopProcessing(j)}PopBox(u,t,s,n,g,popBox[u.id].wOriginal,popBox[u.id].hOriginal,a.x,a.y,r,r,e,f)}function PopInPlace(j,q,e){if(typeof j=="string"){j=GetRawObject(j)}var d=GetObjectToPop(j);var o=(typeof d.readyState!="undefined")?(d.readyState=="complete"):((typeof d.complete!="undefined")?(d.complete==true):true);if(o==false){var l=CreateWaitImage(j);var p="var imgWait = GetRawObject('"+l.id+"'); if (imgWait != null) { imgWait.parentNode.removeChild(imgWait); } PopInPlace('"+j.id+"',"+q+",'"+e+"');";d.onload=new Function("",p);return}var t=InitPopBox(j);if(popBox[t.id].isPopped==true){return}if(typeof t.ondblclick=="function"){t.onclick=t.ondblclick}var s=parseInt(t.style.left);var r=parseInt(t.style.top);var k=GetInsideWindowSize();var i=HasRevertBar(j);var b=HasCaption(j);if(i==true&&popBoxRevertBarAbove==true){k.y-=20}if(b==true&&popBoxCaptionBelow==true){k.y-=20}var m=GetPoppedImageSize(t);if(m.x==0||m.y==0){var v=Math.min(parseFloat(k.x)/parseFloat(t.width),parseFloat(k.y)/parseFloat(t.height));m.x=parseInt(t.width*v);m.y=parseInt(t.height*v)}var a=CalculateImageDimensions(0,0,m.x,m.y,k);var n=s-parseInt(((a.x-popBox[t.id].wOriginal)/2),10);var h=r-parseInt(((a.y-popBox[t.id].hOriginal)/2),10);var c=GetScrollOffset();if(c.x>n){n=c.x}else{var u=((n+a.x)-(k.x+c.x));if(u>0){n-=u}}if(c.y>h){h=c.y}else{var g=((h+a.y)-(k.y+c.y));if(g>0){h-=g}}if(i==true&&popBoxRevertBarAbove==true){h+=10}if(b==true&&popBoxCaptionBelow==true){h-=10}if(h<0){h=0}var f=null;if(typeof PostPopProcessing=="function"){f=PostPopProcessing}if(typeof PrePopProcessing=="function"){PrePopProcessing(j)}PopBox(t,s,r,n,h,popBox[t.id].wOriginal,popBox[t.id].hOriginal,a.x,a.y,q,q,e,f)}function Revert(d,c,a){if(typeof d=="string"){d=GetRawObject(d)}if(d==null||typeof popBox[d.id]=="undefined"||popBox[d.id]==null){return}if(typeof c=="undefined"||c==null||c==0){c=Math.max(popBox[d.id].velM,popBox[d.id].velS)}if(typeof a=="undefined"){a=popBox[d.id].originalClassName}var b=null;if(typeof PostRevertProcessing=="function"){b=PostRevertProcessing}if(typeof PreRevertProcessing=="function"){PreRevertProcessing(d)}PopBox(d,popBox[d.id].xTarg,popBox[d.id].yTarg,popBox[d.id].xOriginal,popBox[d.id].yOriginal,popBox[d.id].wTarg,popBox[d.id].hTarg,popBox[d.id].wOriginal,popBox[d.id].hOriginal,c,c,a,b)}function RevertAll(c,b){for(var a=0;a<popBoxIds.length;a++){Revert(popBoxIds[a],c,b)}};